<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | A basic cardano-node client that can talk to a local cardano-node.</span><span>
</span><span id="line-2"></span><span class="hs-comment">--</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- The idea of this module is to provide a Haskell interface on top of</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- cardano-cli's API, using cardano-api types.</span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hydra.Chain.CardanoClient</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Prelude</span></span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Cardano.Api</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Block</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">UTxO</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">queryCurrentEra</span></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api.Query</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Query</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api.UTxO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">UTxO</span></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api.UTxO</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UTxO</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">eitherDecode'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">encode</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/containers-0.6.7/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/text-2.0.2/src/Data.Text.html"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Text.Printf.html"><span class="hs-identifier">Text.Printf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Text.Printf.html#printf"><span class="hs-identifier">printf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-comment">-- XXX: This should be re-exported by cardano-api</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- https://github.com/IntersectMBO/cardano-api/issues/447</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">data</span><span> </span><span id="QueryException"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryException"><span class="hs-identifier hs-var">QueryException</span></a></span></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="QueryAcquireException"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryAcquireException"><span class="hs-identifier hs-var">QueryAcquireException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AcquiringFailure</span></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="QueryEraMismatchException"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryEraMismatchException"><span class="hs-identifier hs-var">QueryEraMismatchException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraMismatch</span></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="QueryUnsupportedNtcVersionException"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryUnsupportedNtcVersionException"><span class="hs-identifier hs-var">QueryUnsupportedNtcVersionException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UnsupportedNtcVersionError</span></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="QueryProtocolParamsConversionException"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryProtocolParamsConversionException"><span class="hs-identifier hs-var">QueryProtocolParamsConversionException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ProtocolParametersConversionError</span></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="QueryProtocolParamsEraNotSupported"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryProtocolParamsEraNotSupported"><span class="hs-identifier hs-var">QueryProtocolParamsEraNotSupported</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AnyCardanoEra</span></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="QueryProtocolParamsEncodingFailureOnEra"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryProtocolParamsEncodingFailureOnEra"><span class="hs-identifier hs-var">QueryProtocolParamsEncodingFailureOnEra</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AnyCardanoEra</span></span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="QueryEraNotInCardanoModeFailure"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryEraNotInCardanoModeFailure"><span class="hs-identifier hs-var">QueryEraNotInCardanoModeFailure</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AnyCardanoEra</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="QueryNotShelleyBasedEraException"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryNotShelleyBasedEraException"><span class="hs-identifier hs-var">QueryNotShelleyBasedEraException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AnyCardanoEra</span></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680425118"><span id="local-6989586621680425144"><span id="local-6989586621680425148"><span class="annot"><span class="annottext">Int -&gt; QueryException -&gt; ShowS
[QueryException] -&gt; ShowS
QueryException -&gt; String
(Int -&gt; QueryException -&gt; ShowS)
-&gt; (QueryException -&gt; String)
-&gt; ([QueryException] -&gt; ShowS)
-&gt; Show QueryException
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; QueryException -&gt; ShowS
showsPrec :: Int -&gt; QueryException -&gt; ShowS
$cshow :: QueryException -&gt; String
show :: QueryException -&gt; String
$cshowList :: [QueryException] -&gt; ShowS
showList :: [QueryException] -&gt; ShowS
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680425152"><span id="local-6989586621680425169"><span class="annot"><span class="annottext">QueryException -&gt; QueryException -&gt; Bool
(QueryException -&gt; QueryException -&gt; Bool)
-&gt; (QueryException -&gt; QueryException -&gt; Bool) -&gt; Eq QueryException
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: QueryException -&gt; QueryException -&gt; Bool
== :: QueryException -&gt; QueryException -&gt; Bool
$c/= :: QueryException -&gt; QueryException -&gt; Bool
/= :: QueryException -&gt; QueryException -&gt; Bool
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680425178"><span id="local-6989586621680425182"><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Exception.Type.html#Exception"><span class="hs-identifier hs-type">Exception</span></a></span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryException"><span class="hs-identifier hs-type">QueryException</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-34"></span><span>  </span><span id="local-6989586621680425216"><span class="annot"><span class="annottext">displayException :: QueryException -&gt; String
</span><a href="#local-6989586621680425216"><span class="hs-identifier hs-var hs-var hs-var hs-var">displayException</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryAcquireException"><span class="hs-identifier hs-type">QueryAcquireException</span></a></span><span> </span><span id="local-6989586621680425218"><span class="annot"><span class="annottext">AcquiringFailure
</span><a href="#local-6989586621680425218"><span class="hs-identifier hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AcquiringFailure -&gt; String
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">AcquiringFailure
</span><a href="#local-6989586621680425218"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryEraMismatchException"><span class="hs-identifier hs-type">QueryEraMismatchException</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraMismatch</span></span><span class="hs-special">{</span><span id="local-6989586621680425221"><span class="annot"><span class="annottext">Text
ledgerEraName :: Text
ledgerEraName :: EraMismatch -&gt; Text
</span><a href="#local-6989586621680425221"><span class="hs-identifier hs-var hs-var">ledgerEraName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680425223"><span class="annot"><span class="annottext">Text
otherEraName :: Text
otherEraName :: EraMismatch -&gt; Text
</span><a href="#local-6989586621680425223"><span class="hs-identifier hs-var hs-var">otherEraName</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-37"></span><span>      </span><span class="hs-comment">-- NOTE: The &quot;ledger&quot; here is the one in the cardano-node and &quot;otherEra&quot; is the one we picked for the query.</span><span>
</span><span id="line-38"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Text -&gt; Text -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Text.Printf.html#printf"><span class="hs-identifier hs-var">printf</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Connected to cardano-node in unsupported era %s, while we requested %s. Please upgrade your hydra-node.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680425221"><span class="hs-identifier hs-var">ledgerEraName</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680425223"><span class="hs-identifier hs-var">otherEraName</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryUnsupportedNtcVersionException"><span class="hs-identifier hs-type">QueryUnsupportedNtcVersionException</span></a></span><span> </span><span id="local-6989586621680425225"><span class="annot"><span class="annottext">UnsupportedNtcVersionError
</span><a href="#local-6989586621680425225"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnsupportedNtcVersionError -&gt; String
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UnsupportedNtcVersionError
</span><a href="#local-6989586621680425225"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryProtocolParamsConversionException"><span class="hs-identifier hs-type">QueryProtocolParamsConversionException</span></a></span><span> </span><span id="local-6989586621680425226"><span class="annot"><span class="annottext">ProtocolParametersConversionError
</span><a href="#local-6989586621680425226"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProtocolParametersConversionError -&gt; String
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ProtocolParametersConversionError
</span><a href="#local-6989586621680425226"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryProtocolParamsEraNotSupported"><span class="hs-identifier hs-type">QueryProtocolParamsEraNotSupported</span></a></span><span> </span><span id="local-6989586621680425227"><span class="annot"><span class="annottext">AnyCardanoEra
</span><a href="#local-6989586621680425227"><span class="hs-identifier hs-var">unsupportedEraName</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-42"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Text -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Text.Printf.html#printf"><span class="hs-identifier hs-var">printf</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Error while querying protocol params using era %s.&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnyCardanoEra -&gt; Text
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">AnyCardanoEra
</span><a href="#local-6989586621680425227"><span class="hs-identifier hs-var">unsupportedEraName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryProtocolParamsEncodingFailureOnEra"><span class="hs-identifier hs-type">QueryProtocolParamsEncodingFailureOnEra</span></a></span><span> </span><span id="local-6989586621680425228"><span class="annot"><span class="annottext">AnyCardanoEra
</span><a href="#local-6989586621680425228"><span class="hs-identifier hs-var">eraName</span></a></span></span><span> </span><span id="local-6989586621680425229"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680425229"><span class="hs-identifier hs-var">encodingFailure</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-44"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Text -&gt; Text -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Text.Printf.html#printf"><span class="hs-identifier hs-var">printf</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Error while querying protocol params using era %s: %s.&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnyCardanoEra -&gt; Text
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">AnyCardanoEra
</span><a href="#local-6989586621680425228"><span class="hs-identifier hs-var">eraName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680425229"><span class="hs-identifier hs-var">encodingFailure</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryEraNotInCardanoModeFailure"><span class="hs-identifier hs-type">QueryEraNotInCardanoModeFailure</span></a></span><span> </span><span id="local-6989586621680425230"><span class="annot"><span class="annottext">AnyCardanoEra
</span><a href="#local-6989586621680425230"><span class="hs-identifier hs-var">eraName</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-46"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Text -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Text.Printf.html#printf"><span class="hs-identifier hs-var">printf</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Error while querying using era %s not in cardano mode.&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnyCardanoEra -&gt; Text
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">AnyCardanoEra
</span><a href="#local-6989586621680425230"><span class="hs-identifier hs-var">eraName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryNotShelleyBasedEraException"><span class="hs-identifier hs-type">QueryNotShelleyBasedEraException</span></a></span><span> </span><span id="local-6989586621680425231"><span class="annot"><span class="annottext">AnyCardanoEra
</span><a href="#local-6989586621680425231"><span class="hs-identifier hs-var">eraName</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-48"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Text -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Text.Printf.html#printf"><span class="hs-identifier hs-var">printf</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Error while querying using era %s not in shelley based era.&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnyCardanoEra -&gt; Text
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">AnyCardanoEra
</span><a href="#local-6989586621680425231"><span class="hs-identifier hs-var">eraName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="annot"><span class="hs-comment">-- * CardanoClient handle</span></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="annot"><span class="hs-comment">-- | Handle interface for abstract querying of a cardano node.</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">data</span><span> </span><span id="CardanoClient"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#CardanoClient"><span class="hs-identifier hs-var">CardanoClient</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CardanoClient"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#CardanoClient"><span class="hs-identifier hs-var">CardanoClient</span></a></span></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AqueryUTxOByAddress%3ACardanoClient"><span class="annot"><span class="annottext">CardanoClient -&gt; [Address ShelleyAddr] -&gt; IO (UTxO Era)
</span><a href="Hydra.Chain.CardanoClient.html#%24sel%3AqueryUTxOByAddress%3ACardanoClient"><span class="hs-identifier hs-var hs-var">queryUTxOByAddress</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Address</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ShelleyAddr</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConwayEra</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AnetworkId%3ACardanoClient"><span class="annot"><span class="annottext">CardanoClient -&gt; NetworkId
</span><a href="Hydra.Chain.CardanoClient.html#%24sel%3AnetworkId%3ACardanoClient"><span class="hs-identifier hs-var hs-var">networkId</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="annot"><span class="hs-comment">-- * Tx Construction / Submission</span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">-- | Submit a (signed) transaction to the node.</span><span>
</span><span id="line-61"></span><span class="hs-comment">--</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- Throws 'SubmitTransactionException' if submission fails.</span><span>
</span><span id="line-63"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#submitTransaction"><span class="hs-identifier hs-type">submitTransaction</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-64"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><span class="hs-comment">-- | A signed transaction.</span></span><span>
</span><span id="line-66"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span id="submitTransaction"><span class="annot"><span class="annottext">submitTransaction :: LocalNodeConnectInfo -&gt; Tx -&gt; IO ()
</span><a href="Hydra.Chain.CardanoClient.html#submitTransaction"><span class="hs-identifier hs-var hs-var">submitTransaction</span></a></span></span><span> </span><span id="local-6989586621680425237"><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425237"><span class="hs-identifier hs-var">connectInfo</span></a></span></span><span> </span><span id="local-6989586621680425238"><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621680425238"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-69"></span><span>  </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
-&gt; TxInMode -&gt; IO (SubmitResult TxValidationErrorInCardanoMode)
forall (m :: * -&gt; *).
MonadIO m =&gt;
LocalNodeConnectInfo
-&gt; TxInMode -&gt; m (SubmitResult TxValidationErrorInCardanoMode)
</span><span class="hs-identifier hs-var">submitTxToNodeLocal</span></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425237"><span class="hs-identifier hs-var">connectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TxInMode
</span><a href="#local-6989586621680425240"><span class="hs-identifier hs-var">txInMode</span></a></span><span> </span><span class="annot"><span class="annottext">IO (SubmitResult TxValidationErrorInCardanoMode)
-&gt; (SubmitResult TxValidationErrorInCardanoMode -&gt; IO ()) -&gt; IO ()
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><span class="annottext">SubmitResult TxValidationErrorInCardanoMode
</span><span class="hs-identifier hs-var">SubmitSuccess</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-71"></span><span>      </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">SubmitFail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxValidationEraMismatch</span></span><span> </span><span id="local-6989586621680425244"><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621680425244"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-73"></span><span>      </span><span class="annot"><span class="annottext">SubmitTransactionException -&gt; IO ()
forall e a. Exception e =&gt; e -&gt; IO a
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraMismatch -&gt; SubmitTransactionException
</span><a href="Hydra.Chain.CardanoClient.html#SubmitEraMismatch"><span class="hs-identifier hs-var">SubmitEraMismatch</span></a></span><span> </span><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621680425244"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">SubmitFail</span></span><span> </span><span id="local-6989586621680425247"><span class="annot"><span class="annottext">e :: TxValidationErrorInCardanoMode
</span><a href="#local-6989586621680425247"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">TxValidationErrorInCardanoMode</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-75"></span><span>      </span><span class="annot"><span class="annottext">SubmitTransactionException -&gt; IO ()
forall e a. Exception e =&gt; e -&gt; IO a
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxValidationErrorInCardanoMode -&gt; SubmitTransactionException
</span><a href="Hydra.Chain.CardanoClient.html#SubmitTxValidationError"><span class="hs-identifier hs-var">SubmitTxValidationError</span></a></span><span> </span><span class="annot"><span class="annottext">TxValidationErrorInCardanoMode
</span><a href="#local-6989586621680425247"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-77"></span><span>  </span><span id="local-6989586621680425240"><span class="annot"><span class="annottext">txInMode :: TxInMode
</span><a href="#local-6989586621680425240"><span class="hs-identifier hs-var hs-var">txInMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-78"></span><span>    </span><span class="annot"><span class="annottext">ShelleyBasedEra Era -&gt; Tx -&gt; TxInMode
forall era. ShelleyBasedEra era -&gt; Tx era -&gt; TxInMode
</span><span class="hs-identifier hs-var">TxInMode</span></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra Era
forall era. IsShelleyBasedEra era =&gt; ShelleyBasedEra era
</span><span class="hs-identifier hs-var">shelleyBasedEra</span></span><span> </span><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621680425238"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">-- | Exceptions that 'can' occur during a transaction submission.</span><span>
</span><span id="line-81"></span><span class="hs-comment">--</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- In principle, we can only encounter an 'EraMismatch' at era boundaries, when</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- we try to submit a &quot;next era&quot; transaction as a &quot;current era&quot; transaction, or</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- vice-versa.</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- Similarly, 'TxValidationError' shouldn't occur given that the transaction was</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- safely constructed through 'buildTransaction'.</span><span>
</span><span id="line-87"></span><span class="hs-keyword">data</span><span> </span><span id="SubmitTransactionException"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#SubmitTransactionException"><span class="hs-identifier hs-var">SubmitTransactionException</span></a></span></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="SubmitEraMismatch"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#SubmitEraMismatch"><span class="hs-identifier hs-var">SubmitEraMismatch</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraMismatch</span></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="SubmitTxValidationError"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#SubmitTxValidationError"><span class="hs-identifier hs-var">SubmitTxValidationError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxValidationErrorInCardanoMode</span></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680425256"><span id="local-6989586621680425263"><span id="local-6989586621680425267"><span class="annot"><span class="annottext">Int -&gt; SubmitTransactionException -&gt; ShowS
[SubmitTransactionException] -&gt; ShowS
SubmitTransactionException -&gt; String
(Int -&gt; SubmitTransactionException -&gt; ShowS)
-&gt; (SubmitTransactionException -&gt; String)
-&gt; ([SubmitTransactionException] -&gt; ShowS)
-&gt; Show SubmitTransactionException
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; SubmitTransactionException -&gt; ShowS
showsPrec :: Int -&gt; SubmitTransactionException -&gt; ShowS
$cshow :: SubmitTransactionException -&gt; String
show :: SubmitTransactionException -&gt; String
$cshowList :: [SubmitTransactionException] -&gt; ShowS
showList :: [SubmitTransactionException] -&gt; ShowS
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680425274"><span id="local-6989586621680425277"><span id="local-6989586621680425280"><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Exception.Type.html#Exception"><span class="hs-identifier hs-type">Exception</span></a></span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#SubmitTransactionException"><span class="hs-identifier hs-type">SubmitTransactionException</span></a></span></span></span></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">-- | Await until the given transaction is visible on-chain. Returns the UTxO</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- set produced by that transaction.</span><span>
</span><span id="line-96"></span><span class="hs-comment">--</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- Note that this function loops forever; hence, one probably wants to couple it</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- with a surrounding timeout.</span><span>
</span><span id="line-99"></span><span id="local-6989586621680424892"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#awaitTransaction"><span class="hs-identifier hs-type">awaitTransaction</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">IsShelleyBasedEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680424892"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The transaction to watch / await</span></span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="annot"><a href="#local-6989586621680424892"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-105"></span><span id="awaitTransaction"><span class="annot"><span class="annottext">awaitTransaction :: forall era.
IsShelleyBasedEra era =&gt;
LocalNodeConnectInfo -&gt; Tx -&gt; IO (UTxO era)
</span><a href="Hydra.Chain.CardanoClient.html#awaitTransaction"><span class="hs-identifier hs-var hs-var">awaitTransaction</span></a></span></span><span> </span><span id="local-6989586621680425293"><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425293"><span class="hs-identifier hs-var">connectInfo</span></a></span></span><span> </span><span id="local-6989586621680425294"><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621680425294"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><span class="annottext">IO (UTxO era)
</span><a href="#local-6989586621680425295"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-107"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>  </span><span id="local-6989586621680425296"><span class="annot"><span class="annottext">ins :: [TxIn]
</span><a href="#local-6989586621680425296"><span class="hs-identifier hs-var hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO Era) -&gt; [TxIn]
forall t a b. (IsList t, Item t ~ (a, b)) =&gt; t -&gt; [a]
</span><span class="hs-identifier hs-var">keys</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxO Era -&gt; Map TxIn (TxOut CtxUTxO Era)
forall era. UTxO era -&gt; Map TxIn (TxOut CtxUTxO era)
</span><span class="hs-identifier hs-var">UTxO.toMap</span></span><span> </span><span class="annot"><span class="annottext">(UTxO Era -&gt; Map TxIn (TxOut CtxUTxO Era))
-&gt; UTxO Era -&gt; Map TxIn (TxOut CtxUTxO Era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Tx -&gt; UTxO Era
</span><span class="hs-identifier hs-var">utxoFromTx</span></span><span> </span><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621680425294"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>  </span><span id="local-6989586621680425295"><span class="annot"><span class="annottext">go :: IO (UTxO era)
</span><a href="#local-6989586621680425295"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-110"></span><span>    </span><span id="local-6989586621680425300"><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621680425300"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo -&gt; QueryPoint -&gt; [TxIn] -&gt; IO (UTxO era)
forall era.
IsShelleyBasedEra era =&gt;
LocalNodeConnectInfo -&gt; QueryPoint -&gt; [TxIn] -&gt; IO (UTxO era)
</span><a href="Hydra.Chain.CardanoClient.html#queryUTxOByTxIn"><span class="hs-identifier hs-var">queryUTxOByTxIn</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425293"><span class="hs-identifier hs-var">connectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="Hydra.Chain.CardanoClient.html#QueryTip"><span class="hs-identifier hs-var">QueryTip</span></a></span><span> </span><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621680425296"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">UTxO era -&gt; Bool
forall era. UTxO era -&gt; Bool
</span><span class="hs-identifier hs-var">UTxO.null</span></span><span> </span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621680425300"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-112"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IO (UTxO era)
</span><a href="#local-6989586621680425295"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-113"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">UTxO era -&gt; IO (UTxO era)
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621680425300"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="annot"><span class="hs-comment">-- * Local state query</span></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="annot"><span class="hs-comment">-- | Describes whether to query at the tip or at a specific point.</span></span><span>
</span><span id="line-118"></span><span class="hs-keyword">data</span><span> </span><span id="QueryPoint"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-var">QueryPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="QueryTip"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryTip"><span class="hs-identifier hs-var">QueryTip</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="QueryAt"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryAt"><span class="hs-identifier hs-var">QueryAt</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainPoint</span></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680425306"><span id="local-6989586621680425310"><span class="annot"><span class="annottext">QueryPoint -&gt; QueryPoint -&gt; Bool
(QueryPoint -&gt; QueryPoint -&gt; Bool)
-&gt; (QueryPoint -&gt; QueryPoint -&gt; Bool) -&gt; Eq QueryPoint
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: QueryPoint -&gt; QueryPoint -&gt; Bool
== :: QueryPoint -&gt; QueryPoint -&gt; Bool
$c/= :: QueryPoint -&gt; QueryPoint -&gt; Bool
/= :: QueryPoint -&gt; QueryPoint -&gt; Bool
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680425314"><span id="local-6989586621680425319"><span id="local-6989586621680425323"><span class="annot"><span class="annottext">Int -&gt; QueryPoint -&gt; ShowS
[QueryPoint] -&gt; ShowS
QueryPoint -&gt; String
(Int -&gt; QueryPoint -&gt; ShowS)
-&gt; (QueryPoint -&gt; String)
-&gt; ([QueryPoint] -&gt; ShowS)
-&gt; Show QueryPoint
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; QueryPoint -&gt; ShowS
showsPrec :: Int -&gt; QueryPoint -&gt; ShowS
$cshow :: QueryPoint -&gt; String
show :: QueryPoint -&gt; String
$cshowList :: [QueryPoint] -&gt; ShowS
showList :: [QueryPoint] -&gt; ShowS
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680425326"><span id="local-6989586621680425328"><span class="annot"><span class="annottext">(forall x. QueryPoint -&gt; Rep QueryPoint x)
-&gt; (forall x. Rep QueryPoint x -&gt; QueryPoint) -&gt; Generic QueryPoint
forall x. Rep QueryPoint x -&gt; QueryPoint
forall x. QueryPoint -&gt; Rep QueryPoint x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. QueryPoint -&gt; Rep QueryPoint x
from :: forall x. QueryPoint -&gt; Rep QueryPoint x
$cto :: forall x. Rep QueryPoint x -&gt; QueryPoint
to :: forall x. Rep QueryPoint x -&gt; QueryPoint
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="annot"><span class="hs-comment">-- | Query the latest chain point aka &quot;the tip&quot;.</span></span><span>
</span><span id="line-122"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#queryTip"><span class="hs-identifier hs-type">queryTip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainPoint</span></span><span>
</span><span id="line-123"></span><span id="queryTip"><span class="annot"><span class="annottext">queryTip :: LocalNodeConnectInfo -&gt; IO ChainPoint
</span><a href="Hydra.Chain.CardanoClient.html#queryTip"><span class="hs-identifier hs-var hs-var">queryTip</span></a></span></span><span> </span><span id="local-6989586621680425332"><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425332"><span class="hs-identifier hs-var">connectInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-124"></span><span>  </span><span class="annot"><span class="annottext">ChainTip -&gt; ChainPoint
</span><span class="hs-identifier hs-var">chainTipToChainPoint</span></span><span> </span><span class="annot"><span class="annottext">(ChainTip -&gt; ChainPoint) -&gt; IO ChainTip -&gt; IO ChainPoint
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo -&gt; IO ChainTip
forall (m :: * -&gt; *).
MonadIO m =&gt;
LocalNodeConnectInfo -&gt; m ChainTip
</span><span class="hs-identifier hs-var">getLocalChainTip</span></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425332"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-comment">-- | Query the system start parameter at given point.</span><span>
</span><span id="line-127"></span><span class="hs-comment">--</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- Throws at least 'QueryException' if query fails.</span><span>
</span><span id="line-129"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#querySystemStart"><span class="hs-identifier hs-type">querySystemStart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-type">QueryPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SystemStart</span></span><span>
</span><span id="line-130"></span><span id="querySystemStart"><span class="annot"><span class="annottext">querySystemStart :: LocalNodeConnectInfo -&gt; QueryPoint -&gt; IO SystemStart
</span><a href="Hydra.Chain.CardanoClient.html#querySystemStart"><span class="hs-identifier hs-var hs-var">querySystemStart</span></a></span></span><span> </span><span id="local-6989586621680425337"><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425337"><span class="hs-identifier hs-var">connectInfo</span></a></span></span><span> </span><span id="local-6989586621680425338"><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621680425338"><span class="hs-identifier hs-var">queryPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-131"></span><span>  </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
-&gt; QueryPoint
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO SystemStart
-&gt; IO SystemStart
forall a.
LocalNodeConnectInfo
-&gt; QueryPoint
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; IO a
</span><a href="Hydra.Chain.CardanoClient.html#runQueryExpr"><span class="hs-identifier hs-var">runQueryExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425337"><span class="hs-identifier hs-var">connectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621680425338"><span class="hs-identifier hs-var">queryPoint</span></a></span><span> </span><span class="annot"><span class="annottext">(LocalStateQueryExpr
   BlockInMode ChainPoint QueryInMode () IO SystemStart
 -&gt; IO SystemStart)
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO SystemStart
-&gt; IO SystemStart
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><span class="annottext">LocalStateQueryExpr
  BlockInMode
  ChainPoint
  QueryInMode
  ()
  IO
  (Either UnsupportedNtcVersionError SystemStart)
forall block point r.
LocalStateQueryExpr
  block
  point
  QueryInMode
  r
  IO
  (Either UnsupportedNtcVersionError SystemStart)
</span><span class="hs-identifier hs-var">Query.querySystemStart</span></span><span> </span><span class="annot"><span class="annottext">LocalStateQueryExpr
  BlockInMode
  ChainPoint
  QueryInMode
  ()
  IO
  (Either UnsupportedNtcVersionError SystemStart)
-&gt; (Either UnsupportedNtcVersionError SystemStart
    -&gt; LocalStateQueryExpr
         BlockInMode ChainPoint QueryInMode () IO SystemStart)
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO SystemStart
forall a b.
LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; (a
    -&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b)
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO SystemStart
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO SystemStart
forall a.
IO a
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO SystemStart
 -&gt; LocalStateQueryExpr
      BlockInMode ChainPoint QueryInMode () IO SystemStart)
-&gt; (Either UnsupportedNtcVersionError SystemStart
    -&gt; IO SystemStart)
-&gt; Either UnsupportedNtcVersionError SystemStart
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO SystemStart
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either UnsupportedNtcVersionError SystemStart -&gt; IO SystemStart
forall (m :: * -&gt; *) a.
MonadThrow m =&gt;
Either UnsupportedNtcVersionError a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnUnsupportedNtcVersion"><span class="hs-identifier hs-var">throwOnUnsupportedNtcVersion</span></a></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- | Query the era history at given point.</span><span>
</span><span id="line-135"></span><span class="hs-comment">--</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- Throws at least 'QueryException' if query fails.</span><span>
</span><span id="line-137"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#queryEraHistory"><span class="hs-identifier hs-type">queryEraHistory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-type">QueryPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraHistory</span></span><span>
</span><span id="line-138"></span><span id="queryEraHistory"><span class="annot"><span class="annottext">queryEraHistory :: LocalNodeConnectInfo -&gt; QueryPoint -&gt; IO EraHistory
</span><a href="Hydra.Chain.CardanoClient.html#queryEraHistory"><span class="hs-identifier hs-var hs-var">queryEraHistory</span></a></span></span><span> </span><span id="local-6989586621680425345"><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425345"><span class="hs-identifier hs-var">connectInfo</span></a></span></span><span> </span><span id="local-6989586621680425346"><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621680425346"><span class="hs-identifier hs-var">queryPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
-&gt; QueryPoint
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO EraHistory
-&gt; IO EraHistory
forall a.
LocalNodeConnectInfo
-&gt; QueryPoint
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; IO a
</span><a href="Hydra.Chain.CardanoClient.html#runQueryExpr"><span class="hs-identifier hs-var">runQueryExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425345"><span class="hs-identifier hs-var">connectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621680425346"><span class="hs-identifier hs-var">queryPoint</span></a></span><span> </span><span class="annot"><span class="annottext">(LocalStateQueryExpr
   BlockInMode ChainPoint QueryInMode () IO EraHistory
 -&gt; IO EraHistory)
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO EraHistory
-&gt; IO EraHistory
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><span class="annottext">LocalStateQueryExpr
  BlockInMode
  ChainPoint
  QueryInMode
  ()
  IO
  (Either UnsupportedNtcVersionError EraHistory)
forall block point r.
LocalStateQueryExpr
  block
  point
  QueryInMode
  r
  IO
  (Either UnsupportedNtcVersionError EraHistory)
</span><span class="hs-identifier hs-var">Query.queryEraHistory</span></span><span> </span><span class="annot"><span class="annottext">LocalStateQueryExpr
  BlockInMode
  ChainPoint
  QueryInMode
  ()
  IO
  (Either UnsupportedNtcVersionError EraHistory)
-&gt; (Either UnsupportedNtcVersionError EraHistory
    -&gt; LocalStateQueryExpr
         BlockInMode ChainPoint QueryInMode () IO EraHistory)
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO EraHistory
forall a b.
LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; (a
    -&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b)
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO EraHistory
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO EraHistory
forall a.
IO a
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO EraHistory
 -&gt; LocalStateQueryExpr
      BlockInMode ChainPoint QueryInMode () IO EraHistory)
-&gt; (Either UnsupportedNtcVersionError EraHistory -&gt; IO EraHistory)
-&gt; Either UnsupportedNtcVersionError EraHistory
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO EraHistory
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either UnsupportedNtcVersionError EraHistory -&gt; IO EraHistory
forall (m :: * -&gt; *) a.
MonadThrow m =&gt;
Either UnsupportedNtcVersionError a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnUnsupportedNtcVersion"><span class="hs-identifier hs-var">throwOnUnsupportedNtcVersion</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-comment">-- | Query the current epoch number.</span><span>
</span><span id="line-143"></span><span class="hs-comment">--</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- Throws at least 'QueryException' if query fails.</span><span>
</span><span id="line-145"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#queryEpochNo"><span class="hs-identifier hs-type">queryEpochNo</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-146"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-147"></span><span>  </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-type">QueryPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-148"></span><span>  </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EpochNo</span></span><span>
</span><span id="line-149"></span><span id="queryEpochNo"><span class="annot"><span class="annottext">queryEpochNo :: LocalNodeConnectInfo -&gt; QueryPoint -&gt; IO EpochNo
</span><a href="Hydra.Chain.CardanoClient.html#queryEpochNo"><span class="hs-identifier hs-var hs-var">queryEpochNo</span></a></span></span><span> </span><span id="local-6989586621680425349"><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425349"><span class="hs-identifier hs-var">connectInfo</span></a></span></span><span> </span><span id="local-6989586621680425350"><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621680425350"><span class="hs-identifier hs-var">queryPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
-&gt; QueryPoint
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO EpochNo
-&gt; IO EpochNo
forall a.
LocalNodeConnectInfo
-&gt; QueryPoint
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; IO a
</span><a href="Hydra.Chain.CardanoClient.html#runQueryExpr"><span class="hs-identifier hs-var">runQueryExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425349"><span class="hs-identifier hs-var">connectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621680425350"><span class="hs-identifier hs-var">queryPoint</span></a></span><span> </span><span class="annot"><span class="annottext">(LocalStateQueryExpr
   BlockInMode ChainPoint QueryInMode () IO EpochNo
 -&gt; IO EpochNo)
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO EpochNo
-&gt; IO EpochNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><span class="annottext">(forall era.
 ShelleyBasedEra era
 -&gt; LocalStateQueryExpr
      BlockInMode ChainPoint QueryInMode () IO EpochNo)
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO EpochNo
forall b p r a.
(forall era.
 ShelleyBasedEra era -&gt; LocalStateQueryExpr b p QueryInMode r IO a)
-&gt; LocalStateQueryExpr b p QueryInMode r IO a
</span><a href="Hydra.Chain.CardanoClient.html#queryForCurrentEraInShelleyBasedEraExpr"><span class="hs-identifier hs-var">queryForCurrentEraInShelleyBasedEraExpr</span></a></span><span> </span><span class="annot"><span class="annottext">((forall era.
  ShelleyBasedEra era
  -&gt; LocalStateQueryExpr
       BlockInMode ChainPoint QueryInMode () IO EpochNo)
 -&gt; LocalStateQueryExpr
      BlockInMode ChainPoint QueryInMode () IO EpochNo)
-&gt; (forall era.
    ShelleyBasedEra era
    -&gt; LocalStateQueryExpr
         BlockInMode ChainPoint QueryInMode () IO EpochNo)
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO EpochNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680425358"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621680425358"><span class="hs-identifier hs-var">sbe</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-152"></span><span>      </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either UnsupportedNtcVersionError (Either EraMismatch EpochNo))
forall era block point r.
ShelleyBasedEra era
-&gt; LocalStateQueryExpr
     block
     point
     QueryInMode
     r
     IO
     (Either UnsupportedNtcVersionError (Either EraMismatch EpochNo))
</span><span class="hs-identifier hs-var">Query.queryEpoch</span></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621680425358"><span class="hs-identifier hs-var">sbe</span></a></span><span>
</span><span id="line-153"></span><span>        </span><span class="annot"><span class="annottext">LocalStateQueryExpr
  BlockInMode
  ChainPoint
  QueryInMode
  ()
  IO
  (Either UnsupportedNtcVersionError (Either EraMismatch EpochNo))
-&gt; (Either UnsupportedNtcVersionError (Either EraMismatch EpochNo)
    -&gt; LocalStateQueryExpr
         BlockInMode
         ChainPoint
         QueryInMode
         ()
         IO
         (Either EraMismatch EpochNo))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either EraMismatch EpochNo)
forall a b.
LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; (a
    -&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b)
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either EraMismatch EpochNo)
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either EraMismatch EpochNo)
forall a.
IO a
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span>
</span><span id="line-154"></span><span>        </span><span class="annot"><span class="annottext">(IO (Either EraMismatch EpochNo)
 -&gt; LocalStateQueryExpr
      BlockInMode
      ChainPoint
      QueryInMode
      ()
      IO
      (Either EraMismatch EpochNo))
-&gt; (Either UnsupportedNtcVersionError (Either EraMismatch EpochNo)
    -&gt; IO (Either EraMismatch EpochNo))
-&gt; Either UnsupportedNtcVersionError (Either EraMismatch EpochNo)
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either EraMismatch EpochNo)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either UnsupportedNtcVersionError (Either EraMismatch EpochNo)
-&gt; IO (Either EraMismatch EpochNo)
forall (m :: * -&gt; *) a.
MonadThrow m =&gt;
Either UnsupportedNtcVersionError a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnUnsupportedNtcVersion"><span class="hs-identifier hs-var">throwOnUnsupportedNtcVersion</span></a></span><span>
</span><span id="line-155"></span><span>        </span><span class="annot"><span class="annottext">LocalStateQueryExpr
  BlockInMode
  ChainPoint
  QueryInMode
  ()
  IO
  (Either EraMismatch EpochNo)
-&gt; (Either EraMismatch EpochNo
    -&gt; LocalStateQueryExpr
         BlockInMode ChainPoint QueryInMode () IO EpochNo)
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO EpochNo
forall a b.
LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; (a
    -&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b)
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO EpochNo
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO EpochNo
forall a.
IO a
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span>
</span><span id="line-156"></span><span>        </span><span class="annot"><span class="annottext">(IO EpochNo
 -&gt; LocalStateQueryExpr
      BlockInMode ChainPoint QueryInMode () IO EpochNo)
-&gt; (Either EraMismatch EpochNo -&gt; IO EpochNo)
-&gt; Either EraMismatch EpochNo
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO EpochNo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either EraMismatch EpochNo -&gt; IO EpochNo
forall (m :: * -&gt; *) a. MonadThrow m =&gt; Either EraMismatch a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnEraMismatch"><span class="hs-identifier hs-var">throwOnEraMismatch</span></a></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-comment">-- | Query the protocol parameters at given point and convert them to Babbage</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- era protocol parameters.</span><span>
</span><span id="line-160"></span><span class="hs-comment">--</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- Throws at least 'QueryException' if query fails.</span><span>
</span><span id="line-162"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#queryProtocolParameters"><span class="hs-identifier hs-type">queryProtocolParameters</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-163"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-164"></span><span>  </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-type">QueryPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-165"></span><span>  </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PParams</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LedgerEra</span></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span id="queryProtocolParameters"><span class="annot"><span class="annottext">queryProtocolParameters :: LocalNodeConnectInfo -&gt; QueryPoint -&gt; IO (PParams LedgerEra)
</span><a href="Hydra.Chain.CardanoClient.html#queryProtocolParameters"><span class="hs-identifier hs-var hs-var">queryProtocolParameters</span></a></span></span><span> </span><span id="local-6989586621680425362"><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425362"><span class="hs-identifier hs-var">connectInfo</span></a></span></span><span> </span><span id="local-6989586621680425363"><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621680425363"><span class="hs-identifier hs-var">queryPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-167"></span><span>  </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
-&gt; QueryPoint
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (PParams LedgerEra)
-&gt; IO (PParams LedgerEra)
forall a.
LocalNodeConnectInfo
-&gt; QueryPoint
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; IO a
</span><a href="Hydra.Chain.CardanoClient.html#runQueryExpr"><span class="hs-identifier hs-var">runQueryExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425362"><span class="hs-identifier hs-var">connectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621680425363"><span class="hs-identifier hs-var">queryPoint</span></a></span><span> </span><span class="annot"><span class="annottext">(LocalStateQueryExpr
   BlockInMode ChainPoint QueryInMode () IO (PParams LedgerEra)
 -&gt; IO (PParams LedgerEra))
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (PParams LedgerEra)
-&gt; IO (PParams LedgerEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><span class="annottext">(forall era.
 ShelleyBasedEra era
 -&gt; LocalStateQueryExpr
      BlockInMode ChainPoint QueryInMode () IO (PParams LedgerEra))
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (PParams LedgerEra)
forall b p r a.
(forall era.
 ShelleyBasedEra era -&gt; LocalStateQueryExpr b p QueryInMode r IO a)
-&gt; LocalStateQueryExpr b p QueryInMode r IO a
</span><a href="Hydra.Chain.CardanoClient.html#queryForCurrentEraInShelleyBasedEraExpr"><span class="hs-identifier hs-var">queryForCurrentEraInShelleyBasedEraExpr</span></a></span><span> </span><span class="annot"><span class="annottext">((forall era.
  ShelleyBasedEra era
  -&gt; LocalStateQueryExpr
       BlockInMode ChainPoint QueryInMode () IO (PParams LedgerEra))
 -&gt; LocalStateQueryExpr
      BlockInMode ChainPoint QueryInMode () IO (PParams LedgerEra))
-&gt; (forall era.
    ShelleyBasedEra era
    -&gt; LocalStateQueryExpr
         BlockInMode ChainPoint QueryInMode () IO (PParams LedgerEra))
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (PParams LedgerEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680425374"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621680425374"><span class="hs-identifier hs-var">sbe</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-169"></span><span>      </span><span id="local-6989586621680425375"><span class="annot"><span class="annottext">PParams (ShelleyLedgerEra era)
</span><a href="#local-6989586621680425375"><span class="hs-identifier hs-var">eraPParams</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-170"></span><span>        </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either
        UnsupportedNtcVersionError
        (Either EraMismatch (PParams (ShelleyLedgerEra era))))
forall era block point r.
ShelleyBasedEra era
-&gt; LocalStateQueryExpr
     block
     point
     QueryInMode
     r
     IO
     (Either
        UnsupportedNtcVersionError
        (Either EraMismatch (PParams (ShelleyLedgerEra era))))
</span><span class="hs-identifier hs-var">Query.queryProtocolParameters</span></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621680425374"><span class="hs-identifier hs-var">sbe</span></a></span><span>
</span><span id="line-171"></span><span>          </span><span class="annot"><span class="annottext">LocalStateQueryExpr
  BlockInMode
  ChainPoint
  QueryInMode
  ()
  IO
  (Either
     UnsupportedNtcVersionError
     (Either EraMismatch (PParams (ShelleyLedgerEra era))))
-&gt; (Either
      UnsupportedNtcVersionError
      (Either EraMismatch (PParams (ShelleyLedgerEra era)))
    -&gt; LocalStateQueryExpr
         BlockInMode
         ChainPoint
         QueryInMode
         ()
         IO
         (Either EraMismatch (PParams (ShelleyLedgerEra era))))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either EraMismatch (PParams (ShelleyLedgerEra era)))
forall a b.
LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; (a
    -&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b)
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either EraMismatch (PParams (ShelleyLedgerEra era)))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either EraMismatch (PParams (ShelleyLedgerEra era)))
forall a.
IO a
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span>
</span><span id="line-172"></span><span>          </span><span class="annot"><span class="annottext">(IO (Either EraMismatch (PParams (ShelleyLedgerEra era)))
 -&gt; LocalStateQueryExpr
      BlockInMode
      ChainPoint
      QueryInMode
      ()
      IO
      (Either EraMismatch (PParams (ShelleyLedgerEra era))))
-&gt; (Either
      UnsupportedNtcVersionError
      (Either EraMismatch (PParams (ShelleyLedgerEra era)))
    -&gt; IO (Either EraMismatch (PParams (ShelleyLedgerEra era))))
-&gt; Either
     UnsupportedNtcVersionError
     (Either EraMismatch (PParams (ShelleyLedgerEra era)))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either EraMismatch (PParams (ShelleyLedgerEra era)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  UnsupportedNtcVersionError
  (Either EraMismatch (PParams (ShelleyLedgerEra era)))
-&gt; IO (Either EraMismatch (PParams (ShelleyLedgerEra era)))
forall (m :: * -&gt; *) a.
MonadThrow m =&gt;
Either UnsupportedNtcVersionError a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnUnsupportedNtcVersion"><span class="hs-identifier hs-var">throwOnUnsupportedNtcVersion</span></a></span><span>
</span><span id="line-173"></span><span>          </span><span class="annot"><span class="annottext">LocalStateQueryExpr
  BlockInMode
  ChainPoint
  QueryInMode
  ()
  IO
  (Either EraMismatch (PParams (ShelleyLedgerEra era)))
-&gt; (Either EraMismatch (PParams (ShelleyLedgerEra era))
    -&gt; LocalStateQueryExpr
         BlockInMode
         ChainPoint
         QueryInMode
         ()
         IO
         (PParams (ShelleyLedgerEra era)))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (PParams (ShelleyLedgerEra era))
forall a b.
LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; (a
    -&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b)
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO (PParams (ShelleyLedgerEra era))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (PParams (ShelleyLedgerEra era))
forall a.
IO a
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span>
</span><span id="line-174"></span><span>          </span><span class="annot"><span class="annottext">(IO (PParams (ShelleyLedgerEra era))
 -&gt; LocalStateQueryExpr
      BlockInMode
      ChainPoint
      QueryInMode
      ()
      IO
      (PParams (ShelleyLedgerEra era)))
-&gt; (Either EraMismatch (PParams (ShelleyLedgerEra era))
    -&gt; IO (PParams (ShelleyLedgerEra era)))
-&gt; Either EraMismatch (PParams (ShelleyLedgerEra era))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (PParams (ShelleyLedgerEra era))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either EraMismatch (PParams (ShelleyLedgerEra era))
-&gt; IO (PParams (ShelleyLedgerEra era))
forall (m :: * -&gt; *) a. MonadThrow m =&gt; Either EraMismatch a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnEraMismatch"><span class="hs-identifier hs-var">throwOnEraMismatch</span></a></span><span>
</span><span id="line-175"></span><span>      </span><span class="annot"><span class="annottext">IO (PParams LedgerEra)
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (PParams LedgerEra)
forall a.
IO a
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (PParams LedgerEra)
 -&gt; LocalStateQueryExpr
      BlockInMode ChainPoint QueryInMode () IO (PParams LedgerEra))
-&gt; IO (PParams LedgerEra)
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (PParams LedgerEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoEra era
-&gt; PParams (ShelleyLedgerEra era) -&gt; IO (PParams LedgerEra)
forall era.
CardanoEra era
-&gt; PParams (ShelleyLedgerEra era) -&gt; IO (PParams LedgerEra)
</span><a href="#local-6989586621680425377"><span class="hs-identifier hs-var">coercePParamsToLedgerEra</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyBasedEra era -&gt; CardanoEra era
forall era. ShelleyBasedEra era -&gt; CardanoEra era
forall a (f :: a -&gt; *) (g :: a -&gt; *) (era :: a).
Convert f g =&gt;
f era -&gt; g era
</span><span class="hs-identifier hs-var">convert</span></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621680425374"><span class="hs-identifier hs-var">sbe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PParams (ShelleyLedgerEra era)
</span><a href="#local-6989586621680425375"><span class="hs-identifier hs-var">eraPParams</span></a></span><span>
</span><span id="line-176"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-177"></span><span>  </span><span id="local-6989586621680424964"><span id="local-6989586621680424966"><span class="annot"><a href="#local-6989586621680425379"><span class="hs-identifier hs-type">encodeToEra</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680424964"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680424966"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680424964"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PParams</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LedgerEra</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-178"></span><span>  </span><span id="local-6989586621680425379"><span class="annot"><span class="annottext">encodeToEra :: forall a era.
ToJSON a =&gt;
CardanoEra era -&gt; a -&gt; IO (PParams LedgerEra)
</span><a href="#local-6989586621680425379"><span class="hs-identifier hs-var hs-var">encodeToEra</span></a></span></span><span> </span><span id="local-6989586621680425392"><span class="annot"><span class="annottext">CardanoEra era
</span><a href="#local-6989586621680425392"><span class="hs-identifier hs-var">eraToEncode</span></a></span></span><span> </span><span id="local-6989586621680425393"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680425393"><span class="hs-identifier hs-var">pparams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String (PParams ConwayEra)
forall a. FromJSON a =&gt; ByteString -&gt; Either String a
</span><span class="hs-identifier hs-var">eitherDecode'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encode</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680425393"><span class="hs-identifier hs-var">pparams</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-180"></span><span>      </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621680425394"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680425394"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QueryException -&gt; IO (PParams LedgerEra)
forall e a. Exception e =&gt; e -&gt; IO a
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">(QueryException -&gt; IO (PParams LedgerEra))
-&gt; QueryException -&gt; IO (PParams LedgerEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AnyCardanoEra -&gt; Text -&gt; QueryException
</span><a href="Hydra.Chain.CardanoClient.html#QueryProtocolParamsEncodingFailureOnEra"><span class="hs-identifier hs-var">QueryProtocolParamsEncodingFailureOnEra</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoEra era -&gt; AnyCardanoEra
forall era. CardanoEra era -&gt; AnyCardanoEra
</span><span class="hs-identifier hs-var">anyCardanoEra</span></span><span> </span><span class="annot"><span class="annottext">CardanoEra era
</span><a href="#local-6989586621680425392"><span class="hs-identifier hs-var">eraToEncode</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/text-2.0.2/src/Data.Text.Internal.html#pack"><span class="hs-identifier hs-var">Text.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680425394"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>      </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680425397"><span class="annot"><span class="annottext">PParams LedgerEra
</span><a href="#local-6989586621680425397"><span class="hs-identifier hs-var">ok</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PParams</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LedgerEra</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PParams ConwayEra -&gt; IO (PParams ConwayEra)
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">PParams ConwayEra
PParams LedgerEra
</span><a href="#local-6989586621680425397"><span class="hs-identifier hs-var">ok</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span>  </span><span id="local-6989586621680424959"><span class="annot"><a href="#local-6989586621680425377"><span class="hs-identifier hs-type">coercePParamsToLedgerEra</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680424959"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PParams</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ShelleyLedgerEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680424959"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PParams</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LedgerEra</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-184"></span><span>  </span><span id="local-6989586621680425377"><span class="annot"><span class="annottext">coercePParamsToLedgerEra :: forall era.
CardanoEra era
-&gt; PParams (ShelleyLedgerEra era) -&gt; IO (PParams LedgerEra)
</span><a href="#local-6989586621680425377"><span class="hs-identifier hs-var hs-var">coercePParamsToLedgerEra</span></a></span></span><span> </span><span id="local-6989586621680425398"><span class="annot"><span class="annottext">CardanoEra era
</span><a href="#local-6989586621680425398"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621680425399"><span class="annot"><span class="annottext">PParams (ShelleyLedgerEra era)
</span><a href="#local-6989586621680425399"><span class="hs-identifier hs-var">pparams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CardanoEra era
</span><a href="#local-6989586621680425398"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-186"></span><span>      </span><span class="annot"><span class="annottext">CardanoEra era
</span><span class="hs-identifier hs-var">ByronEra</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QueryException -&gt; IO (PParams LedgerEra)
forall e a. Exception e =&gt; e -&gt; IO a
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">(QueryException -&gt; IO (PParams LedgerEra))
-&gt; QueryException -&gt; IO (PParams LedgerEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AnyCardanoEra -&gt; QueryException
</span><a href="Hydra.Chain.CardanoClient.html#QueryProtocolParamsEraNotSupported"><span class="hs-identifier hs-var">QueryProtocolParamsEraNotSupported</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoEra ByronEra -&gt; AnyCardanoEra
forall era. CardanoEra era -&gt; AnyCardanoEra
</span><span class="hs-identifier hs-var">anyCardanoEra</span></span><span> </span><span class="annot"><span class="annottext">CardanoEra ByronEra
</span><span class="hs-identifier hs-var">ByronEra</span></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>      </span><span class="annot"><span class="annottext">CardanoEra era
</span><span class="hs-identifier hs-var">ShelleyEra</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CardanoEra ShelleyEra
-&gt; PParams ShelleyEra -&gt; IO (PParams LedgerEra)
forall a era.
ToJSON a =&gt;
CardanoEra era -&gt; a -&gt; IO (PParams LedgerEra)
</span><a href="#local-6989586621680425379"><span class="hs-identifier hs-var">encodeToEra</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoEra ShelleyEra
</span><span class="hs-identifier hs-var">ShelleyEra</span></span><span> </span><span class="annot"><span class="annottext">PParams ShelleyEra
PParams (ShelleyLedgerEra era)
</span><a href="#local-6989586621680425399"><span class="hs-identifier hs-var">pparams</span></a></span><span>
</span><span id="line-188"></span><span>      </span><span class="annot"><span class="annottext">CardanoEra era
</span><span class="hs-identifier hs-var">AllegraEra</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CardanoEra AllegraEra
-&gt; PParams AllegraEra -&gt; IO (PParams LedgerEra)
forall a era.
ToJSON a =&gt;
CardanoEra era -&gt; a -&gt; IO (PParams LedgerEra)
</span><a href="#local-6989586621680425379"><span class="hs-identifier hs-var">encodeToEra</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoEra AllegraEra
</span><span class="hs-identifier hs-var">AllegraEra</span></span><span> </span><span class="annot"><span class="annottext">PParams AllegraEra
PParams (ShelleyLedgerEra era)
</span><a href="#local-6989586621680425399"><span class="hs-identifier hs-var">pparams</span></a></span><span>
</span><span id="line-189"></span><span>      </span><span class="annot"><span class="annottext">CardanoEra era
</span><span class="hs-identifier hs-var">MaryEra</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CardanoEra MaryEra -&gt; PParams MaryEra -&gt; IO (PParams LedgerEra)
forall a era.
ToJSON a =&gt;
CardanoEra era -&gt; a -&gt; IO (PParams LedgerEra)
</span><a href="#local-6989586621680425379"><span class="hs-identifier hs-var">encodeToEra</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoEra MaryEra
</span><span class="hs-identifier hs-var">MaryEra</span></span><span> </span><span class="annot"><span class="annottext">PParams MaryEra
PParams (ShelleyLedgerEra era)
</span><a href="#local-6989586621680425399"><span class="hs-identifier hs-var">pparams</span></a></span><span>
</span><span id="line-190"></span><span>      </span><span class="annot"><span class="annottext">CardanoEra era
</span><span class="hs-identifier hs-var">AlonzoEra</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CardanoEra AlonzoEra -&gt; PParams AlonzoEra -&gt; IO (PParams LedgerEra)
forall a era.
ToJSON a =&gt;
CardanoEra era -&gt; a -&gt; IO (PParams LedgerEra)
</span><a href="#local-6989586621680425379"><span class="hs-identifier hs-var">encodeToEra</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoEra AlonzoEra
</span><span class="hs-identifier hs-var">AlonzoEra</span></span><span> </span><span class="annot"><span class="annottext">PParams AlonzoEra
PParams (ShelleyLedgerEra era)
</span><a href="#local-6989586621680425399"><span class="hs-identifier hs-var">pparams</span></a></span><span>
</span><span id="line-191"></span><span>      </span><span class="annot"><span class="annottext">CardanoEra era
</span><span class="hs-identifier hs-var">BabbageEra</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CardanoEra BabbageEra
-&gt; PParams BabbageEra -&gt; IO (PParams LedgerEra)
forall a era.
ToJSON a =&gt;
CardanoEra era -&gt; a -&gt; IO (PParams LedgerEra)
</span><a href="#local-6989586621680425379"><span class="hs-identifier hs-var">encodeToEra</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoEra BabbageEra
</span><span class="hs-identifier hs-var">BabbageEra</span></span><span> </span><span class="annot"><span class="annottext">PParams BabbageEra
PParams (ShelleyLedgerEra era)
</span><a href="#local-6989586621680425399"><span class="hs-identifier hs-var">pparams</span></a></span><span>
</span><span id="line-192"></span><span>      </span><span class="annot"><span class="annottext">CardanoEra era
</span><span class="hs-identifier hs-var">ConwayEra</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PParams ConwayEra -&gt; IO (PParams ConwayEra)
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">PParams ConwayEra
PParams (ShelleyLedgerEra era)
</span><a href="#local-6989586621680425399"><span class="hs-identifier hs-var">pparams</span></a></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">-- | Query 'GenesisParameters' at a given point.</span><span>
</span><span id="line-195"></span><span class="hs-comment">--</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- Throws at least 'QueryException' if query fails.</span><span>
</span><span id="line-197"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#queryGenesisParameters"><span class="hs-identifier hs-type">queryGenesisParameters</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-199"></span><span>  </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-type">QueryPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-200"></span><span>  </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GenesisParameters</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ShelleyEra</span></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span id="queryGenesisParameters"><span class="annot"><span class="annottext">queryGenesisParameters :: LocalNodeConnectInfo
-&gt; QueryPoint -&gt; IO (GenesisParameters ShelleyEra)
</span><a href="Hydra.Chain.CardanoClient.html#queryGenesisParameters"><span class="hs-identifier hs-var hs-var">queryGenesisParameters</span></a></span></span><span> </span><span id="local-6989586621680425468"><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425468"><span class="hs-identifier hs-var">connectInfo</span></a></span></span><span> </span><span id="local-6989586621680425469"><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621680425469"><span class="hs-identifier hs-var">queryPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
-&gt; QueryPoint
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (GenesisParameters ShelleyEra)
-&gt; IO (GenesisParameters ShelleyEra)
forall a.
LocalNodeConnectInfo
-&gt; QueryPoint
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; IO a
</span><a href="Hydra.Chain.CardanoClient.html#runQueryExpr"><span class="hs-identifier hs-var">runQueryExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425468"><span class="hs-identifier hs-var">connectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621680425469"><span class="hs-identifier hs-var">queryPoint</span></a></span><span> </span><span class="annot"><span class="annottext">(LocalStateQueryExpr
   BlockInMode
   ChainPoint
   QueryInMode
   ()
   IO
   (GenesisParameters ShelleyEra)
 -&gt; IO (GenesisParameters ShelleyEra))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (GenesisParameters ShelleyEra)
-&gt; IO (GenesisParameters ShelleyEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><span class="annottext">(forall era.
 ShelleyBasedEra era
 -&gt; LocalStateQueryExpr
      BlockInMode
      ChainPoint
      QueryInMode
      ()
      IO
      (GenesisParameters ShelleyEra))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (GenesisParameters ShelleyEra)
forall b p r a.
(forall era.
 ShelleyBasedEra era -&gt; LocalStateQueryExpr b p QueryInMode r IO a)
-&gt; LocalStateQueryExpr b p QueryInMode r IO a
</span><a href="Hydra.Chain.CardanoClient.html#queryForCurrentEraInShelleyBasedEraExpr"><span class="hs-identifier hs-var">queryForCurrentEraInShelleyBasedEraExpr</span></a></span><span> </span><span class="annot"><span class="annottext">((forall era.
  ShelleyBasedEra era
  -&gt; LocalStateQueryExpr
       BlockInMode
       ChainPoint
       QueryInMode
       ()
       IO
       (GenesisParameters ShelleyEra))
 -&gt; LocalStateQueryExpr
      BlockInMode
      ChainPoint
      QueryInMode
      ()
      IO
      (GenesisParameters ShelleyEra))
-&gt; (forall era.
    ShelleyBasedEra era
    -&gt; LocalStateQueryExpr
         BlockInMode
         ChainPoint
         QueryInMode
         ()
         IO
         (GenesisParameters ShelleyEra))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (GenesisParameters ShelleyEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680425476"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621680425476"><span class="hs-identifier hs-var">sbe</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-204"></span><span>      </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either
        UnsupportedNtcVersionError
        (Either EraMismatch (GenesisParameters ShelleyEra)))
forall era block point r.
ShelleyBasedEra era
-&gt; LocalStateQueryExpr
     block
     point
     QueryInMode
     r
     IO
     (Either
        UnsupportedNtcVersionError
        (Either EraMismatch (GenesisParameters ShelleyEra)))
</span><span class="hs-identifier hs-var">Query.queryGenesisParameters</span></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621680425476"><span class="hs-identifier hs-var">sbe</span></a></span><span>
</span><span id="line-205"></span><span>        </span><span class="annot"><span class="annottext">LocalStateQueryExpr
  BlockInMode
  ChainPoint
  QueryInMode
  ()
  IO
  (Either
     UnsupportedNtcVersionError
     (Either EraMismatch (GenesisParameters ShelleyEra)))
-&gt; (Either
      UnsupportedNtcVersionError
      (Either EraMismatch (GenesisParameters ShelleyEra))
    -&gt; LocalStateQueryExpr
         BlockInMode
         ChainPoint
         QueryInMode
         ()
         IO
         (Either EraMismatch (GenesisParameters ShelleyEra)))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either EraMismatch (GenesisParameters ShelleyEra))
forall a b.
LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; (a
    -&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b)
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either EraMismatch (GenesisParameters ShelleyEra))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either EraMismatch (GenesisParameters ShelleyEra))
forall a.
IO a
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span>
</span><span id="line-206"></span><span>        </span><span class="annot"><span class="annottext">(IO (Either EraMismatch (GenesisParameters ShelleyEra))
 -&gt; LocalStateQueryExpr
      BlockInMode
      ChainPoint
      QueryInMode
      ()
      IO
      (Either EraMismatch (GenesisParameters ShelleyEra)))
-&gt; (Either
      UnsupportedNtcVersionError
      (Either EraMismatch (GenesisParameters ShelleyEra))
    -&gt; IO (Either EraMismatch (GenesisParameters ShelleyEra)))
-&gt; Either
     UnsupportedNtcVersionError
     (Either EraMismatch (GenesisParameters ShelleyEra))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either EraMismatch (GenesisParameters ShelleyEra))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  UnsupportedNtcVersionError
  (Either EraMismatch (GenesisParameters ShelleyEra))
-&gt; IO (Either EraMismatch (GenesisParameters ShelleyEra))
forall (m :: * -&gt; *) a.
MonadThrow m =&gt;
Either UnsupportedNtcVersionError a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnUnsupportedNtcVersion"><span class="hs-identifier hs-var">throwOnUnsupportedNtcVersion</span></a></span><span>
</span><span id="line-207"></span><span>        </span><span class="annot"><span class="annottext">LocalStateQueryExpr
  BlockInMode
  ChainPoint
  QueryInMode
  ()
  IO
  (Either EraMismatch (GenesisParameters ShelleyEra))
-&gt; (Either EraMismatch (GenesisParameters ShelleyEra)
    -&gt; LocalStateQueryExpr
         BlockInMode
         ChainPoint
         QueryInMode
         ()
         IO
         (GenesisParameters ShelleyEra))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (GenesisParameters ShelleyEra)
forall a b.
LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; (a
    -&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b)
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO (GenesisParameters ShelleyEra)
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (GenesisParameters ShelleyEra)
forall a.
IO a
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span>
</span><span id="line-208"></span><span>        </span><span class="annot"><span class="annottext">(IO (GenesisParameters ShelleyEra)
 -&gt; LocalStateQueryExpr
      BlockInMode
      ChainPoint
      QueryInMode
      ()
      IO
      (GenesisParameters ShelleyEra))
-&gt; (Either EraMismatch (GenesisParameters ShelleyEra)
    -&gt; IO (GenesisParameters ShelleyEra))
-&gt; Either EraMismatch (GenesisParameters ShelleyEra)
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (GenesisParameters ShelleyEra)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either EraMismatch (GenesisParameters ShelleyEra)
-&gt; IO (GenesisParameters ShelleyEra)
forall (m :: * -&gt; *) a. MonadThrow m =&gt; Either EraMismatch a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnEraMismatch"><span class="hs-identifier hs-var">throwOnEraMismatch</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">-- | Query UTxO for all given addresses at given point.</span><span>
</span><span id="line-211"></span><span class="hs-comment">--</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- Throws at least 'QueryException' if query fails.</span><span>
</span><span id="line-213"></span><span id="local-6989586621680425007"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#queryUTxO"><span class="hs-identifier hs-type">queryUTxO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsShelleyBasedEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680425007"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-type">QueryPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Address</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ShelleyAddr</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="annot"><a href="#local-6989586621680425007"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-214"></span><span id="queryUTxO"><span class="annot"><span class="annottext">queryUTxO :: forall era.
IsShelleyBasedEra era =&gt;
LocalNodeConnectInfo
-&gt; QueryPoint -&gt; [Address ShelleyAddr] -&gt; IO (UTxO era)
</span><a href="Hydra.Chain.CardanoClient.html#queryUTxO"><span class="hs-identifier hs-var hs-var">queryUTxO</span></a></span></span><span> </span><span id="local-6989586621680425489"><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425489"><span class="hs-identifier hs-var">connectInfo</span></a></span></span><span> </span><span id="local-6989586621680425490"><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621680425490"><span class="hs-identifier hs-var">queryPoint</span></a></span></span><span> </span><span id="local-6989586621680425491"><span class="annot"><span class="annottext">[Address ShelleyAddr]
</span><a href="#local-6989586621680425491"><span class="hs-identifier hs-var">addresses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-215"></span><span>  </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
-&gt; QueryPoint
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (UTxO era)
-&gt; IO (UTxO era)
forall a.
LocalNodeConnectInfo
-&gt; QueryPoint
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; IO a
</span><a href="Hydra.Chain.CardanoClient.html#runQueryExpr"><span class="hs-identifier hs-var">runQueryExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425489"><span class="hs-identifier hs-var">connectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621680425490"><span class="hs-identifier hs-var">queryPoint</span></a></span><span> </span><span class="annot"><span class="annottext">(LocalStateQueryExpr
   BlockInMode ChainPoint QueryInMode () IO (UTxO era)
 -&gt; IO (UTxO era))
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (UTxO era)
-&gt; IO (UTxO era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; QueryUTxOFilter
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either UnsupportedNtcVersionError (Either EraMismatch (UTxO era)))
forall era block point r.
ShelleyBasedEra era
-&gt; QueryUTxOFilter
-&gt; LocalStateQueryExpr
     block
     point
     QueryInMode
     r
     IO
     (Either UnsupportedNtcVersionError (Either EraMismatch (UTxO era)))
</span><span class="hs-identifier hs-var">Query.queryUtxo</span></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
forall era. IsShelleyBasedEra era =&gt; ShelleyBasedEra era
</span><span class="hs-identifier hs-var">shelleyBasedEra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set AddressAny -&gt; QueryUTxOFilter
</span><span class="hs-identifier hs-var">QueryUTxOByAddress</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[AddressAny] -&gt; Set AddressAny
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([AddressAny] -&gt; Set AddressAny) -&gt; [AddressAny] -&gt; Set AddressAny
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Address ShelleyAddr -&gt; AddressAny)
-&gt; [Address ShelleyAddr] -&gt; [AddressAny]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Address ShelleyAddr -&gt; AddressAny
</span><span class="hs-identifier hs-var">AddressShelley</span></span><span> </span><span class="annot"><span class="annottext">[Address ShelleyAddr]
</span><a href="#local-6989586621680425491"><span class="hs-identifier hs-var">addresses</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>      </span><span class="annot"><span class="annottext">LocalStateQueryExpr
  BlockInMode
  ChainPoint
  QueryInMode
  ()
  IO
  (Either UnsupportedNtcVersionError (Either EraMismatch (UTxO era)))
-&gt; (Either
      UnsupportedNtcVersionError (Either EraMismatch (UTxO era))
    -&gt; LocalStateQueryExpr
         BlockInMode
         ChainPoint
         QueryInMode
         ()
         IO
         (Either EraMismatch (UTxO era)))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either EraMismatch (UTxO era))
forall a b.
LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; (a
    -&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b)
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either EraMismatch (UTxO era))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either EraMismatch (UTxO era))
forall a.
IO a
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span>
</span><span id="line-218"></span><span>      </span><span class="annot"><span class="annottext">(IO (Either EraMismatch (UTxO era))
 -&gt; LocalStateQueryExpr
      BlockInMode
      ChainPoint
      QueryInMode
      ()
      IO
      (Either EraMismatch (UTxO era)))
-&gt; (Either
      UnsupportedNtcVersionError (Either EraMismatch (UTxO era))
    -&gt; IO (Either EraMismatch (UTxO era)))
-&gt; Either
     UnsupportedNtcVersionError (Either EraMismatch (UTxO era))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either EraMismatch (UTxO era))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either UnsupportedNtcVersionError (Either EraMismatch (UTxO era))
-&gt; IO (Either EraMismatch (UTxO era))
forall (m :: * -&gt; *) a.
MonadThrow m =&gt;
Either UnsupportedNtcVersionError a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnUnsupportedNtcVersion"><span class="hs-identifier hs-var">throwOnUnsupportedNtcVersion</span></a></span><span>
</span><span id="line-219"></span><span>      </span><span class="annot"><span class="annottext">LocalStateQueryExpr
  BlockInMode
  ChainPoint
  QueryInMode
  ()
  IO
  (Either EraMismatch (UTxO era))
-&gt; (Either EraMismatch (UTxO era)
    -&gt; LocalStateQueryExpr
         BlockInMode ChainPoint QueryInMode () IO (UTxO era))
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (UTxO era)
forall a b.
LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; (a
    -&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b)
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO (UTxO era)
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (UTxO era)
forall a.
IO a
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span>
</span><span id="line-220"></span><span>      </span><span class="annot"><span class="annottext">(IO (UTxO era)
 -&gt; LocalStateQueryExpr
      BlockInMode ChainPoint QueryInMode () IO (UTxO era))
-&gt; (Either EraMismatch (UTxO era) -&gt; IO (UTxO era))
-&gt; Either EraMismatch (UTxO era)
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (UTxO era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either EraMismatch (UTxO era) -&gt; IO (UTxO era)
forall (m :: * -&gt; *) a. MonadThrow m =&gt; Either EraMismatch a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnEraMismatch"><span class="hs-identifier hs-var">throwOnEraMismatch</span></a></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="hs-comment">-- | Query UTxO for given tx inputs at given point.</span><span>
</span><span id="line-223"></span><span class="hs-comment">--</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- Throws at least 'QueryException' if query fails.</span><span>
</span><span id="line-225"></span><span id="local-6989586621680424909"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#queryUTxOByTxIn"><span class="hs-identifier hs-type">queryUTxOByTxIn</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-226"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">IsShelleyBasedEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680424909"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-227"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-228"></span><span>  </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-type">QueryPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TxIn</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="annot"><a href="#local-6989586621680424909"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-231"></span><span id="queryUTxOByTxIn"><span class="annot"><span class="annottext">queryUTxOByTxIn :: forall era.
IsShelleyBasedEra era =&gt;
LocalNodeConnectInfo -&gt; QueryPoint -&gt; [TxIn] -&gt; IO (UTxO era)
</span><a href="Hydra.Chain.CardanoClient.html#queryUTxOByTxIn"><span class="hs-identifier hs-var hs-var">queryUTxOByTxIn</span></a></span></span><span> </span><span id="local-6989586621680425505"><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425505"><span class="hs-identifier hs-var">connectInfo</span></a></span></span><span> </span><span id="local-6989586621680425506"><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621680425506"><span class="hs-identifier hs-var">queryPoint</span></a></span></span><span> </span><span id="local-6989586621680425507"><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621680425507"><span class="hs-identifier hs-var">inputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
-&gt; QueryPoint
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (UTxO era)
-&gt; IO (UTxO era)
forall a.
LocalNodeConnectInfo
-&gt; QueryPoint
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; IO a
</span><a href="Hydra.Chain.CardanoClient.html#runQueryExpr"><span class="hs-identifier hs-var">runQueryExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425505"><span class="hs-identifier hs-var">connectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621680425506"><span class="hs-identifier hs-var">queryPoint</span></a></span><span> </span><span class="annot"><span class="annottext">(LocalStateQueryExpr
   BlockInMode ChainPoint QueryInMode () IO (UTxO era)
 -&gt; IO (UTxO era))
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (UTxO era)
-&gt; IO (UTxO era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-233"></span><span>    </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; QueryUTxOFilter
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either UnsupportedNtcVersionError (Either EraMismatch (UTxO era)))
forall era block point r.
ShelleyBasedEra era
-&gt; QueryUTxOFilter
-&gt; LocalStateQueryExpr
     block
     point
     QueryInMode
     r
     IO
     (Either UnsupportedNtcVersionError (Either EraMismatch (UTxO era)))
</span><span class="hs-identifier hs-var">Query.queryUtxo</span></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
forall era. IsShelleyBasedEra era =&gt; ShelleyBasedEra era
</span><span class="hs-identifier hs-var">shelleyBasedEra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set TxIn -&gt; QueryUTxOFilter
</span><span class="hs-identifier hs-var">QueryUTxOByTxIn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxIn] -&gt; Set TxIn
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621680425507"><span class="hs-identifier hs-var">inputs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>      </span><span class="annot"><span class="annottext">LocalStateQueryExpr
  BlockInMode
  ChainPoint
  QueryInMode
  ()
  IO
  (Either UnsupportedNtcVersionError (Either EraMismatch (UTxO era)))
-&gt; (Either
      UnsupportedNtcVersionError (Either EraMismatch (UTxO era))
    -&gt; LocalStateQueryExpr
         BlockInMode
         ChainPoint
         QueryInMode
         ()
         IO
         (Either EraMismatch (UTxO era)))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either EraMismatch (UTxO era))
forall a b.
LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; (a
    -&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b)
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either EraMismatch (UTxO era))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either EraMismatch (UTxO era))
forall a.
IO a
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span>
</span><span id="line-235"></span><span>      </span><span class="annot"><span class="annottext">(IO (Either EraMismatch (UTxO era))
 -&gt; LocalStateQueryExpr
      BlockInMode
      ChainPoint
      QueryInMode
      ()
      IO
      (Either EraMismatch (UTxO era)))
-&gt; (Either
      UnsupportedNtcVersionError (Either EraMismatch (UTxO era))
    -&gt; IO (Either EraMismatch (UTxO era)))
-&gt; Either
     UnsupportedNtcVersionError (Either EraMismatch (UTxO era))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either EraMismatch (UTxO era))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either UnsupportedNtcVersionError (Either EraMismatch (UTxO era))
-&gt; IO (Either EraMismatch (UTxO era))
forall (m :: * -&gt; *) a.
MonadThrow m =&gt;
Either UnsupportedNtcVersionError a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnUnsupportedNtcVersion"><span class="hs-identifier hs-var">throwOnUnsupportedNtcVersion</span></a></span><span>
</span><span id="line-236"></span><span>      </span><span class="annot"><span class="annottext">LocalStateQueryExpr
  BlockInMode
  ChainPoint
  QueryInMode
  ()
  IO
  (Either EraMismatch (UTxO era))
-&gt; (Either EraMismatch (UTxO era)
    -&gt; LocalStateQueryExpr
         BlockInMode ChainPoint QueryInMode () IO (UTxO era))
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (UTxO era)
forall a b.
LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; (a
    -&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b)
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO (UTxO era)
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (UTxO era)
forall a.
IO a
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span>
</span><span id="line-237"></span><span>      </span><span class="annot"><span class="annottext">(IO (UTxO era)
 -&gt; LocalStateQueryExpr
      BlockInMode ChainPoint QueryInMode () IO (UTxO era))
-&gt; (Either EraMismatch (UTxO era) -&gt; IO (UTxO era))
-&gt; Either EraMismatch (UTxO era)
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (UTxO era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either EraMismatch (UTxO era) -&gt; IO (UTxO era)
forall (m :: * -&gt; *) a. MonadThrow m =&gt; Either EraMismatch a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnEraMismatch"><span class="hs-identifier hs-var">throwOnEraMismatch</span></a></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span id="local-6989586621680425020"><span id="local-6989586621680425022"><span id="local-6989586621680425024"><span id="local-6989586621680425025"><span id="local-6989586621680425026"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#queryForCurrentEraInEonExpr"><span class="hs-identifier hs-type">queryForCurrentEraInEonExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Eon</span></span><span> </span><span class="annot"><a href="#local-6989586621680425020"><span class="hs-identifier hs-type">eon</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AnyCardanoEra</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680425022"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680425023"><span class="annot"><a href="#local-6989586621680425023"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621680425020"><span class="hs-identifier hs-type">eon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680425023"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LocalStateQueryExpr</span></span><span> </span><span class="annot"><a href="#local-6989586621680425024"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680425025"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">QueryInMode</span></span><span> </span><span class="annot"><a href="#local-6989586621680425026"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680425022"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">LocalStateQueryExpr</span></span><span> </span><span class="annot"><a href="#local-6989586621680425024"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680425025"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">QueryInMode</span></span><span> </span><span class="annot"><a href="#local-6989586621680425026"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680425022"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span></span><span>
</span><span id="line-244"></span><span id="queryForCurrentEraInEonExpr"><span class="annot"><span class="annottext">queryForCurrentEraInEonExpr :: forall (eon :: * -&gt; *) a b p r.
Eon eon =&gt;
(AnyCardanoEra -&gt; IO a)
-&gt; (forall era.
    eon era -&gt; LocalStateQueryExpr b p QueryInMode r IO a)
-&gt; LocalStateQueryExpr b p QueryInMode r IO a
</span><a href="Hydra.Chain.CardanoClient.html#queryForCurrentEraInEonExpr"><span class="hs-identifier hs-var hs-var">queryForCurrentEraInEonExpr</span></a></span></span><span> </span><span id="local-6989586621680425512"><span class="annot"><span class="annottext">AnyCardanoEra -&gt; IO a
</span><a href="#local-6989586621680425512"><span class="hs-identifier hs-var">no</span></a></span></span><span> </span><span id="local-6989586621680425513"><span class="annot"><span class="annottext">forall era. eon era -&gt; LocalStateQueryExpr b p QueryInMode r IO a
</span><a href="#local-6989586621680425513"><span class="hs-identifier hs-var">yes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-245"></span><span>  </span><span id="local-6989586621680425514"><span class="annot"><span class="annottext">k :: AnyCardanoEra
</span><a href="#local-6989586621680425514"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AnyCardanoEra</span></span><span> </span><span id="local-6989586621680425519"><span class="annot"><span class="annottext">CardanoEra era
</span><a href="#local-6989586621680425519"><span class="hs-identifier hs-var">era</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LocalStateQueryExpr b p QueryInMode r IO AnyCardanoEra
forall b p r.
LocalStateQueryExpr b p QueryInMode r IO AnyCardanoEra
</span><a href="Hydra.Chain.CardanoClient.html#queryCurrentEraExpr"><span class="hs-identifier hs-var">queryCurrentEraExpr</span></a></span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><span class="annottext">LocalStateQueryExpr b p QueryInMode r IO a
-&gt; (eon era -&gt; LocalStateQueryExpr b p QueryInMode r IO a)
-&gt; CardanoEra era
-&gt; LocalStateQueryExpr b p QueryInMode r IO a
forall a era. a -&gt; (eon era -&gt; a) -&gt; CardanoEra era -&gt; a
forall (eon :: * -&gt; *) a era.
Eon eon =&gt;
a -&gt; (eon era -&gt; a) -&gt; CardanoEra era -&gt; a
</span><span class="hs-identifier hs-var">inEonForEra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO a -&gt; LocalStateQueryExpr b p QueryInMode r IO a
forall a. IO a -&gt; LocalStateQueryExpr b p QueryInMode r IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; LocalStateQueryExpr b p QueryInMode r IO a)
-&gt; IO a -&gt; LocalStateQueryExpr b p QueryInMode r IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AnyCardanoEra -&gt; IO a
</span><a href="#local-6989586621680425512"><span class="hs-identifier hs-var">no</span></a></span><span> </span><span class="annot"><span class="annottext">AnyCardanoEra
</span><a href="#local-6989586621680425514"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">eon era -&gt; LocalStateQueryExpr b p QueryInMode r IO a
forall era. eon era -&gt; LocalStateQueryExpr b p QueryInMode r IO a
</span><a href="#local-6989586621680425513"><span class="hs-identifier hs-var">yes</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoEra era
</span><a href="#local-6989586621680425519"><span class="hs-identifier hs-var">era</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span id="local-6989586621680424937"><span id="local-6989586621680424938"><span id="local-6989586621680424939"><span id="local-6989586621680424940"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#queryForCurrentEraInShelleyBasedEraExpr"><span class="hs-identifier hs-type">queryForCurrentEraInShelleyBasedEraExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680424936"><span class="annot"><a href="#local-6989586621680424936"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ShelleyBasedEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680424936"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LocalStateQueryExpr</span></span><span> </span><span class="annot"><a href="#local-6989586621680424937"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680424938"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">QueryInMode</span></span><span> </span><span class="annot"><a href="#local-6989586621680424939"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680424940"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-250"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">LocalStateQueryExpr</span></span><span> </span><span class="annot"><a href="#local-6989586621680424937"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680424938"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">QueryInMode</span></span><span> </span><span class="annot"><a href="#local-6989586621680424939"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680424940"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span><span>
</span><span id="line-251"></span><span id="queryForCurrentEraInShelleyBasedEraExpr"><span class="annot"><span class="annottext">queryForCurrentEraInShelleyBasedEraExpr :: forall b p r a.
(forall era.
 ShelleyBasedEra era -&gt; LocalStateQueryExpr b p QueryInMode r IO a)
-&gt; LocalStateQueryExpr b p QueryInMode r IO a
</span><a href="Hydra.Chain.CardanoClient.html#queryForCurrentEraInShelleyBasedEraExpr"><span class="hs-identifier hs-var hs-var">queryForCurrentEraInShelleyBasedEraExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(AnyCardanoEra -&gt; IO a)
-&gt; (forall {era}.
    ShelleyBasedEra era -&gt; LocalStateQueryExpr b p QueryInMode r IO a)
-&gt; LocalStateQueryExpr b p QueryInMode r IO a
forall (eon :: * -&gt; *) a b p r.
Eon eon =&gt;
(AnyCardanoEra -&gt; IO a)
-&gt; (forall era.
    eon era -&gt; LocalStateQueryExpr b p QueryInMode r IO a)
-&gt; LocalStateQueryExpr b p QueryInMode r IO a
</span><a href="Hydra.Chain.CardanoClient.html#queryForCurrentEraInEonExpr"><span class="hs-identifier hs-var">queryForCurrentEraInEonExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QueryException -&gt; IO a
forall e a. Exception e =&gt; e -&gt; IO a
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">(QueryException -&gt; IO a)
-&gt; (AnyCardanoEra -&gt; QueryException) -&gt; AnyCardanoEra -&gt; IO a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">AnyCardanoEra -&gt; QueryException
</span><a href="Hydra.Chain.CardanoClient.html#QueryNotShelleyBasedEraException"><span class="hs-identifier hs-var">QueryNotShelleyBasedEraException</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-comment">-- | Query the whole UTxO from node at given point. Useful for debugging, but</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- should obviously not be used in production code.</span><span>
</span><span id="line-255"></span><span class="hs-comment">--</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- Throws at least 'QueryException' if query fails.</span><span>
</span><span id="line-257"></span><span id="local-6989586621680425044"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#queryUTxOWhole"><span class="hs-identifier hs-type">queryUTxOWhole</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">IsShelleyBasedEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680425044"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-259"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-260"></span><span>  </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-type">QueryPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-261"></span><span>  </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="annot"><a href="#local-6989586621680425044"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-262"></span><span id="queryUTxOWhole"><span class="annot"><span class="annottext">queryUTxOWhole :: forall era.
IsShelleyBasedEra era =&gt;
LocalNodeConnectInfo -&gt; QueryPoint -&gt; IO (UTxO era)
</span><a href="Hydra.Chain.CardanoClient.html#queryUTxOWhole"><span class="hs-identifier hs-var hs-var">queryUTxOWhole</span></a></span></span><span> </span><span id="local-6989586621680425535"><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425535"><span class="hs-identifier hs-var">connectInfo</span></a></span></span><span> </span><span id="local-6989586621680425536"><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621680425536"><span class="hs-identifier hs-var">queryPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-263"></span><span>  </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
-&gt; QueryPoint
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (UTxO era)
-&gt; IO (UTxO era)
forall a.
LocalNodeConnectInfo
-&gt; QueryPoint
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; IO a
</span><a href="Hydra.Chain.CardanoClient.html#runQueryExpr"><span class="hs-identifier hs-var">runQueryExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425535"><span class="hs-identifier hs-var">connectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621680425536"><span class="hs-identifier hs-var">queryPoint</span></a></span><span> </span><span class="annot"><span class="annottext">(LocalStateQueryExpr
   BlockInMode ChainPoint QueryInMode () IO (UTxO era)
 -&gt; IO (UTxO era))
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (UTxO era)
-&gt; IO (UTxO era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; QueryUTxOFilter
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either UnsupportedNtcVersionError (Either EraMismatch (UTxO era)))
forall era block point r.
ShelleyBasedEra era
-&gt; QueryUTxOFilter
-&gt; LocalStateQueryExpr
     block
     point
     QueryInMode
     r
     IO
     (Either UnsupportedNtcVersionError (Either EraMismatch (UTxO era)))
</span><span class="hs-identifier hs-var">Query.queryUtxo</span></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
forall era. IsShelleyBasedEra era =&gt; ShelleyBasedEra era
</span><span class="hs-identifier hs-var">shelleyBasedEra</span></span><span> </span><span class="annot"><span class="annottext">QueryUTxOFilter
</span><span class="hs-identifier hs-var">QueryUTxOWhole</span></span><span>
</span><span id="line-265"></span><span>      </span><span class="annot"><span class="annottext">LocalStateQueryExpr
  BlockInMode
  ChainPoint
  QueryInMode
  ()
  IO
  (Either UnsupportedNtcVersionError (Either EraMismatch (UTxO era)))
-&gt; (Either
      UnsupportedNtcVersionError (Either EraMismatch (UTxO era))
    -&gt; LocalStateQueryExpr
         BlockInMode
         ChainPoint
         QueryInMode
         ()
         IO
         (Either EraMismatch (UTxO era)))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either EraMismatch (UTxO era))
forall a b.
LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; (a
    -&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b)
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either EraMismatch (UTxO era))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either EraMismatch (UTxO era))
forall a.
IO a
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span>
</span><span id="line-266"></span><span>      </span><span class="annot"><span class="annottext">(IO (Either EraMismatch (UTxO era))
 -&gt; LocalStateQueryExpr
      BlockInMode
      ChainPoint
      QueryInMode
      ()
      IO
      (Either EraMismatch (UTxO era)))
-&gt; (Either
      UnsupportedNtcVersionError (Either EraMismatch (UTxO era))
    -&gt; IO (Either EraMismatch (UTxO era)))
-&gt; Either
     UnsupportedNtcVersionError (Either EraMismatch (UTxO era))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either EraMismatch (UTxO era))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either UnsupportedNtcVersionError (Either EraMismatch (UTxO era))
-&gt; IO (Either EraMismatch (UTxO era))
forall (m :: * -&gt; *) a.
MonadThrow m =&gt;
Either UnsupportedNtcVersionError a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnUnsupportedNtcVersion"><span class="hs-identifier hs-var">throwOnUnsupportedNtcVersion</span></a></span><span>
</span><span id="line-267"></span><span>      </span><span class="annot"><span class="annottext">LocalStateQueryExpr
  BlockInMode
  ChainPoint
  QueryInMode
  ()
  IO
  (Either EraMismatch (UTxO era))
-&gt; (Either EraMismatch (UTxO era)
    -&gt; LocalStateQueryExpr
         BlockInMode ChainPoint QueryInMode () IO (UTxO era))
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (UTxO era)
forall a b.
LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; (a
    -&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b)
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO (UTxO era)
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (UTxO era)
forall a.
IO a
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span>
</span><span id="line-268"></span><span>      </span><span class="annot"><span class="annottext">(IO (UTxO era)
 -&gt; LocalStateQueryExpr
      BlockInMode ChainPoint QueryInMode () IO (UTxO era))
-&gt; (Either EraMismatch (UTxO era) -&gt; IO (UTxO era))
-&gt; Either EraMismatch (UTxO era)
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (UTxO era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either EraMismatch (UTxO era) -&gt; IO (UTxO era)
forall (m :: * -&gt; *) a. MonadThrow m =&gt; Either EraMismatch a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnEraMismatch"><span class="hs-identifier hs-var">throwOnEraMismatch</span></a></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="hs-comment">-- | Query UTxO for the address of given verification key at point.</span><span>
</span><span id="line-271"></span><span class="hs-comment">--</span><span>
</span><span id="line-272"></span><span class="hs-comment">-- Throws at least 'QueryException' if query fails.</span><span>
</span><span id="line-273"></span><span id="local-6989586621680425046"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#queryUTxOFor"><span class="hs-identifier hs-type">queryUTxOFor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsShelleyBasedEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680425046"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-type">QueryPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VerificationKey</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="annot"><a href="#local-6989586621680425046"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-274"></span><span id="queryUTxOFor"><span class="annot"><span class="annottext">queryUTxOFor :: forall era.
IsShelleyBasedEra era =&gt;
LocalNodeConnectInfo
-&gt; QueryPoint -&gt; VerificationKey PaymentKey -&gt; IO (UTxO era)
</span><a href="Hydra.Chain.CardanoClient.html#queryUTxOFor"><span class="hs-identifier hs-var hs-var">queryUTxOFor</span></a></span></span><span> </span><span id="local-6989586621680425544"><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425544"><span class="hs-identifier hs-var">connectInfo</span></a></span></span><span> </span><span id="local-6989586621680425545"><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621680425545"><span class="hs-identifier hs-var">queryPoint</span></a></span></span><span> </span><span id="local-6989586621680425546"><span class="annot"><span class="annottext">VerificationKey PaymentKey
</span><a href="#local-6989586621680425546"><span class="hs-identifier hs-var">vk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NetworkId -&gt; VerificationKey PaymentKey -&gt; AddressInEra Era
forall era.
IsShelleyBasedEra era =&gt;
NetworkId -&gt; VerificationKey PaymentKey -&gt; AddressInEra era
</span><span class="hs-identifier hs-var">mkVkAddress</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalNodeConnectInfo -&gt; NetworkId
</span><span class="hs-identifier hs-var">localNodeNetworkId</span></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425544"><span class="hs-identifier hs-var">connectInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VerificationKey PaymentKey
</span><a href="#local-6989586621680425546"><span class="hs-identifier hs-var">vk</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">ShelleyAddressInEra</span></span><span> </span><span id="local-6989586621680425550"><span class="annot"><span class="annottext">Address ShelleyAddr
</span><a href="#local-6989586621680425550"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-277"></span><span>      </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
-&gt; QueryPoint -&gt; [Address ShelleyAddr] -&gt; IO (UTxO era)
forall era.
IsShelleyBasedEra era =&gt;
LocalNodeConnectInfo
-&gt; QueryPoint -&gt; [Address ShelleyAddr] -&gt; IO (UTxO era)
</span><a href="Hydra.Chain.CardanoClient.html#queryUTxO"><span class="hs-identifier hs-var">queryUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425544"><span class="hs-identifier hs-var">connectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621680425545"><span class="hs-identifier hs-var">queryPoint</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Address ShelleyAddr
</span><a href="#local-6989586621680425550"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-278"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">ByronAddressInEra</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-279"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; IO (UTxO era)
forall a. String -&gt; IO a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.Fail.html#fail"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossible: mkVkAddress returned Byron address.&quot;</span></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-comment">-- | Query the current set of registered stake pools.</span><span>
</span><span id="line-282"></span><span class="hs-comment">--</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- Throws at least 'QueryException' if query fails.</span><span>
</span><span id="line-284"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#queryStakePools"><span class="hs-identifier hs-type">queryStakePools</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-285"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-286"></span><span>  </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-type">QueryPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-287"></span><span>  </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PoolId</span></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span id="queryStakePools"><span class="annot"><span class="annottext">queryStakePools :: LocalNodeConnectInfo -&gt; QueryPoint -&gt; IO (Set PoolId)
</span><a href="Hydra.Chain.CardanoClient.html#queryStakePools"><span class="hs-identifier hs-var hs-var">queryStakePools</span></a></span></span><span> </span><span id="local-6989586621680425553"><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425553"><span class="hs-identifier hs-var">connectInfo</span></a></span></span><span> </span><span id="local-6989586621680425554"><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621680425554"><span class="hs-identifier hs-var">queryPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-289"></span><span>  </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
-&gt; QueryPoint
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (Set PoolId)
-&gt; IO (Set PoolId)
forall a.
LocalNodeConnectInfo
-&gt; QueryPoint
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; IO a
</span><a href="Hydra.Chain.CardanoClient.html#runQueryExpr"><span class="hs-identifier hs-var">runQueryExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425553"><span class="hs-identifier hs-var">connectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621680425554"><span class="hs-identifier hs-var">queryPoint</span></a></span><span> </span><span class="annot"><span class="annottext">(LocalStateQueryExpr
   BlockInMode ChainPoint QueryInMode () IO (Set PoolId)
 -&gt; IO (Set PoolId))
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (Set PoolId)
-&gt; IO (Set PoolId)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-290"></span><span>    </span><span class="annot"><span class="annottext">(forall era.
 ShelleyBasedEra era
 -&gt; LocalStateQueryExpr
      BlockInMode ChainPoint QueryInMode () IO (Set PoolId))
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (Set PoolId)
forall b p r a.
(forall era.
 ShelleyBasedEra era -&gt; LocalStateQueryExpr b p QueryInMode r IO a)
-&gt; LocalStateQueryExpr b p QueryInMode r IO a
</span><a href="Hydra.Chain.CardanoClient.html#queryForCurrentEraInShelleyBasedEraExpr"><span class="hs-identifier hs-var">queryForCurrentEraInShelleyBasedEraExpr</span></a></span><span> </span><span class="annot"><span class="annottext">((forall era.
  ShelleyBasedEra era
  -&gt; LocalStateQueryExpr
       BlockInMode ChainPoint QueryInMode () IO (Set PoolId))
 -&gt; LocalStateQueryExpr
      BlockInMode ChainPoint QueryInMode () IO (Set PoolId))
-&gt; (forall era.
    ShelleyBasedEra era
    -&gt; LocalStateQueryExpr
         BlockInMode ChainPoint QueryInMode () IO (Set PoolId))
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (Set PoolId)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680425561"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621680425561"><span class="hs-identifier hs-var">sbe</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-291"></span><span>      </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either
        UnsupportedNtcVersionError (Either EraMismatch (Set PoolId)))
forall era block point r.
ShelleyBasedEra era
-&gt; LocalStateQueryExpr
     block
     point
     QueryInMode
     r
     IO
     (Either
        UnsupportedNtcVersionError (Either EraMismatch (Set PoolId)))
</span><span class="hs-identifier hs-var">Query.queryStakePools</span></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621680425561"><span class="hs-identifier hs-var">sbe</span></a></span><span>
</span><span id="line-292"></span><span>        </span><span class="annot"><span class="annottext">LocalStateQueryExpr
  BlockInMode
  ChainPoint
  QueryInMode
  ()
  IO
  (Either
     UnsupportedNtcVersionError (Either EraMismatch (Set PoolId)))
-&gt; (Either
      UnsupportedNtcVersionError (Either EraMismatch (Set PoolId))
    -&gt; LocalStateQueryExpr
         BlockInMode
         ChainPoint
         QueryInMode
         ()
         IO
         (Either EraMismatch (Set PoolId)))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either EraMismatch (Set PoolId))
forall a b.
LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; (a
    -&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b)
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either EraMismatch (Set PoolId))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either EraMismatch (Set PoolId))
forall a.
IO a
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span>
</span><span id="line-293"></span><span>        </span><span class="annot"><span class="annottext">(IO (Either EraMismatch (Set PoolId))
 -&gt; LocalStateQueryExpr
      BlockInMode
      ChainPoint
      QueryInMode
      ()
      IO
      (Either EraMismatch (Set PoolId)))
-&gt; (Either
      UnsupportedNtcVersionError (Either EraMismatch (Set PoolId))
    -&gt; IO (Either EraMismatch (Set PoolId)))
-&gt; Either
     UnsupportedNtcVersionError (Either EraMismatch (Set PoolId))
-&gt; LocalStateQueryExpr
     BlockInMode
     ChainPoint
     QueryInMode
     ()
     IO
     (Either EraMismatch (Set PoolId))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either UnsupportedNtcVersionError (Either EraMismatch (Set PoolId))
-&gt; IO (Either EraMismatch (Set PoolId))
forall (m :: * -&gt; *) a.
MonadThrow m =&gt;
Either UnsupportedNtcVersionError a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnUnsupportedNtcVersion"><span class="hs-identifier hs-var">throwOnUnsupportedNtcVersion</span></a></span><span>
</span><span id="line-294"></span><span>        </span><span class="annot"><span class="annottext">LocalStateQueryExpr
  BlockInMode
  ChainPoint
  QueryInMode
  ()
  IO
  (Either EraMismatch (Set PoolId))
-&gt; (Either EraMismatch (Set PoolId)
    -&gt; LocalStateQueryExpr
         BlockInMode ChainPoint QueryInMode () IO (Set PoolId))
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (Set PoolId)
forall a b.
LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; (a
    -&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b)
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Set PoolId)
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (Set PoolId)
forall a.
IO a
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span>
</span><span id="line-295"></span><span>        </span><span class="annot"><span class="annottext">(IO (Set PoolId)
 -&gt; LocalStateQueryExpr
      BlockInMode ChainPoint QueryInMode () IO (Set PoolId))
-&gt; (Either EraMismatch (Set PoolId) -&gt; IO (Set PoolId))
-&gt; Either EraMismatch (Set PoolId)
-&gt; LocalStateQueryExpr
     BlockInMode ChainPoint QueryInMode () IO (Set PoolId)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either EraMismatch (Set PoolId) -&gt; IO (Set PoolId)
forall (m :: * -&gt; *) a. MonadThrow m =&gt; Either EraMismatch a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnEraMismatch"><span class="hs-identifier hs-var">throwOnEraMismatch</span></a></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="annot"><span class="hs-comment">-- * Helpers</span></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="annot"><span class="hs-comment">-- | Monadic query expression to get current era.</span></span><span>
</span><span id="line-300"></span><span id="local-6989586621680425033"><span id="local-6989586621680425034"><span id="local-6989586621680425035"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#queryCurrentEraExpr"><span class="hs-identifier hs-type">queryCurrentEraExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LocalStateQueryExpr</span></span><span> </span><span class="annot"><a href="#local-6989586621680425033"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680425034"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">QueryInMode</span></span><span> </span><span class="annot"><a href="#local-6989586621680425035"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AnyCardanoEra</span></span></span></span></span><span>
</span><span id="line-301"></span><span id="queryCurrentEraExpr"><span class="annot"><span class="annottext">queryCurrentEraExpr :: forall b p r.
LocalStateQueryExpr b p QueryInMode r IO AnyCardanoEra
</span><a href="Hydra.Chain.CardanoClient.html#queryCurrentEraExpr"><span class="hs-identifier hs-var hs-var">queryCurrentEraExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><span class="annottext">LocalStateQueryExpr
  b
  p
  QueryInMode
  r
  IO
  (Either UnsupportedNtcVersionError AnyCardanoEra)
forall block point r.
LocalStateQueryExpr
  block
  point
  QueryInMode
  r
  IO
  (Either UnsupportedNtcVersionError AnyCardanoEra)
</span><span class="hs-identifier hs-var">Query.queryCurrentEra</span></span><span> </span><span class="annot"><span class="annottext">LocalStateQueryExpr
  b
  p
  QueryInMode
  r
  IO
  (Either UnsupportedNtcVersionError AnyCardanoEra)
-&gt; (Either UnsupportedNtcVersionError AnyCardanoEra
    -&gt; LocalStateQueryExpr b p QueryInMode r IO AnyCardanoEra)
-&gt; LocalStateQueryExpr b p QueryInMode r IO AnyCardanoEra
forall a b.
LocalStateQueryExpr b p QueryInMode r IO a
-&gt; (a -&gt; LocalStateQueryExpr b p QueryInMode r IO b)
-&gt; LocalStateQueryExpr b p QueryInMode r IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO AnyCardanoEra
-&gt; LocalStateQueryExpr b p QueryInMode r IO AnyCardanoEra
forall a. IO a -&gt; LocalStateQueryExpr b p QueryInMode r IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO AnyCardanoEra
 -&gt; LocalStateQueryExpr b p QueryInMode r IO AnyCardanoEra)
-&gt; (Either UnsupportedNtcVersionError AnyCardanoEra
    -&gt; IO AnyCardanoEra)
-&gt; Either UnsupportedNtcVersionError AnyCardanoEra
-&gt; LocalStateQueryExpr b p QueryInMode r IO AnyCardanoEra
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either UnsupportedNtcVersionError AnyCardanoEra -&gt; IO AnyCardanoEra
forall (m :: * -&gt; *) a.
MonadThrow m =&gt;
Either UnsupportedNtcVersionError a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnUnsupportedNtcVersion"><span class="hs-identifier hs-var">throwOnUnsupportedNtcVersion</span></a></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="annot"><span class="hs-comment">-- | Throws at least 'QueryException' if query fails.</span></span><span>
</span><span id="line-305"></span><span id="local-6989586621680424920"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#runQueryExpr"><span class="hs-identifier hs-type">runQueryExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-306"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-307"></span><span>  </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-type">QueryPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-308"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">LocalStateQueryExpr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BlockInMode</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainPoint</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">QueryInMode</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680424920"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-309"></span><span>  </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680424920"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-310"></span><span id="runQueryExpr"><span class="annot"><span class="annottext">runQueryExpr :: forall a.
LocalNodeConnectInfo
-&gt; QueryPoint
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; IO a
</span><a href="Hydra.Chain.CardanoClient.html#runQueryExpr"><span class="hs-identifier hs-var hs-var">runQueryExpr</span></a></span></span><span> </span><span id="local-6989586621680425570"><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425570"><span class="hs-identifier hs-var">connectInfo</span></a></span></span><span> </span><span id="local-6989586621680425571"><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621680425571"><span class="hs-identifier hs-var">point</span></a></span></span><span> </span><span id="local-6989586621680425572"><span class="annot"><span class="annottext">LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
</span><a href="#local-6989586621680425572"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-311"></span><span>  </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
-&gt; Target ChainPoint
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; IO (Either AcquiringFailure a)
forall a.
LocalNodeConnectInfo
-&gt; Target ChainPoint
-&gt; LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
-&gt; IO (Either AcquiringFailure a)
</span><span class="hs-identifier hs-var">executeLocalStateQueryExpr</span></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo
</span><a href="#local-6989586621680425570"><span class="hs-identifier hs-var">connectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Target ChainPoint
</span><a href="#local-6989586621680425574"><span class="hs-identifier hs-var">queryTarget</span></a></span><span> </span><span class="annot"><span class="annottext">LocalStateQueryExpr BlockInMode ChainPoint QueryInMode () IO a
</span><a href="#local-6989586621680425572"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either AcquiringFailure a)
-&gt; (Either AcquiringFailure a -&gt; IO a) -&gt; IO a
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-312"></span><span>    </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621680425575"><span class="annot"><span class="annottext">AcquiringFailure
</span><a href="#local-6989586621680425575"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QueryException -&gt; IO a
forall e a. Exception e =&gt; e -&gt; IO a
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">(QueryException -&gt; IO a) -&gt; QueryException -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AcquiringFailure -&gt; QueryException
</span><a href="Hydra.Chain.CardanoClient.html#QueryAcquireException"><span class="hs-identifier hs-var">QueryAcquireException</span></a></span><span> </span><span class="annot"><span class="annottext">AcquiringFailure
</span><a href="#local-6989586621680425575"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-313"></span><span>    </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621680425576"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680425576"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; IO a
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680425576"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-314"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-315"></span><span>  </span><span id="local-6989586621680425574"><span class="annot"><span class="annottext">queryTarget :: Target ChainPoint
</span><a href="#local-6989586621680425574"><span class="hs-identifier hs-var hs-var">queryTarget</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-316"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621680425571"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-317"></span><span>      </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="Hydra.Chain.CardanoClient.html#QueryTip"><span class="hs-identifier hs-var">QueryTip</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Target ChainPoint
forall point. Target point
</span><span class="hs-identifier hs-var">VolatileTip</span></span><span>
</span><span id="line-318"></span><span>      </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryAt"><span class="hs-identifier hs-type">QueryAt</span></a></span><span> </span><span id="local-6989586621680425578"><span class="annot"><span class="annottext">ChainPoint
</span><a href="#local-6989586621680425578"><span class="hs-identifier hs-var">cp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ChainPoint -&gt; Target ChainPoint
forall point. point -&gt; Target point
</span><span class="hs-identifier hs-var">SpecificPoint</span></span><span> </span><span class="annot"><span class="annottext">ChainPoint
</span><a href="#local-6989586621680425578"><span class="hs-identifier hs-var">cp</span></a></span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span id="local-6989586621680424946"><span id="local-6989586621680424947"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#throwOnEraMismatch"><span class="hs-identifier hs-type">throwOnEraMismatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621680424946"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraMismatch</span></span><span> </span><span class="annot"><a href="#local-6989586621680424947"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680424946"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680424947"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-321"></span><span id="throwOnEraMismatch"><span class="annot"><span class="annottext">throwOnEraMismatch :: forall (m :: * -&gt; *) a. MonadThrow m =&gt; Either EraMismatch a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnEraMismatch"><span class="hs-identifier hs-var hs-var">throwOnEraMismatch</span></a></span></span><span> </span><span id="local-6989586621680425588"><span class="annot"><span class="annottext">Either EraMismatch a
</span><a href="#local-6989586621680425588"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-322"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either EraMismatch a
</span><a href="#local-6989586621680425588"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-323"></span><span>    </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621680425589"><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621680425589"><span class="hs-identifier hs-var">eraMismatch</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QueryException -&gt; m a
forall e a. Exception e =&gt; e -&gt; m a
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">(QueryException -&gt; m a) -&gt; QueryException -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">EraMismatch -&gt; QueryException
</span><a href="Hydra.Chain.CardanoClient.html#QueryEraMismatchException"><span class="hs-identifier hs-var">QueryEraMismatchException</span></a></span><span> </span><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621680425589"><span class="hs-identifier hs-var">eraMismatch</span></a></span><span>
</span><span id="line-324"></span><span>    </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621680425590"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680425590"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680425590"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span id="local-6989586621680424929"><span id="local-6989586621680424930"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#throwOnUnsupportedNtcVersion"><span class="hs-identifier hs-type">throwOnUnsupportedNtcVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621680424929"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UnsupportedNtcVersionError</span></span><span> </span><span class="annot"><a href="#local-6989586621680424930"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680424929"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680424930"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-327"></span><span id="throwOnUnsupportedNtcVersion"><span class="annot"><span class="annottext">throwOnUnsupportedNtcVersion :: forall (m :: * -&gt; *) a.
MonadThrow m =&gt;
Either UnsupportedNtcVersionError a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnUnsupportedNtcVersion"><span class="hs-identifier hs-var hs-var">throwOnUnsupportedNtcVersion</span></a></span></span><span> </span><span id="local-6989586621680425597"><span class="annot"><span class="annottext">Either UnsupportedNtcVersionError a
</span><a href="#local-6989586621680425597"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either UnsupportedNtcVersionError a
</span><a href="#local-6989586621680425597"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-329"></span><span>    </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621680425598"><span class="annot"><span class="annottext">UnsupportedNtcVersionError
</span><a href="#local-6989586621680425598"><span class="hs-identifier hs-var">unsupportedNtcVersion</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QueryException -&gt; m a
forall e a. Exception e =&gt; e -&gt; m a
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">(QueryException -&gt; m a) -&gt; QueryException -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UnsupportedNtcVersionError -&gt; QueryException
</span><a href="Hydra.Chain.CardanoClient.html#QueryUnsupportedNtcVersionException"><span class="hs-identifier hs-var">QueryUnsupportedNtcVersionException</span></a></span><span> </span><span class="annot"><span class="annottext">UnsupportedNtcVersionError
</span><a href="#local-6989586621680425598"><span class="hs-identifier hs-var">unsupportedNtcVersion</span></a></span><span>
</span><span id="line-330"></span><span>    </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621680425599"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680425599"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680425599"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#localNodeConnectInfo"><span class="hs-identifier hs-type">localNodeConnectInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SocketPath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></span><span>
</span><span id="line-333"></span><span id="localNodeConnectInfo"><span class="annot"><span class="annottext">localNodeConnectInfo :: NetworkId -&gt; SocketPath -&gt; LocalNodeConnectInfo
</span><a href="Hydra.Chain.CardanoClient.html#localNodeConnectInfo"><span class="hs-identifier hs-var hs-var">localNodeConnectInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConsensusModeParams
-&gt; NetworkId -&gt; SocketPath -&gt; LocalNodeConnectInfo
</span><span class="hs-identifier hs-var">LocalNodeConnectInfo</span></span><span> </span><span class="annot"><span class="annottext">ConsensusModeParams
</span><a href="Hydra.Chain.CardanoClient.html#cardanoModeParams"><span class="hs-identifier hs-var">cardanoModeParams</span></a></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#cardanoModeParams"><span class="hs-identifier hs-type">cardanoModeParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConsensusModeParams</span></span><span>
</span><span id="line-336"></span><span id="cardanoModeParams"><span class="annot"><span class="annottext">cardanoModeParams :: ConsensusModeParams
</span><a href="Hydra.Chain.CardanoClient.html#cardanoModeParams"><span class="hs-identifier hs-var hs-var">cardanoModeParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EpochSlots -&gt; ConsensusModeParams
</span><span class="hs-identifier hs-var">CardanoModeParams</span></span><span> </span><span class="annot"><span class="annottext">(EpochSlots -&gt; ConsensusModeParams)
-&gt; EpochSlots -&gt; ConsensusModeParams
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; EpochSlots
</span><span class="hs-identifier hs-var">EpochSlots</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680425605"><span class="hs-identifier hs-var">defaultByronEpochSlots</span></a></span><span>
</span><span id="line-337"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-comment">-- NOTE(AB): extracted from Parsers in cardano-cli, this is needed to run in 'cardanoMode' which</span><span>
</span><span id="line-339"></span><span>  </span><span class="hs-comment">-- is the default for cardano-cli</span><span>
</span><span id="line-340"></span><span>  </span><span id="local-6989586621680425605"><span class="annot"><span class="annottext">defaultByronEpochSlots :: Word64
</span><a href="#local-6989586621680425605"><span class="hs-identifier hs-var hs-var">defaultByronEpochSlots</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">21600</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/pdlvkcn31k7dw3q5bcndp7f9d2z5l0h3-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-341"></span></pre></body></html>