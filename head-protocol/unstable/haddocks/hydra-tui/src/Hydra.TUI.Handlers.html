<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DuplicateRecordFields #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-unused-local-binds #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-unused-matches #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hydra.TUI.Handlers</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Ord.html#Down"><span class="hs-identifier">Down</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Brick</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Brick.Forms</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Form</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">formState</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">editField</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">editShowableFieldWithValidate</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">handleFormEvent</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">newForm</span></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api.UTxO</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UTxO</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.OldList.html#nub"><span class="hs-identifier">nub</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.OldList.html#%5C%5C"><span class="hs-operator">(\\)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/containers-0.6.7/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/text-2.0.2/src/Data.Text.html"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Graphics.Vty</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-17"></span><span>  </span><span class="annot"><span class="hs-identifier">Event</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">EvKey</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>  </span><span class="annot"><span class="hs-identifier">Key</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><span class="hs-identifier">Modifier</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MCtrl</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Graphics.Vty</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Vty</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.API.ClientInput</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ClientInput</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.API.ServerOutput</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NetworkInfo</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TimedServerOutput</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.API.ServerOutput</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">API</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Cardano.Api</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Active</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Cardano.Api.Prelude</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Chain</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PostTxError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">InternalWalletError</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">NotEnoughFuel</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">reason</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Chain.CardanoClient</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CardanoClient</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Chain.Direct.State</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hydra.Client.html"><span class="hs-identifier">Hydra.Client</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#AllPossibleAPIMessages"><span class="hs-identifier">AllPossibleAPIMessages</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.Client.html#Client"><span class="hs-identifier">Client</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.Client.html#HydraEvent"><span class="hs-identifier">HydraEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Ledger.Cardano</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mkSimpleTx</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Network</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Host</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">readHost</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Node.Environment</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Environment</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hydra.TUI.Forms.html"><span class="hs-identifier">Hydra.TUI.Forms</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hydra.TUI.Logging.Handlers.html"><span class="hs-identifier">Hydra.TUI.Logging.Handlers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.TUI.Logging.Handlers.html#info"><span class="hs-identifier">info</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.TUI.Logging.Handlers.html#report"><span class="hs-identifier">report</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.TUI.Logging.Handlers.html#warn"><span class="hs-identifier">warn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hydra.TUI.Logging.Types.html"><span class="hs-identifier">Hydra.TUI.Logging.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.TUI.Logging.Types.html#LogMessage"><span class="hs-identifier">LogMessage</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.TUI.Logging.Types.html#LogState"><span class="hs-identifier">LogState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.TUI.Logging.Types.html#LogVerbosity"><span class="hs-identifier">LogVerbosity</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.TUI.Logging.Types.html#Severity"><span class="hs-identifier">Severity</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.TUI.Logging.Types.html#logMessagesL"><span class="hs-identifier">logMessagesL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.TUI.Logging.Types.html#logVerbosityL"><span class="hs-identifier">logVerbosityL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html"><span class="hs-identifier">Hydra.TUI.Model</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hydra.TUI.Style.html"><span class="hs-identifier">Hydra.TUI.Style</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.TUI.Style.html#own"><span class="hs-identifier">own</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Tx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IsTx</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Party</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Snapshot</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">balance</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Lens.Micro.Mtl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">use</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(%=)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.=)</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleEvent"><span class="hs-identifier hs-type">handleEvent</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">CardanoClient</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Client"><span class="hs-identifier hs-type">Client</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">BrickEvent</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#HydraEvent"><span class="hs-identifier hs-type">HydraEvent</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#RootState"><span class="hs-identifier hs-type">RootState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span id="handleEvent"><span class="annot"><span class="annottext">handleEvent :: CardanoClient
-&gt; Client Tx IO
-&gt; BrickEvent Name (HydraEvent Tx)
-&gt; EventM Name RootState ()
</span><a href="Hydra.TUI.Handlers.html#handleEvent"><span class="hs-identifier hs-var hs-var">handleEvent</span></a></span></span><span> </span><span id="local-6989586621679451190"><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679451190"><span class="hs-identifier hs-var">cardanoClient</span></a></span></span><span> </span><span id="local-6989586621679451191"><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451191"><span class="hs-identifier hs-var">client</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">AppEvent</span></span><span> </span><span id="local-6989586621679451193"><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="#local-6989586621679451193"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><span class="annottext">HydraEvent Tx -&gt; EventM Name RootState ()
</span><a href="Hydra.TUI.Handlers.html#handleTick"><span class="hs-identifier hs-var">handleTick</span></a></span><span> </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="#local-6989586621679451193"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span id="local-6989586621679451195"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451195"><span class="hs-identifier hs-var">now</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting UTCTime RootState UTCTime -&gt; EventM Name RootState UTCTime
forall s (m :: * -&gt; *) a. MonadState s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">use</span></span><span> </span><span class="annot"><span class="annottext">Getting UTCTime RootState UTCTime
Lens' RootState UTCTime
</span><a href="Hydra.TUI.Model.html#nowL"><span class="hs-identifier hs-var">nowL</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name ConnectedState) ()) RootState ConnectedState
-&gt; EventM Name ConnectedState () -&gt; EventM Name RootState ()
forall c.
LensLike'
  (Zoomed (EventM Name ConnectedState) c) RootState ConnectedState
-&gt; EventM Name ConnectedState c -&gt; EventM Name RootState c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name ConnectedState) ()) RootState ConnectedState
(ConnectedState
 -&gt; Focusing (StateT (EventState Name) IO) () ConnectedState)
-&gt; RootState -&gt; Focusing (StateT (EventState Name) IO) () RootState
Lens' RootState ConnectedState
</span><a href="Hydra.TUI.Model.html#connectedStateL"><span class="hs-identifier hs-var">connectedStateL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name ConnectedState () -&gt; EventM Name RootState ())
-&gt; EventM Name ConnectedState () -&gt; EventM Name RootState ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-52"></span><span>      </span><span class="annot"><span class="annottext">HydraEvent Tx -&gt; EventM Name ConnectedState ()
</span><a href="Hydra.TUI.Handlers.html#handleHydraEventsConnectedState"><span class="hs-identifier hs-var">handleHydraEventsConnectedState</span></a></span><span> </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="#local-6989586621679451193"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-53"></span><span>      </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name Connection) ()) ConnectedState Connection
-&gt; EventM Name Connection () -&gt; EventM Name ConnectedState ()
forall c.
LensLike'
  (Zoomed (EventM Name Connection) c) ConnectedState Connection
-&gt; EventM Name Connection c -&gt; EventM Name ConnectedState c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name Connection) ()) ConnectedState Connection
(Connection
 -&gt; Focusing (StateT (EventState Name) IO) () Connection)
-&gt; ConnectedState
-&gt; Focusing (StateT (EventState Name) IO) () ConnectedState
Traversal' ConnectedState Connection
</span><a href="Hydra.TUI.Model.html#connectionL"><span class="hs-identifier hs-var">connectionL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name Connection () -&gt; EventM Name ConnectedState ())
-&gt; EventM Name Connection () -&gt; EventM Name ConnectedState ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; HydraEvent Tx -&gt; EventM Name Connection ()
</span><a href="Hydra.TUI.Handlers.html#handleHydraEventsConnection"><span class="hs-identifier hs-var">handleHydraEventsConnection</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451195"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="#local-6989586621679451193"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name [LogMessage]) ()) RootState [LogMessage]
-&gt; EventM Name [LogMessage] () -&gt; EventM Name RootState ()
forall c.
LensLike'
  (Zoomed (EventM Name [LogMessage]) c) RootState [LogMessage]
-&gt; EventM Name [LogMessage] c -&gt; EventM Name RootState c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LogState -&gt; Focusing (StateT (EventState Name) IO) () LogState)
-&gt; RootState -&gt; Focusing (StateT (EventState Name) IO) () RootState
Lens' RootState LogState
</span><a href="Hydra.TUI.Model.html#logStateL"><span class="hs-identifier hs-var">logStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((LogState -&gt; Focusing (StateT (EventState Name) IO) () LogState)
 -&gt; RootState
 -&gt; Focusing (StateT (EventState Name) IO) () RootState)
-&gt; (([LogMessage]
     -&gt; Focusing (StateT (EventState Name) IO) () [LogMessage])
    -&gt; LogState -&gt; Focusing (StateT (EventState Name) IO) () LogState)
-&gt; ([LogMessage]
    -&gt; Focusing (StateT (EventState Name) IO) () [LogMessage])
-&gt; RootState
-&gt; Focusing (StateT (EventState Name) IO) () RootState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([LogMessage]
 -&gt; Focusing (StateT (EventState Name) IO) () [LogMessage])
-&gt; LogState -&gt; Focusing (StateT (EventState Name) IO) () LogState
Lens' LogState [LogMessage]
</span><a href="Hydra.TUI.Logging.Types.html#logMessagesL"><span class="hs-identifier hs-var">logMessagesL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(EventM Name [LogMessage] () -&gt; EventM Name RootState ())
-&gt; EventM Name [LogMessage] () -&gt; EventM Name RootState ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-55"></span><span>      </span><span class="annot"><span class="annottext">HydraEvent Tx -&gt; EventM Name [LogMessage] ()
</span><a href="Hydra.TUI.Handlers.html#handleHydraEventsInfo"><span class="hs-identifier hs-var">handleHydraEventsInfo</span></a></span><span> </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="#local-6989586621679451193"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MouseDown</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name RootState ()
forall a. a -&gt; EventM Name RootState a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MouseUp</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name RootState ()
forall a. a -&gt; EventM Name RootState a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">VtyEvent</span></span><span> </span><span id="local-6989586621679451208"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451208"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-59"></span><span>    </span><span id="local-6989586621679451209"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679451209"><span class="hs-identifier hs-var">modalOpen</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(RootState -&gt; Bool) -&gt; EventM Name RootState Bool
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#gets"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">RootState -&gt; Bool
</span><a href="Hydra.TUI.Model.html#isModalOpen"><span class="hs-identifier hs-var">isModalOpen</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451208"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-61"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'c'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Modifier
</span><span class="hs-identifier hs-var">MCtrl</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EventM Name RootState ()
forall n s. EventM n s ()
</span><span class="hs-identifier hs-var">halt</span></span><span>
</span><span id="line-62"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'d'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Modifier
</span><span class="hs-identifier hs-var">MCtrl</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EventM Name RootState ()
forall n s. EventM n s ()
</span><span class="hs-identifier hs-var">halt</span></span><span>
</span><span id="line-63"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'q'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-64"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679451209"><span class="hs-identifier hs-var">modalOpen</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EventM Name RootState ()
forall n s. EventM n s ()
</span><span class="hs-identifier hs-var">halt</span></span><span>
</span><span id="line-65"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'Q'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-66"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679451209"><span class="hs-identifier hs-var">modalOpen</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EventM Name RootState ()
forall n s. EventM n s ()
</span><span class="hs-identifier hs-var">halt</span></span><span>
</span><span id="line-67"></span><span>      </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-68"></span><span>        </span><span class="annot"><span class="annottext">LensLike' (Zoomed (EventM Name HeadState) ()) RootState HeadState
-&gt; EventM Name HeadState () -&gt; EventM Name RootState ()
forall c.
LensLike' (Zoomed (EventM Name HeadState) c) RootState HeadState
-&gt; EventM Name HeadState c -&gt; EventM Name RootState c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ConnectedState
 -&gt; Focusing (StateT (EventState Name) IO) () ConnectedState)
-&gt; RootState -&gt; Focusing (StateT (EventState Name) IO) () RootState
Lens' RootState ConnectedState
</span><a href="Hydra.TUI.Model.html#connectedStateL"><span class="hs-identifier hs-var">connectedStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((ConnectedState
  -&gt; Focusing (StateT (EventState Name) IO) () ConnectedState)
 -&gt; RootState
 -&gt; Focusing (StateT (EventState Name) IO) () RootState)
-&gt; ((HeadState
     -&gt; Focusing (StateT (EventState Name) IO) () HeadState)
    -&gt; ConnectedState
    -&gt; Focusing (StateT (EventState Name) IO) () ConnectedState)
-&gt; (HeadState
    -&gt; Focusing (StateT (EventState Name) IO) () HeadState)
-&gt; RootState
-&gt; Focusing (StateT (EventState Name) IO) () RootState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Connection
 -&gt; Focusing (StateT (EventState Name) IO) () Connection)
-&gt; ConnectedState
-&gt; Focusing (StateT (EventState Name) IO) () ConnectedState
Traversal' ConnectedState Connection
</span><a href="Hydra.TUI.Model.html#connectionL"><span class="hs-identifier hs-var">connectionL</span></a></span><span> </span><span class="annot"><span class="annottext">((Connection
  -&gt; Focusing (StateT (EventState Name) IO) () Connection)
 -&gt; ConnectedState
 -&gt; Focusing (StateT (EventState Name) IO) () ConnectedState)
-&gt; ((HeadState
     -&gt; Focusing (StateT (EventState Name) IO) () HeadState)
    -&gt; Connection
    -&gt; Focusing (StateT (EventState Name) IO) () Connection)
-&gt; (HeadState
    -&gt; Focusing (StateT (EventState Name) IO) () HeadState)
-&gt; ConnectedState
-&gt; Focusing (StateT (EventState Name) IO) () ConnectedState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(HeadState -&gt; Focusing (StateT (EventState Name) IO) () HeadState)
-&gt; Connection
-&gt; Focusing (StateT (EventState Name) IO) () Connection
Lens' Connection HeadState
</span><a href="Hydra.TUI.Model.html#headStateL"><span class="hs-identifier hs-var">headStateL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(EventM Name HeadState () -&gt; EventM Name RootState ())
-&gt; EventM Name HeadState () -&gt; EventM Name RootState ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-69"></span><span>          </span><span class="annot"><span class="annottext">CardanoClient -&gt; Client Tx IO -&gt; Event -&gt; EventM Name HeadState ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsHeadState"><span class="hs-identifier hs-var">handleVtyEventsHeadState</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679451190"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451191"><span class="hs-identifier hs-var">client</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451208"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; EventM Name RootState () -&gt; EventM Name RootState ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679451209"><span class="hs-identifier hs-var">modalOpen</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name RootState () -&gt; EventM Name RootState ())
-&gt; EventM Name RootState () -&gt; EventM Name RootState ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-72"></span><span>          </span><span class="annot"><span class="annottext">LensLike' (Zoomed (EventM Name LogState) ()) RootState LogState
-&gt; EventM Name LogState () -&gt; EventM Name RootState ()
forall c.
LensLike' (Zoomed (EventM Name LogState) c) RootState LogState
-&gt; EventM Name LogState c -&gt; EventM Name RootState c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike' (Zoomed (EventM Name LogState) ()) RootState LogState
(LogState -&gt; Focusing (StateT (EventState Name) IO) () LogState)
-&gt; RootState -&gt; Focusing (StateT (EventState Name) IO) () RootState
Lens' RootState LogState
</span><a href="Hydra.TUI.Model.html#logStateL"><span class="hs-identifier hs-var">logStateL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name LogState () -&gt; EventM Name RootState ())
-&gt; EventM Name LogState () -&gt; EventM Name RootState ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Event -&gt; EventM Name LogState ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsLogState"><span class="hs-identifier hs-var">handleVtyEventsLogState</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451208"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="annot"><span class="hs-comment">-- * AppEvent handlers</span></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleTick"><span class="hs-identifier hs-type">handleTick</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hydra.Client.html#HydraEvent"><span class="hs-identifier hs-type">HydraEvent</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#RootState"><span class="hs-identifier hs-type">RootState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span id="handleTick"><span class="annot"><span class="annottext">handleTick :: HydraEvent Tx -&gt; EventM Name RootState ()
</span><a href="Hydra.TUI.Handlers.html#handleTick"><span class="hs-identifier hs-var hs-var">handleTick</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Tick"><span class="hs-identifier hs-type">Tick</span></a></span><span> </span><span id="local-6989586621679451220"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451220"><span class="hs-identifier hs-var">now</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(UTCTime -&gt; Identity UTCTime) -&gt; RootState -&gt; Identity RootState
Lens' RootState UTCTime
</span><a href="Hydra.TUI.Model.html#nowL"><span class="hs-identifier hs-var">nowL</span></a></span><span> </span><span class="annot"><span class="annottext">((UTCTime -&gt; Identity UTCTime) -&gt; RootState -&gt; Identity RootState)
-&gt; UTCTime -&gt; EventM Name RootState ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451220"><span class="hs-identifier hs-var">now</span></a></span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name RootState ()
forall a. a -&gt; EventM Name RootState a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleHydraEventsConnectedState"><span class="hs-identifier hs-type">handleHydraEventsConnectedState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hydra.Client.html#HydraEvent"><span class="hs-identifier hs-type">HydraEvent</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#ConnectedState"><span class="hs-identifier hs-type">ConnectedState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span id="handleHydraEventsConnectedState"><span class="annot"><span class="annottext">handleHydraEventsConnectedState :: HydraEvent Tx -&gt; EventM Name ConnectedState ()
</span><a href="Hydra.TUI.Handlers.html#handleHydraEventsConnectedState"><span class="hs-identifier hs-var hs-var">handleHydraEventsConnectedState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-83"></span><span>  </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="Hydra.Client.html#ClientConnected"><span class="hs-identifier hs-var">ClientConnected</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConnectedState -&gt; EventM Name ConnectedState ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">(ConnectedState -&gt; EventM Name ConnectedState ())
-&gt; ConnectedState -&gt; EventM Name ConnectedState ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Connection -&gt; ConnectedState
</span><a href="Hydra.TUI.Model.html#Connected"><span class="hs-identifier hs-var">Connected</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="Hydra.TUI.Model.html#emptyConnection"><span class="hs-identifier hs-var">emptyConnection</span></a></span><span>
</span><span id="line-84"></span><span>  </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="Hydra.Client.html#ClientDisconnected"><span class="hs-identifier hs-var">ClientDisconnected</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConnectedState -&gt; EventM Name ConnectedState ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">ConnectedState
</span><a href="Hydra.TUI.Model.html#Disconnected"><span class="hs-identifier hs-var">Disconnected</span></a></span><span>
</span><span id="line-85"></span><span>  </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name ConnectedState ()
forall a. a -&gt; EventM Name ConnectedState a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleHydraEventsConnection"><span class="hs-identifier hs-type">handleHydraEventsConnection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/time-1.12.2/src/Data.Time.Clock.Internal.UTCTime.html#UTCTime"><span class="hs-identifier hs-type">UTCTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Client.html#HydraEvent"><span class="hs-identifier hs-type">HydraEvent</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Connection"><span class="hs-identifier hs-type">Connection</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span id="handleHydraEventsConnection"><span class="annot"><span class="annottext">handleHydraEventsConnection :: UTCTime -&gt; HydraEvent Tx -&gt; EventM Name Connection ()
</span><a href="Hydra.TUI.Handlers.html#handleHydraEventsConnection"><span class="hs-identifier hs-var hs-var">handleHydraEventsConnection</span></a></span></span><span> </span><span id="local-6989586621679451227"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451227"><span class="hs-identifier hs-var">now</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-comment">-- Note: Greetings is the last event seen after restart.</span><span>
</span><span id="line-90"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hydra.Client.html#ApiGreetings"><span class="hs-identifier hs-type">ApiGreetings</span></a></span><span>
</span><span id="line-92"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">API.Greetings</span></span><span>
</span><span id="line-93"></span><span>          </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679451231"><span class="annot"><span class="annottext">Party
me :: Party
$sel:me:Greetings :: forall tx. Greetings tx -&gt; Party
</span><a href="#local-6989586621679451231"><span class="hs-identifier hs-var hs-var">me</span></a></span></span><span>
</span><span id="line-94"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:env:Greetings :: forall tx. Greetings tx -&gt; Environment
</span><span class="hs-identifier hs-var">env</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Environment</span></span><span class="hs-special">{</span><span id="local-6989586621679451235"><span class="annot"><span class="annottext">Name
configuredPeers :: Name
$sel:configuredPeers:Environment :: Environment -&gt; Name
</span><a href="#local-6989586621679451235"><span class="hs-identifier hs-var hs-var">configuredPeers</span></a></span></span><span class="hs-special">}</span><span>
</span><span id="line-95"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:networkInfo:Greetings :: forall tx. Greetings tx -&gt; NetworkInfo
</span><span class="hs-identifier hs-var">networkInfo</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkInfo</span></span><span class="hs-special">{</span><span id="local-6989586621679451239"><span class="annot"><span class="annottext">Bool
networkConnected :: Bool
$sel:networkConnected:NetworkInfo :: NetworkInfo -&gt; Bool
</span><a href="#local-6989586621679451239"><span class="hs-identifier hs-var hs-var">networkConnected</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451241"><span class="annot"><span class="annottext">Map Host Bool
peersInfo :: Map Host Bool
$sel:peersInfo:NetworkInfo :: NetworkInfo -&gt; Map Host Bool
</span><a href="#local-6989586621679451241"><span class="hs-identifier hs-var hs-var">peersInfo</span></a></span></span><span class="hs-special">}</span><span>
</span><span id="line-96"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-97"></span><span>      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-98"></span><span>      </span><span class="annot"><span class="annottext">(IdentifiedState -&gt; Identity IdentifiedState)
-&gt; Connection -&gt; Identity Connection
Lens' Connection IdentifiedState
</span><a href="Hydra.TUI.Model.html#meL"><span class="hs-identifier hs-var">meL</span></a></span><span> </span><span class="annot"><span class="annottext">((IdentifiedState -&gt; Identity IdentifiedState)
 -&gt; Connection -&gt; Identity Connection)
-&gt; IdentifiedState -&gt; EventM Name Connection ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Party -&gt; IdentifiedState
</span><a href="Hydra.TUI.Model.html#Identified"><span class="hs-identifier hs-var">Identified</span></a></span><span> </span><span class="annot"><span class="annottext">Party
</span><a href="#local-6989586621679451231"><span class="hs-identifier hs-var">me</span></a></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span>      </span><span class="annot"><span class="annottext">(Maybe NetworkState -&gt; Identity (Maybe NetworkState))
-&gt; Connection -&gt; Identity Connection
Lens' Connection (Maybe NetworkState)
</span><a href="Hydra.TUI.Model.html#networkStateL"><span class="hs-identifier hs-var">networkStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe NetworkState -&gt; Identity (Maybe NetworkState))
 -&gt; Connection -&gt; Identity Connection)
-&gt; Maybe NetworkState -&gt; EventM Name Connection ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679451239"><span class="hs-identifier hs-var">networkConnected</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">NetworkState -&gt; Maybe NetworkState
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkState
</span><a href="Hydra.TUI.Model.html#NetworkConnected"><span class="hs-identifier hs-var">NetworkConnected</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">NetworkState -&gt; Maybe NetworkState
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkState
</span><a href="Hydra.TUI.Model.html#NetworkDisconnected"><span class="hs-identifier hs-var">NetworkDisconnected</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/text-2.0.2/src/Data.Text.html#null"><span class="hs-identifier hs-var">T.null</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679451235"><span class="hs-identifier hs-var">configuredPeers</span></a></span><span>
</span><span id="line-103"></span><span>        </span><span class="hs-keyword">then</span><span>
</span><span id="line-104"></span><span>          </span><span class="annot"><span class="annottext">([(Host, PeerStatus)] -&gt; Identity [(Host, PeerStatus)])
-&gt; Connection -&gt; Identity Connection
Lens' Connection [(Host, PeerStatus)]
</span><a href="Hydra.TUI.Model.html#peersL"><span class="hs-identifier hs-var">peersL</span></a></span><span> </span><span class="annot"><span class="annottext">(([(Host, PeerStatus)] -&gt; Identity [(Host, PeerStatus)])
 -&gt; Connection -&gt; Identity Connection)
-&gt; [(Host, PeerStatus)] -&gt; EventM Name Connection ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">[(Host, PeerStatus)]
forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-105"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-106"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451250"><span class="annot"><span class="annottext">peerStrs :: [String]
</span><a href="#local-6989586621679451250"><span class="hs-identifier hs-var hs-var">peerStrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; String) -&gt; [Name] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/text-2.0.2/src/Data.Text.Show.html#unpack"><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; Name -&gt; Name -&gt; [Name]
Name -&gt; Name -&gt; [Name]
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/text-2.0.2/src/Data.Text.html#splitOn"><span class="hs-identifier hs-var">T.splitOn</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679451235"><span class="hs-identifier hs-var">configuredPeers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>              </span><span id="local-6989586621679451253"><span class="annot"><span class="annottext">peerAddrs :: [String]
</span><a href="#local-6989586621679451253"><span class="hs-identifier hs-var hs-var">peerAddrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; [String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; String
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.List.html#takeWhile"><span class="hs-identifier hs-var">takeWhile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679451250"><span class="hs-identifier hs-var">peerStrs</span></a></span><span>
</span><span id="line-108"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String Host) -&gt; [String] -&gt; Either String [Host]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Traversable.html#traverse"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Host
forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m Host
</span><span class="hs-identifier hs-var">readHost</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679451253"><span class="hs-identifier hs-var">peerAddrs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-109"></span><span>            </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679451257"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679451257"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-110"></span><span>              </span><span class="annot"><span class="annottext">IO () -&gt; EventM Name Connection ()
forall a. IO a -&gt; EventM Name Connection a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; EventM Name Connection ())
-&gt; IO () -&gt; EventM Name Connection ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; m ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Failed to parse configured peers: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679451257"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-111"></span><span>              </span><span class="annot"><span class="annottext">([(Host, PeerStatus)] -&gt; Identity [(Host, PeerStatus)])
-&gt; Connection -&gt; Identity Connection
Lens' Connection [(Host, PeerStatus)]
</span><a href="Hydra.TUI.Model.html#peersL"><span class="hs-identifier hs-var">peersL</span></a></span><span> </span><span class="annot"><span class="annottext">(([(Host, PeerStatus)] -&gt; Identity [(Host, PeerStatus)])
 -&gt; Connection -&gt; Identity Connection)
-&gt; [(Host, PeerStatus)] -&gt; EventM Name Connection ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">[(Host, PeerStatus)]
forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-112"></span><span>            </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679451260"><span class="annot"><span class="annottext">[Host]
</span><a href="#local-6989586621679451260"><span class="hs-identifier hs-var">parsedPeers</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-113"></span><span>              </span><span id="local-6989586621679451261"><span class="annot"><span class="annottext">[(Host, PeerStatus)]
</span><a href="#local-6989586621679451261"><span class="hs-identifier hs-var">existing</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting [(Host, PeerStatus)] Connection [(Host, PeerStatus)]
-&gt; EventM Name Connection [(Host, PeerStatus)]
forall s (m :: * -&gt; *) a. MonadState s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">use</span></span><span> </span><span class="annot"><span class="annottext">Getting [(Host, PeerStatus)] Connection [(Host, PeerStatus)]
Lens' Connection [(Host, PeerStatus)]
</span><a href="Hydra.TUI.Model.html#peersL"><span class="hs-identifier hs-var">peersL</span></a></span><span>
</span><span id="line-114"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451262"><span class="annot"><span class="annottext">existingMap :: Map Host PeerStatus
</span><a href="#local-6989586621679451262"><span class="hs-identifier hs-var hs-var">existingMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Host, PeerStatus)] -&gt; Map Host PeerStatus
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Host, PeerStatus)]
</span><a href="#local-6989586621679451261"><span class="hs-identifier hs-var">existing</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span>                  </span><span id="local-6989586621679451264"><span class="annot"><span class="annottext">statusFor :: Host -&gt; PeerStatus
</span><a href="#local-6989586621679451264"><span class="hs-identifier hs-var hs-var">statusFor</span></a></span></span><span> </span><span id="local-6989586621679451265"><span class="annot"><span class="annottext">Host
</span><a href="#local-6989586621679451265"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-117"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Host -&gt; Map Host Bool -&gt; Maybe Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Host
</span><a href="#local-6989586621679451265"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Map Host Bool
</span><a href="#local-6989586621679451241"><span class="hs-identifier hs-var">peersInfo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-118"></span><span>                      </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PeerStatus
</span><a href="Hydra.TUI.Model.html#PeerIsConnected"><span class="hs-identifier hs-var">PeerIsConnected</span></a></span><span>
</span><span id="line-119"></span><span>                      </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PeerStatus
</span><a href="Hydra.TUI.Model.html#PeerIsDisconnected"><span class="hs-identifier hs-var">PeerIsDisconnected</span></a></span><span>
</span><span id="line-120"></span><span>                      </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PeerStatus -&gt; Host -&gt; Map Host PeerStatus -&gt; PeerStatus
forall k a. Ord k =&gt; a -&gt; k -&gt; Map k a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#findWithDefault"><span class="hs-identifier hs-var">Map.findWithDefault</span></a></span><span> </span><span class="annot"><span class="annottext">PeerStatus
</span><a href="Hydra.TUI.Model.html#PeerIsUnknown"><span class="hs-identifier hs-var">PeerIsUnknown</span></a></span><span> </span><span class="annot"><span class="annottext">Host
</span><a href="#local-6989586621679451265"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Map Host PeerStatus
</span><a href="#local-6989586621679451262"><span class="hs-identifier hs-var">existingMap</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span>              </span><span class="annot"><span class="annottext">([(Host, PeerStatus)] -&gt; Identity [(Host, PeerStatus)])
-&gt; Connection -&gt; Identity Connection
Lens' Connection [(Host, PeerStatus)]
</span><a href="Hydra.TUI.Model.html#peersL"><span class="hs-identifier hs-var">peersL</span></a></span><span> </span><span class="annot"><span class="annottext">(([(Host, PeerStatus)] -&gt; Identity [(Host, PeerStatus)])
 -&gt; Connection -&gt; Identity Connection)
-&gt; [(Host, PeerStatus)] -&gt; EventM Name Connection ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Host
</span><a href="#local-6989586621679451271"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Host -&gt; PeerStatus
</span><a href="#local-6989586621679451264"><span class="hs-identifier hs-var">statusFor</span></a></span><span> </span><span class="annot"><span class="annottext">Host
</span><a href="#local-6989586621679451271"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679451271"><span class="annot"><span class="annottext">Host
</span><a href="#local-6989586621679451271"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Host]
</span><a href="#local-6989586621679451260"><span class="hs-identifier hs-var">parsedPeers</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-123"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.PeerConnected</span></span><span> </span><span id="local-6989586621679451276"><span class="annot"><span class="annottext">Host
</span><a href="#local-6989586621679451276"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><span class="annottext">([(Host, PeerStatus)] -&gt; Identity [(Host, PeerStatus)])
-&gt; Connection -&gt; Identity Connection
Lens' Connection [(Host, PeerStatus)]
</span><a href="Hydra.TUI.Model.html#peersL"><span class="hs-identifier hs-var">peersL</span></a></span><span> </span><span class="annot"><span class="annottext">(([(Host, PeerStatus)] -&gt; Identity [(Host, PeerStatus)])
 -&gt; Connection -&gt; Identity Connection)
-&gt; ([(Host, PeerStatus)] -&gt; [(Host, PeerStatus)])
-&gt; EventM Name Connection ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; (a -&gt; b) -&gt; m ()
</span><span class="hs-operator hs-var">%=</span></span><span> </span><span class="annot"><span class="annottext">Host -&gt; PeerStatus -&gt; [(Host, PeerStatus)] -&gt; [(Host, PeerStatus)]
</span><a href="#local-6989586621679451277"><span class="hs-identifier hs-var">updatePeerStatus</span></a></span><span> </span><span class="annot"><span class="annottext">Host
</span><a href="#local-6989586621679451276"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">PeerStatus
</span><a href="Hydra.TUI.Model.html#PeerIsConnected"><span class="hs-identifier hs-var">PeerIsConnected</span></a></span><span>
</span><span id="line-125"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.PeerDisconnected</span></span><span> </span><span id="local-6989586621679451279"><span class="annot"><span class="annottext">Host
</span><a href="#local-6989586621679451279"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><span class="annottext">([(Host, PeerStatus)] -&gt; Identity [(Host, PeerStatus)])
-&gt; Connection -&gt; Identity Connection
Lens' Connection [(Host, PeerStatus)]
</span><a href="Hydra.TUI.Model.html#peersL"><span class="hs-identifier hs-var">peersL</span></a></span><span> </span><span class="annot"><span class="annottext">(([(Host, PeerStatus)] -&gt; Identity [(Host, PeerStatus)])
 -&gt; Connection -&gt; Identity Connection)
-&gt; ([(Host, PeerStatus)] -&gt; [(Host, PeerStatus)])
-&gt; EventM Name Connection ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; (a -&gt; b) -&gt; m ()
</span><span class="hs-operator hs-var">%=</span></span><span> </span><span class="annot"><span class="annottext">Host -&gt; PeerStatus -&gt; [(Host, PeerStatus)] -&gt; [(Host, PeerStatus)]
</span><a href="#local-6989586621679451277"><span class="hs-identifier hs-var">updatePeerStatus</span></a></span><span> </span><span class="annot"><span class="annottext">Host
</span><a href="#local-6989586621679451279"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">PeerStatus
</span><a href="Hydra.TUI.Model.html#PeerIsDisconnected"><span class="hs-identifier hs-var">PeerIsDisconnected</span></a></span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ServerOutput Tx
</span><span class="hs-identifier hs-var">API.NetworkConnected</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><span class="annottext">(Maybe NetworkState -&gt; Identity (Maybe NetworkState))
-&gt; Connection -&gt; Identity Connection
Lens' Connection (Maybe NetworkState)
</span><a href="Hydra.TUI.Model.html#networkStateL"><span class="hs-identifier hs-var">networkStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe NetworkState -&gt; Identity (Maybe NetworkState))
 -&gt; Connection -&gt; Identity Connection)
-&gt; Maybe NetworkState -&gt; EventM Name Connection ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">NetworkState -&gt; Maybe NetworkState
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkState
</span><a href="Hydra.TUI.Model.html#NetworkConnected"><span class="hs-identifier hs-var">NetworkConnected</span></a></span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><span class="annottext">([(Host, PeerStatus)] -&gt; Identity [(Host, PeerStatus)])
-&gt; Connection -&gt; Identity Connection
Lens' Connection [(Host, PeerStatus)]
</span><a href="Hydra.TUI.Model.html#peersL"><span class="hs-identifier hs-var">peersL</span></a></span><span> </span><span class="annot"><span class="annottext">(([(Host, PeerStatus)] -&gt; Identity [(Host, PeerStatus)])
 -&gt; Connection -&gt; Identity Connection)
-&gt; ([(Host, PeerStatus)] -&gt; [(Host, PeerStatus)])
-&gt; EventM Name Connection ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; (a -&gt; b) -&gt; m ()
</span><span class="hs-operator hs-var">%=</span></span><span> </span><span class="annot"><span class="annottext">((Host, PeerStatus) -&gt; (Host, PeerStatus))
-&gt; [(Host, PeerStatus)] -&gt; [(Host, PeerStatus)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679451281"><span class="annot"><span class="annottext">Host
</span><a href="#local-6989586621679451281"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PeerStatus
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Host
</span><a href="#local-6989586621679451281"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PeerStatus
</span><a href="Hydra.TUI.Model.html#PeerIsUnknown"><span class="hs-identifier hs-var">PeerIsUnknown</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ServerOutput Tx
</span><span class="hs-identifier hs-var">API.NetworkDisconnected</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><span class="annottext">(Maybe NetworkState -&gt; Identity (Maybe NetworkState))
-&gt; Connection -&gt; Identity Connection
Lens' Connection (Maybe NetworkState)
</span><a href="Hydra.TUI.Model.html#networkStateL"><span class="hs-identifier hs-var">networkStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe NetworkState -&gt; Identity (Maybe NetworkState))
 -&gt; Connection -&gt; Identity Connection)
-&gt; Maybe NetworkState -&gt; EventM Name Connection ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">NetworkState -&gt; Maybe NetworkState
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkState
</span><a href="Hydra.TUI.Model.html#NetworkDisconnected"><span class="hs-identifier hs-var">NetworkDisconnected</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><span class="annottext">([(Host, PeerStatus)] -&gt; Identity [(Host, PeerStatus)])
-&gt; Connection -&gt; Identity Connection
Lens' Connection [(Host, PeerStatus)]
</span><a href="Hydra.TUI.Model.html#peersL"><span class="hs-identifier hs-var">peersL</span></a></span><span> </span><span class="annot"><span class="annottext">(([(Host, PeerStatus)] -&gt; Identity [(Host, PeerStatus)])
 -&gt; Connection -&gt; Identity Connection)
-&gt; ([(Host, PeerStatus)] -&gt; [(Host, PeerStatus)])
-&gt; EventM Name Connection ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; (a -&gt; b) -&gt; m ()
</span><span class="hs-operator hs-var">%=</span></span><span> </span><span class="annot"><span class="annottext">((Host, PeerStatus) -&gt; (Host, PeerStatus))
-&gt; [(Host, PeerStatus)] -&gt; [(Host, PeerStatus)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679451283"><span class="annot"><span class="annottext">Host
</span><a href="#local-6989586621679451283"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PeerStatus
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Host
</span><a href="#local-6989586621679451283"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PeerStatus
</span><a href="Hydra.TUI.Model.html#PeerIsUnknown"><span class="hs-identifier hs-var">PeerIsUnknown</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>  </span><span id="local-6989586621679451284"><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="#local-6989586621679451284"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LensLike' (Zoomed (EventM Name HeadState) ()) Connection HeadState
-&gt; EventM Name HeadState () -&gt; EventM Name Connection ()
forall c.
LensLike' (Zoomed (EventM Name HeadState) c) Connection HeadState
-&gt; EventM Name HeadState c -&gt; EventM Name Connection c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike' (Zoomed (EventM Name HeadState) ()) Connection HeadState
(HeadState -&gt; Focusing (StateT (EventState Name) IO) () HeadState)
-&gt; Connection
-&gt; Focusing (StateT (EventState Name) IO) () Connection
Lens' Connection HeadState
</span><a href="Hydra.TUI.Model.html#headStateL"><span class="hs-identifier hs-var">headStateL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name HeadState () -&gt; EventM Name Connection ())
-&gt; EventM Name HeadState () -&gt; EventM Name Connection ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; HydraEvent Tx -&gt; EventM Name HeadState ()
</span><a href="Hydra.TUI.Handlers.html#handleHydraEventsHeadState"><span class="hs-identifier hs-var">handleHydraEventsHeadState</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451227"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="#local-6989586621679451284"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-134"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-135"></span><span>  </span><span class="annot"><a href="#local-6989586621679451277"><span class="hs-identifier hs-type">updatePeerStatus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Host</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#PeerStatus"><span class="hs-identifier hs-type">PeerStatus</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Host</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#PeerStatus"><span class="hs-identifier hs-type">PeerStatus</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Host</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#PeerStatus"><span class="hs-identifier hs-type">PeerStatus</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-136"></span><span>  </span><span id="local-6989586621679451277"><span class="annot"><span class="annottext">updatePeerStatus :: Host -&gt; PeerStatus -&gt; [(Host, PeerStatus)] -&gt; [(Host, PeerStatus)]
</span><a href="#local-6989586621679451277"><span class="hs-identifier hs-var hs-var">updatePeerStatus</span></a></span></span><span> </span><span id="local-6989586621679451286"><span class="annot"><span class="annottext">Host
</span><a href="#local-6989586621679451286"><span class="hs-identifier hs-var">host</span></a></span></span><span> </span><span id="local-6989586621679451287"><span class="annot"><span class="annottext">PeerStatus
</span><a href="#local-6989586621679451287"><span class="hs-identifier hs-var">status</span></a></span></span><span> </span><span id="local-6989586621679451288"><span class="annot"><span class="annottext">[(Host, PeerStatus)]
</span><a href="#local-6989586621679451288"><span class="hs-identifier hs-var">peers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Host
</span><a href="#local-6989586621679451286"><span class="hs-identifier hs-var">host</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PeerStatus
</span><a href="#local-6989586621679451287"><span class="hs-identifier hs-var">status</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Host, PeerStatus) -&gt; [(Host, PeerStatus)] -&gt; [(Host, PeerStatus)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">((Host, PeerStatus) -&gt; Bool)
-&gt; [(Host, PeerStatus)] -&gt; [(Host, PeerStatus)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Host -&gt; Host -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Host
</span><a href="#local-6989586621679451286"><span class="hs-identifier hs-var">host</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Host -&gt; Bool)
-&gt; ((Host, PeerStatus) -&gt; Host) -&gt; (Host, PeerStatus) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Host, PeerStatus) -&gt; Host
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Host, PeerStatus)]
</span><a href="#local-6989586621679451288"><span class="hs-identifier hs-var">peers</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleHydraEventsHeadState"><span class="hs-identifier hs-type">handleHydraEventsHeadState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/time-1.12.2/src/Data.Time.Clock.Internal.UTCTime.html#UTCTime"><span class="hs-identifier hs-type">UTCTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Client.html#HydraEvent"><span class="hs-identifier hs-type">HydraEvent</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#HeadState"><span class="hs-identifier hs-type">HeadState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span id="handleHydraEventsHeadState"><span class="annot"><span class="annottext">handleHydraEventsHeadState :: UTCTime -&gt; HydraEvent Tx -&gt; EventM Name HeadState ()
</span><a href="Hydra.TUI.Handlers.html#handleHydraEventsHeadState"><span class="hs-identifier hs-var hs-var">handleHydraEventsHeadState</span></a></span></span><span> </span><span id="local-6989586621679451290"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451290"><span class="hs-identifier hs-var">now</span></a></span></span><span> </span><span id="local-6989586621679451291"><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="#local-6989586621679451291"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-141"></span><span>  </span><span id="local-6989586621679451292"><span class="annot"><span class="annottext">HeadState
</span><a href="#local-6989586621679451292"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EventM Name HeadState HeadState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="#local-6989586621679451291"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451294"><span class="annot"><span class="annottext">UTCTime
time :: UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
</span><a href="#local-6989586621679451294"><span class="hs-identifier hs-var hs-var">time</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.HeadIsInitializing</span></span><span class="hs-special">{</span><span id="local-6989586621679451297"><span class="annot"><span class="annottext">[Party]
parties :: [Party]
$sel:parties:NetworkConnected :: forall tx. ServerOutput tx -&gt; [Party]
</span><a href="#local-6989586621679451297"><span class="hs-identifier hs-var hs-var">parties</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451299"><span class="annot"><span class="annottext">HeadId
headId :: HeadId
$sel:headId:NetworkConnected :: forall tx. ServerOutput tx -&gt; HeadId
</span><a href="#local-6989586621679451299"><span class="hs-identifier hs-var hs-var">headId</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-144"></span><span>      </span><span class="annot"><span class="annottext">HeadState -&gt; EventM Name HeadState ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">(HeadState -&gt; EventM Name HeadState ())
-&gt; HeadState -&gt; EventM Name HeadState ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ActiveLink -&gt; HeadState
</span><a href="Hydra.TUI.Model.html#Active"><span class="hs-identifier hs-var">Active</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Party] -&gt; HeadId -&gt; ActiveLink
</span><a href="Hydra.TUI.Model.html#newActiveLink"><span class="hs-identifier hs-var">newActiveLink</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Party] -&gt; [Party]
forall a. [a] -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Foldable.html#toList"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">[Party]
</span><a href="#local-6989586621679451297"><span class="hs-identifier hs-var">parties</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HeadId
</span><a href="#local-6989586621679451299"><span class="hs-identifier hs-var">headId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451304"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.EventLogRotated</span></span><span class="hs-special">{</span><span id="local-6989586621679451306"><span class="annot"><span class="annottext">NodeState Tx
checkpoint :: NodeState Tx
$sel:checkpoint:NetworkConnected :: forall tx. ServerOutput tx -&gt; NodeState tx
</span><a href="#local-6989586621679451306"><span class="hs-identifier hs-var hs-var">checkpoint</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-146"></span><span>      </span><span class="annot"><span class="annottext">(HeadState -&gt; HeadState) -&gt; EventM Name HeadState ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#modify"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="annot"><span class="annottext">((HeadState -&gt; HeadState) -&gt; EventM Name HeadState ())
-&gt; (HeadState -&gt; HeadState) -&gt; EventM Name HeadState ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679451309"><span class="annot"><span class="annottext">HeadState
</span><a href="#local-6989586621679451309"><span class="hs-identifier hs-var">current</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; HeadState -&gt; NodeState Tx -&gt; HeadState
</span><a href="Hydra.TUI.Model.html#recoverHeadState"><span class="hs-identifier hs-var">recoverHeadState</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451290"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="annot"><span class="annottext">HeadState
</span><a href="#local-6989586621679451309"><span class="hs-identifier hs-var">current</span></a></span><span> </span><span class="annot"><span class="annottext">NodeState Tx
</span><a href="#local-6989586621679451306"><span class="hs-identifier hs-var">checkpoint</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451311"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.HeadIsAborted</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-148"></span><span>      </span><span class="annot"><span class="annottext">HeadState -&gt; EventM Name HeadState ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">HeadState
</span><a href="Hydra.TUI.Model.html#Idle"><span class="hs-identifier hs-var">Idle</span></a></span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name HeadState ()
forall a. a -&gt; EventM Name HeadState a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><span class="annottext">LensLike' (Zoomed (EventM Name ActiveLink) ()) HeadState ActiveLink
-&gt; EventM Name ActiveLink () -&gt; EventM Name HeadState ()
forall c.
LensLike' (Zoomed (EventM Name ActiveLink) c) HeadState ActiveLink
-&gt; EventM Name ActiveLink c -&gt; EventM Name HeadState c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike' (Zoomed (EventM Name ActiveLink) ()) HeadState ActiveLink
(ActiveLink
 -&gt; Focusing (StateT (EventState Name) IO) () ActiveLink)
-&gt; HeadState -&gt; Focusing (StateT (EventState Name) IO) () HeadState
Traversal' HeadState ActiveLink
</span><a href="Hydra.TUI.Model.html#activeLinkL"><span class="hs-identifier hs-var">activeLinkL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name ActiveLink () -&gt; EventM Name HeadState ())
-&gt; EventM Name ActiveLink () -&gt; EventM Name HeadState ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">HydraEvent Tx -&gt; EventM Name ActiveLink ()
</span><a href="Hydra.TUI.Handlers.html#handleHydraEventsActiveLink"><span class="hs-identifier hs-var">handleHydraEventsActiveLink</span></a></span><span> </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="#local-6989586621679451291"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleHydraEventsActiveLink"><span class="hs-identifier hs-type">handleHydraEventsActiveLink</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hydra.Client.html#HydraEvent"><span class="hs-identifier hs-type">HydraEvent</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#ActiveLink"><span class="hs-identifier hs-type">ActiveLink</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span id="handleHydraEventsActiveLink"><span class="annot"><span class="annottext">handleHydraEventsActiveLink :: HydraEvent Tx -&gt; EventM Name ActiveLink ()
</span><a href="Hydra.TUI.Handlers.html#handleHydraEventsActiveLink"><span class="hs-identifier hs-var hs-var">handleHydraEventsActiveLink</span></a></span></span><span> </span><span id="local-6989586621679451316"><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="#local-6989586621679451316"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><a href="#local-6989586621679451316"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.Committed</span></span><span class="hs-special">{</span><span id="local-6989586621679451318"><span class="annot"><span class="annottext">Party
party :: Party
$sel:party:NetworkConnected :: forall tx. ServerOutput tx -&gt; Party
</span><a href="#local-6989586621679451318"><span class="hs-identifier hs-var hs-var">party</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451320"><span class="annot"><span class="annottext">UTxOType Tx
utxo :: UTxOType Tx
$sel:utxo:NetworkConnected :: forall tx. ServerOutput tx -&gt; UTxOType tx
</span><a href="#local-6989586621679451320"><span class="hs-identifier hs-var hs-var">utxo</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-156"></span><span>      </span><span class="annot"><span class="annottext">Party -&gt; UTxO -&gt; EventM Name ActiveLink ()
forall n. Party -&gt; UTxO -&gt; EventM n ActiveLink ()
</span><a href="Hydra.TUI.Handlers.html#partyCommitted"><span class="hs-identifier hs-var">partyCommitted</span></a></span><span> </span><span class="annot"><span class="annottext">Party
</span><a href="#local-6989586621679451318"><span class="hs-identifier hs-var">party</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO
UTxOType Tx
</span><a href="#local-6989586621679451320"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451323"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.HeadIsOpen</span></span><span class="hs-special">{</span><span id="local-6989586621679451325"><span class="annot"><span class="annottext">UTxOType Tx
$sel:utxo:NetworkConnected :: forall tx. ServerOutput tx -&gt; UTxOType tx
utxo :: UTxOType Tx
</span><span class="hs-identifier hs-var hs-var">utxo</span></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-158"></span><span>      </span><span class="annot"><span class="annottext">(ActiveHeadState -&gt; Identity ActiveHeadState)
-&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink ActiveHeadState
</span><a href="Hydra.TUI.Model.html#activeHeadStateL"><span class="hs-identifier hs-var">activeHeadStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((ActiveHeadState -&gt; Identity ActiveHeadState)
 -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; ActiveHeadState -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">OpenScreen -&gt; ActiveHeadState
</span><a href="Hydra.TUI.Model.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span> </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span>
</span><span id="line-159"></span><span>    </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451329"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.SnapshotConfirmed</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:snapshot:NetworkConnected :: forall tx. ServerOutput tx -&gt; Snapshot tx
</span><span class="hs-identifier hs-var">snapshot</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Snapshot</span></span><span class="hs-special">{</span><span id="local-6989586621679451333"><span class="annot"><span class="annottext">UTxOType Tx
utxo :: UTxOType Tx
$sel:utxo:Snapshot :: forall tx. Snapshot tx -&gt; UTxOType tx
</span><a href="#local-6989586621679451333"><span class="hs-identifier hs-var hs-var">utxo</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-160"></span><span>      </span><span class="annot"><span class="annottext">(UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink UTxO
</span><a href="Hydra.TUI.Model.html#utxoL"><span class="hs-identifier hs-var">utxoL</span></a></span><span> </span><span class="annot"><span class="annottext">((UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; UTxO -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">UTxO
UTxOType Tx
</span><a href="#local-6989586621679451333"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-161"></span><span>    </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451336"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.HeadIsClosed</span></span><span class="hs-special">{</span><span id="local-6989586621679451338"><span class="annot"><span class="annottext">HeadId
$sel:headId:NetworkConnected :: forall tx. ServerOutput tx -&gt; HeadId
headId :: HeadId
</span><span class="hs-identifier hs-var hs-var">headId</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451339"><span class="annot"><span class="annottext">SnapshotNumber
snapshotNumber :: SnapshotNumber
$sel:snapshotNumber:NetworkConnected :: forall tx. ServerOutput tx -&gt; SnapshotNumber
</span><a href="#local-6989586621679451339"><span class="hs-identifier hs-var hs-var">snapshotNumber</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451341"><span class="annot"><span class="annottext">UTCTime
contestationDeadline :: UTCTime
$sel:contestationDeadline:NetworkConnected :: forall tx. ServerOutput tx -&gt; UTCTime
</span><a href="#local-6989586621679451341"><span class="hs-identifier hs-var hs-var">contestationDeadline</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-162"></span><span>      </span><span class="annot"><span class="annottext">(ActiveHeadState -&gt; Identity ActiveHeadState)
-&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink ActiveHeadState
</span><a href="Hydra.TUI.Model.html#activeHeadStateL"><span class="hs-identifier hs-var">activeHeadStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((ActiveHeadState -&gt; Identity ActiveHeadState)
 -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; ActiveHeadState -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Closed"><span class="hs-identifier hs-type">Closed</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:closedState:Initializing :: ClosedState
</span><a href="#local-6989586621679451344"><span class="hs-identifier hs-var">closedState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#ClosedState"><span class="hs-identifier hs-type">ClosedState</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">UTCTime
contestationDeadline :: UTCTime
$sel:contestationDeadline:ClosedState :: UTCTime
</span><a href="#local-6989586621679451341"><span class="hs-identifier hs-var hs-var">contestationDeadline</span></a></span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451347"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.ReadyToFanout</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-164"></span><span>      </span><span class="annot"><span class="annottext">(ActiveHeadState -&gt; Identity ActiveHeadState)
-&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink ActiveHeadState
</span><a href="Hydra.TUI.Model.html#activeHeadStateL"><span class="hs-identifier hs-var">activeHeadStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((ActiveHeadState -&gt; Identity ActiveHeadState)
 -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; ActiveHeadState -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">ActiveHeadState
</span><a href="Hydra.TUI.Model.html#FanoutPossible"><span class="hs-identifier hs-var">FanoutPossible</span></a></span><span>
</span><span id="line-165"></span><span>    </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451350"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.HeadIsFinalized</span></span><span class="hs-special">{</span><span id="local-6989586621679451352"><span class="annot"><span class="annottext">UTxOType Tx
$sel:utxo:NetworkConnected :: forall tx. ServerOutput tx -&gt; UTxOType tx
utxo :: UTxOType Tx
</span><span class="hs-identifier hs-var hs-var">utxo</span></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-166"></span><span>      </span><span class="annot"><span class="annottext">(UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink UTxO
</span><a href="Hydra.TUI.Model.html#utxoL"><span class="hs-identifier hs-var">utxoL</span></a></span><span> </span><span class="annot"><span class="annottext">((UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; UTxO -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">UTxO
UTxOType Tx
</span><a href="#local-6989586621679451352"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-167"></span><span>      </span><span class="annot"><span class="annottext">(ActiveHeadState -&gt; Identity ActiveHeadState)
-&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink ActiveHeadState
</span><a href="Hydra.TUI.Model.html#activeHeadStateL"><span class="hs-identifier hs-var">activeHeadStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((ActiveHeadState -&gt; Identity ActiveHeadState)
 -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; ActiveHeadState -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">ActiveHeadState
</span><a href="Hydra.TUI.Model.html#Final"><span class="hs-identifier hs-var">Final</span></a></span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451354"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.DecommitRequested</span></span><span class="hs-special">{</span><span id="local-6989586621679451356"><span class="annot"><span class="annottext">UTxOType Tx
utxoToDecommit :: UTxOType Tx
$sel:utxoToDecommit:NetworkConnected :: forall tx. ServerOutput tx -&gt; UTxOType tx
</span><a href="#local-6989586621679451356"><span class="hs-identifier hs-var hs-var">utxoToDecommit</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-169"></span><span>      </span><span class="annot"><a href="Hydra.TUI.Model.html#ActiveLink"><span class="hs-identifier hs-type">ActiveLink</span></a></span><span class="hs-special">{</span><span id="local-6989586621679451359"><span class="annot"><span class="annottext">UTxO
utxo :: UTxO
$sel:utxo:ActiveLink :: ActiveLink -&gt; UTxO
</span><a href="#local-6989586621679451359"><span class="hs-identifier hs-var hs-var">utxo</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EventM Name ActiveLink ActiveLink
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-170"></span><span>      </span><span class="annot"><span class="annottext">(UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink UTxO
</span><a href="Hydra.TUI.Model.html#pendingUTxOToDecommitL"><span class="hs-identifier hs-var">pendingUTxOToDecommitL</span></a></span><span> </span><span class="annot"><span class="annottext">((UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; UTxO -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">UTxO
UTxOType Tx
</span><a href="#local-6989586621679451356"><span class="hs-identifier hs-var">utxoToDecommit</span></a></span><span>
</span><span id="line-171"></span><span>      </span><span class="annot"><span class="annottext">(UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink UTxO
</span><a href="Hydra.TUI.Model.html#utxoL"><span class="hs-identifier hs-var">utxoL</span></a></span><span> </span><span class="annot"><span class="annottext">((UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; UTxO -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">UTxO -&gt; UTxO -&gt; UTxO
forall out. UTxO' out -&gt; UTxO' out -&gt; UTxO' out
</span><span class="hs-identifier hs-var">UTxO.difference</span></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451359"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO
UTxOType Tx
</span><a href="#local-6989586621679451356"><span class="hs-identifier hs-var">utxoToDecommit</span></a></span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451363"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.DecommitFinalized</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-173"></span><span>      </span><span class="annot"><a href="Hydra.TUI.Model.html#ActiveLink"><span class="hs-identifier hs-type">ActiveLink</span></a></span><span class="hs-special">{</span><span id="local-6989586621679451365"><span class="annot"><span class="annottext">UTxO
$sel:utxo:ActiveLink :: ActiveLink -&gt; UTxO
utxo :: UTxO
</span><a href="Hydra.TUI.Model.html#%24sel%3Autxo%3AActiveLink"><span class="hs-identifier hs-var hs-var">utxo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451366"><span class="annot"><span class="annottext">UTxO
pendingUTxOToDecommit :: UTxO
$sel:pendingUTxOToDecommit:ActiveLink :: ActiveLink -&gt; UTxO
</span><a href="#local-6989586621679451366"><span class="hs-identifier hs-var hs-var">pendingUTxOToDecommit</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EventM Name ActiveLink ActiveLink
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-174"></span><span>      </span><span class="annot"><span class="annottext">(UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink UTxO
</span><a href="Hydra.TUI.Model.html#pendingUTxOToDecommitL"><span class="hs-identifier hs-var">pendingUTxOToDecommitL</span></a></span><span> </span><span class="annot"><span class="annottext">((UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; UTxO -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">UTxO
forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-175"></span><span>      </span><span class="annot"><span class="annottext">(UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink UTxO
</span><a href="Hydra.TUI.Model.html#utxoL"><span class="hs-identifier hs-var">utxoL</span></a></span><span> </span><span class="annot"><span class="annottext">((UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; UTxO -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451365"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451368"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.CommitRecorded</span></span><span class="hs-special">{</span><span id="local-6989586621679451370"><span class="annot"><span class="annottext">UTxOType Tx
utxoToCommit :: UTxOType Tx
$sel:utxoToCommit:NetworkConnected :: forall tx. ServerOutput tx -&gt; UTxOType tx
</span><a href="#local-6989586621679451370"><span class="hs-identifier hs-var hs-var">utxoToCommit</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451372"><span class="annot"><span class="annottext">TxIdType Tx
pendingDeposit :: TxIdType Tx
$sel:pendingDeposit:NetworkConnected :: forall tx. ServerOutput tx -&gt; TxIdType tx
</span><a href="#local-6989586621679451372"><span class="hs-identifier hs-var hs-var">pendingDeposit</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451374"><span class="annot"><span class="annottext">UTCTime
deadline :: UTCTime
$sel:deadline:NetworkConnected :: forall tx. ServerOutput tx -&gt; UTCTime
</span><a href="#local-6989586621679451374"><span class="hs-identifier hs-var hs-var">deadline</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-177"></span><span>      </span><span class="annot"><a href="Hydra.TUI.Model.html#ActiveLink"><span class="hs-identifier hs-type">ActiveLink</span></a></span><span class="hs-special">{</span><span id="local-6989586621679451376"><span class="annot"><span class="annottext">UTxO
$sel:utxo:ActiveLink :: ActiveLink -&gt; UTxO
utxo :: UTxO
</span><a href="Hydra.TUI.Model.html#%24sel%3Autxo%3AActiveLink"><span class="hs-identifier hs-var hs-var">utxo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451377"><span class="annot"><span class="annottext">[PendingIncrement]
pendingIncrements :: [PendingIncrement]
$sel:pendingIncrements:ActiveLink :: ActiveLink -&gt; [PendingIncrement]
</span><a href="#local-6989586621679451377"><span class="hs-identifier hs-var hs-var">pendingIncrements</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EventM Name ActiveLink ActiveLink
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-178"></span><span>      </span><span class="annot"><span class="annottext">([PendingIncrement] -&gt; Identity [PendingIncrement])
-&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink [PendingIncrement]
</span><a href="Hydra.TUI.Model.html#pendingIncrementsL"><span class="hs-identifier hs-var">pendingIncrementsL</span></a></span><span> </span><span class="annot"><span class="annottext">(([PendingIncrement] -&gt; Identity [PendingIncrement])
 -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; [PendingIncrement] -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">[PendingIncrement]
</span><a href="#local-6989586621679451377"><span class="hs-identifier hs-var">pendingIncrements</span></a></span><span> </span><span class="annot"><span class="annottext">[PendingIncrement] -&gt; [PendingIncrement] -&gt; [PendingIncrement]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">UTxO
-&gt; TxId -&gt; UTCTime -&gt; PendingIncrementStatus -&gt; PendingIncrement
</span><a href="Hydra.TUI.Model.html#PendingIncrement"><span class="hs-identifier hs-var">PendingIncrement</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO
UTxOType Tx
</span><a href="#local-6989586621679451370"><span class="hs-identifier hs-var">utxoToCommit</span></a></span><span> </span><span class="annot"><span class="annottext">TxId
TxIdType Tx
</span><a href="#local-6989586621679451372"><span class="hs-identifier hs-var">pendingDeposit</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451374"><span class="hs-identifier hs-var">deadline</span></a></span><span> </span><span class="annot"><span class="annottext">PendingIncrementStatus
</span><a href="Hydra.TUI.Model.html#PendingDeposit"><span class="hs-identifier hs-var">PendingDeposit</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-179"></span><span>      </span><span class="annot"><span class="annottext">(UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink UTxO
</span><a href="Hydra.TUI.Model.html#utxoL"><span class="hs-identifier hs-var">utxoL</span></a></span><span> </span><span class="annot"><span class="annottext">((UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; UTxO -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451376"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451382"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.CommitApproved</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:utxoToCommit:NetworkConnected :: forall tx. ServerOutput tx -&gt; UTxOType tx
</span><span class="hs-identifier hs-var">utxoToCommit</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679451384"><span class="annot"><span class="annottext">UTxOType Tx
</span><a href="#local-6989586621679451384"><span class="hs-identifier hs-var">approvedUtxoToCommit</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-181"></span><span>      </span><span class="annot"><a href="Hydra.TUI.Model.html#ActiveLink"><span class="hs-identifier hs-type">ActiveLink</span></a></span><span class="hs-special">{</span><span id="local-6989586621679451385"><span class="annot"><span class="annottext">UTxO
$sel:utxo:ActiveLink :: ActiveLink -&gt; UTxO
utxo :: UTxO
</span><a href="Hydra.TUI.Model.html#%24sel%3Autxo%3AActiveLink"><span class="hs-identifier hs-var hs-var">utxo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451386"><span class="annot"><span class="annottext">[PendingIncrement]
$sel:pendingIncrements:ActiveLink :: ActiveLink -&gt; [PendingIncrement]
pendingIncrements :: [PendingIncrement]
</span><a href="Hydra.TUI.Model.html#%24sel%3ApendingIncrements%3AActiveLink"><span class="hs-identifier hs-var hs-var">pendingIncrements</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EventM Name ActiveLink ActiveLink
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-182"></span><span>      </span><span class="annot"><span class="annottext">([PendingIncrement] -&gt; Identity [PendingIncrement])
-&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink [PendingIncrement]
</span><a href="Hydra.TUI.Model.html#pendingIncrementsL"><span class="hs-identifier hs-var">pendingIncrementsL</span></a></span><span>
</span><span id="line-183"></span><span>        </span><span class="annot"><span class="annottext">(([PendingIncrement] -&gt; Identity [PendingIncrement])
 -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; [PendingIncrement] -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">(PendingIncrement -&gt; PendingIncrement)
-&gt; [PendingIncrement] -&gt; [PendingIncrement]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span>
</span><span id="line-184"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679451387"><span class="annot"><span class="annottext">inc :: PendingIncrement
</span><a href="#local-6989586621679451387"><span class="hs-identifier hs-var">inc</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Hydra.TUI.Model.html#PendingIncrement"><span class="hs-identifier hs-type">PendingIncrement</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:utxoToCommit:PendingIncrement :: PendingIncrement -&gt; UTxO
</span><a href="Hydra.TUI.Model.html#%24sel%3AutxoToCommit%3APendingIncrement"><span class="hs-identifier hs-var">utxoToCommit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679451389"><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451389"><span class="hs-identifier hs-var">pendingUtxoToCommit</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451390"><span class="annot"><span class="annottext">TxId
deposit :: TxId
$sel:deposit:PendingIncrement :: PendingIncrement -&gt; TxId
</span><a href="#local-6989586621679451390"><span class="hs-identifier hs-var hs-var">deposit</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451392"><span class="annot"><span class="annottext">UTCTime
depositDeadline :: UTCTime
$sel:depositDeadline:PendingIncrement :: PendingIncrement -&gt; UTCTime
</span><a href="#local-6989586621679451392"><span class="hs-identifier hs-var hs-var">depositDeadline</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-185"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">UTxOType Tx -&gt; ByteString
forall tx. IsTx tx =&gt; UTxOType tx -&gt; ByteString
</span><span class="hs-identifier hs-var">hashUTxO</span></span><span> </span><span class="annot"><span class="annottext">UTxO
UTxOType Tx
</span><a href="#local-6989586621679451389"><span class="hs-identifier hs-var">pendingUtxoToCommit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">UTxOType Tx -&gt; ByteString
forall tx. IsTx tx =&gt; UTxOType tx -&gt; ByteString
</span><span class="hs-identifier hs-var">hashUTxO</span></span><span> </span><span class="annot"><span class="annottext">UTxOType Tx
</span><a href="#local-6989586621679451384"><span class="hs-identifier hs-var">approvedUtxoToCommit</span></a></span><span>
</span><span id="line-186"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">UTxO
-&gt; TxId -&gt; UTCTime -&gt; PendingIncrementStatus -&gt; PendingIncrement
</span><a href="Hydra.TUI.Model.html#PendingIncrement"><span class="hs-identifier hs-var">PendingIncrement</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451389"><span class="hs-identifier hs-var">pendingUtxoToCommit</span></a></span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621679451390"><span class="hs-identifier hs-var">deposit</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451392"><span class="hs-identifier hs-var">depositDeadline</span></a></span><span> </span><span class="annot"><span class="annottext">PendingIncrementStatus
</span><a href="Hydra.TUI.Model.html#FinalizingDeposit"><span class="hs-identifier hs-var">FinalizingDeposit</span></a></span><span>
</span><span id="line-187"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">PendingIncrement
</span><a href="#local-6989586621679451387"><span class="hs-identifier hs-var">inc</span></a></span><span>
</span><span id="line-188"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>          </span><span class="annot"><span class="annottext">[PendingIncrement]
</span><a href="#local-6989586621679451386"><span class="hs-identifier hs-var">pendingIncrements</span></a></span><span>
</span><span id="line-190"></span><span>      </span><span class="annot"><span class="annottext">(UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink UTxO
</span><a href="Hydra.TUI.Model.html#utxoL"><span class="hs-identifier hs-var">utxoL</span></a></span><span> </span><span class="annot"><span class="annottext">((UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; UTxO -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451385"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451396"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.CommitFinalized</span></span><span class="hs-special">{</span><span id="local-6989586621679451398"><span class="annot"><span class="annottext">TxIdType Tx
depositTxId :: TxIdType Tx
$sel:depositTxId:NetworkConnected :: forall tx. ServerOutput tx -&gt; TxIdType tx
</span><a href="#local-6989586621679451398"><span class="hs-identifier hs-var hs-var">depositTxId</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-192"></span><span>      </span><span class="annot"><a href="Hydra.TUI.Model.html#ActiveLink"><span class="hs-identifier hs-type">ActiveLink</span></a></span><span class="hs-special">{</span><span id="local-6989586621679451400"><span class="annot"><span class="annottext">UTxO
$sel:utxo:ActiveLink :: ActiveLink -&gt; UTxO
utxo :: UTxO
</span><a href="Hydra.TUI.Model.html#%24sel%3Autxo%3AActiveLink"><span class="hs-identifier hs-var hs-var">utxo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451401"><span class="annot"><span class="annottext">[PendingIncrement]
$sel:pendingIncrements:ActiveLink :: ActiveLink -&gt; [PendingIncrement]
pendingIncrements :: [PendingIncrement]
</span><a href="Hydra.TUI.Model.html#%24sel%3ApendingIncrements%3AActiveLink"><span class="hs-identifier hs-var hs-var">pendingIncrements</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EventM Name ActiveLink ActiveLink
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-193"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451402"><span class="annot"><span class="annottext">activePendingIncrements :: [PendingIncrement]
</span><a href="#local-6989586621679451402"><span class="hs-identifier hs-var hs-var">activePendingIncrements</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PendingIncrement -&gt; Bool)
-&gt; [PendingIncrement] -&gt; [PendingIncrement]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><a href="Hydra.TUI.Model.html#PendingIncrement"><span class="hs-identifier hs-type">PendingIncrement</span></a></span><span class="hs-special">{</span><span id="local-6989586621679451403"><span class="annot"><span class="annottext">TxId
$sel:deposit:PendingIncrement :: PendingIncrement -&gt; TxId
deposit :: TxId
</span><a href="Hydra.TUI.Model.html#%24sel%3Adeposit%3APendingIncrement"><span class="hs-identifier hs-var hs-var">deposit</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621679451403"><span class="hs-identifier hs-var">deposit</span></a></span><span> </span><span class="annot"><span class="annottext">TxId -&gt; TxId -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">TxId
TxIdType Tx
</span><a href="#local-6989586621679451398"><span class="hs-identifier hs-var">depositTxId</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PendingIncrement]
</span><a href="#local-6989586621679451401"><span class="hs-identifier hs-var">pendingIncrements</span></a></span><span>
</span><span id="line-194"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451404"><span class="annot"><span class="annottext">approvedIncrement :: Maybe PendingIncrement
</span><a href="#local-6989586621679451404"><span class="hs-identifier hs-var hs-var">approvedIncrement</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PendingIncrement -&gt; Bool)
-&gt; [PendingIncrement] -&gt; Maybe PendingIncrement
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Foldable.html#find"><span class="hs-identifier hs-var">find</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><a href="Hydra.TUI.Model.html#PendingIncrement"><span class="hs-identifier hs-type">PendingIncrement</span></a></span><span class="hs-special">{</span><span id="local-6989586621679451406"><span class="annot"><span class="annottext">TxId
$sel:deposit:PendingIncrement :: PendingIncrement -&gt; TxId
deposit :: TxId
</span><a href="Hydra.TUI.Model.html#%24sel%3Adeposit%3APendingIncrement"><span class="hs-identifier hs-var hs-var">deposit</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621679451406"><span class="hs-identifier hs-var">deposit</span></a></span><span> </span><span class="annot"><span class="annottext">TxId -&gt; TxId -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">TxId
TxIdType Tx
</span><a href="#local-6989586621679451398"><span class="hs-identifier hs-var">depositTxId</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PendingIncrement]
</span><a href="#local-6989586621679451401"><span class="hs-identifier hs-var">pendingIncrements</span></a></span><span>
</span><span id="line-195"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451407"><span class="annot"><span class="annottext">activeUtxoToCommit :: UTxO
</span><a href="#local-6989586621679451407"><span class="hs-identifier hs-var hs-var">activeUtxoToCommit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTxO
-&gt; (PendingIncrement -&gt; UTxO) -&gt; Maybe PendingIncrement -&gt; UTxO
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO
forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><a href="Hydra.TUI.Model.html#PendingIncrement"><span class="hs-identifier hs-type">PendingIncrement</span></a></span><span class="hs-special">{</span><span id="local-6989586621679451409"><span class="annot"><span class="annottext">UTxO
$sel:utxoToCommit:PendingIncrement :: PendingIncrement -&gt; UTxO
utxoToCommit :: UTxO
</span><a href="Hydra.TUI.Model.html#%24sel%3AutxoToCommit%3APendingIncrement"><span class="hs-identifier hs-var hs-var">utxoToCommit</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451409"><span class="hs-identifier hs-var">utxoToCommit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe PendingIncrement
</span><a href="#local-6989586621679451404"><span class="hs-identifier hs-var">approvedIncrement</span></a></span><span>
</span><span id="line-196"></span><span>      </span><span class="annot"><span class="annottext">([PendingIncrement] -&gt; Identity [PendingIncrement])
-&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink [PendingIncrement]
</span><a href="Hydra.TUI.Model.html#pendingIncrementsL"><span class="hs-identifier hs-var">pendingIncrementsL</span></a></span><span> </span><span class="annot"><span class="annottext">(([PendingIncrement] -&gt; Identity [PendingIncrement])
 -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; [PendingIncrement] -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">[PendingIncrement]
</span><a href="#local-6989586621679451402"><span class="hs-identifier hs-var">activePendingIncrements</span></a></span><span>
</span><span id="line-197"></span><span>      </span><span class="annot"><span class="annottext">(UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink UTxO
</span><a href="Hydra.TUI.Model.html#utxoL"><span class="hs-identifier hs-var">utxoL</span></a></span><span> </span><span class="annot"><span class="annottext">((UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; UTxO -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451400"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO -&gt; UTxO -&gt; UTxO
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451407"><span class="hs-identifier hs-var">activeUtxoToCommit</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451410"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.CommitRecovered</span></span><span class="hs-special">{</span><span id="local-6989586621679451412"><span class="annot"><span class="annottext">UTxOType Tx
recoveredUTxO :: UTxOType Tx
$sel:recoveredUTxO:NetworkConnected :: forall tx. ServerOutput tx -&gt; UTxOType tx
</span><a href="#local-6989586621679451412"><span class="hs-identifier hs-var hs-var">recoveredUTxO</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451414"><span class="annot"><span class="annottext">TxIdType Tx
recoveredTxId :: TxIdType Tx
$sel:recoveredTxId:NetworkConnected :: forall tx. ServerOutput tx -&gt; TxIdType tx
</span><a href="#local-6989586621679451414"><span class="hs-identifier hs-var hs-var">recoveredTxId</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-199"></span><span>      </span><span class="annot"><a href="Hydra.TUI.Model.html#ActiveLink"><span class="hs-identifier hs-type">ActiveLink</span></a></span><span class="hs-special">{</span><span id="local-6989586621679451416"><span class="annot"><span class="annottext">UTxO
$sel:utxo:ActiveLink :: ActiveLink -&gt; UTxO
utxo :: UTxO
</span><a href="Hydra.TUI.Model.html#%24sel%3Autxo%3AActiveLink"><span class="hs-identifier hs-var hs-var">utxo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451417"><span class="annot"><span class="annottext">[PendingIncrement]
$sel:pendingIncrements:ActiveLink :: ActiveLink -&gt; [PendingIncrement]
pendingIncrements :: [PendingIncrement]
</span><a href="Hydra.TUI.Model.html#%24sel%3ApendingIncrements%3AActiveLink"><span class="hs-identifier hs-var hs-var">pendingIncrements</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EventM Name ActiveLink ActiveLink
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-200"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451418"><span class="annot"><span class="annottext">activePendingIncrements :: [PendingIncrement]
</span><a href="#local-6989586621679451418"><span class="hs-identifier hs-var hs-var">activePendingIncrements</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PendingIncrement -&gt; Bool)
-&gt; [PendingIncrement] -&gt; [PendingIncrement]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><a href="Hydra.TUI.Model.html#PendingIncrement"><span class="hs-identifier hs-type">PendingIncrement</span></a></span><span class="hs-special">{</span><span id="local-6989586621679451419"><span class="annot"><span class="annottext">TxId
$sel:deposit:PendingIncrement :: PendingIncrement -&gt; TxId
deposit :: TxId
</span><a href="Hydra.TUI.Model.html#%24sel%3Adeposit%3APendingIncrement"><span class="hs-identifier hs-var hs-var">deposit</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621679451419"><span class="hs-identifier hs-var">deposit</span></a></span><span> </span><span class="annot"><span class="annottext">TxId -&gt; TxId -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">TxId
TxIdType Tx
</span><a href="#local-6989586621679451414"><span class="hs-identifier hs-var">recoveredTxId</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PendingIncrement]
</span><a href="#local-6989586621679451417"><span class="hs-identifier hs-var">pendingIncrements</span></a></span><span>
</span><span id="line-201"></span><span>      </span><span class="annot"><span class="annottext">([PendingIncrement] -&gt; Identity [PendingIncrement])
-&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink [PendingIncrement]
</span><a href="Hydra.TUI.Model.html#pendingIncrementsL"><span class="hs-identifier hs-var">pendingIncrementsL</span></a></span><span> </span><span class="annot"><span class="annottext">(([PendingIncrement] -&gt; Identity [PendingIncrement])
 -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; [PendingIncrement] -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">[PendingIncrement]
</span><a href="#local-6989586621679451418"><span class="hs-identifier hs-var">activePendingIncrements</span></a></span><span>
</span><span id="line-202"></span><span>      </span><span class="annot"><span class="annottext">(UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink UTxO
</span><a href="Hydra.TUI.Model.html#utxoL"><span class="hs-identifier hs-var">utxoL</span></a></span><span> </span><span class="annot"><span class="annottext">((UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; UTxO -&gt; EventM Name ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">UTxO -&gt; UTxO -&gt; UTxO
forall out. UTxO' out -&gt; UTxO' out -&gt; UTxO' out
</span><span class="hs-identifier hs-var">UTxO.difference</span></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451416"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO
UTxOType Tx
</span><a href="#local-6989586621679451412"><span class="hs-identifier hs-var">recoveredUTxO</span></a></span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name ActiveLink ()
forall a. a -&gt; EventM Name ActiveLink a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleHydraEventsInfo"><span class="hs-identifier hs-type">handleHydraEventsInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hydra.Client.html#HydraEvent"><span class="hs-identifier hs-type">HydraEvent</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hydra.TUI.Logging.Types.html#LogMessage"><span class="hs-identifier hs-type">LogMessage</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span id="handleHydraEventsInfo"><span class="annot"><span class="annottext">handleHydraEventsInfo :: HydraEvent Tx -&gt; EventM Name [LogMessage] ()
</span><a href="Hydra.TUI.Handlers.html#handleHydraEventsInfo"><span class="hs-identifier hs-var hs-var">handleHydraEventsInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-207"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451420"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ServerOutput Tx
</span><span class="hs-identifier hs-var">API.NetworkConnected</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><span class="annottext">Severity -&gt; UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. Severity -&gt; UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#report"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><a href="Hydra.TUI.Logging.Types.html#Success"><span class="hs-identifier hs-var">Success</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451420"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Network connected&quot;</span></span><span>
</span><span id="line-209"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451422"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ServerOutput Tx
</span><span class="hs-identifier hs-var">API.NetworkDisconnected</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><span class="annottext">Severity -&gt; UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. Severity -&gt; UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#report"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><a href="Hydra.TUI.Logging.Types.html#Error"><span class="hs-identifier hs-var">Error</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451422"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Network disconnected&quot;</span></span><span>
</span><span id="line-211"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451424"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.PeerConnected</span></span><span class="hs-special">{</span><span id="local-6989586621679451425"><span class="annot"><span class="annottext">Host
peer :: Host
$sel:peer:NetworkConnected :: forall tx. ServerOutput tx -&gt; Host
</span><a href="#local-6989586621679451425"><span class="hs-identifier hs-var hs-var">peer</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451424"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; EventM Name [LogMessage] ())
-&gt; Name -&gt; EventM Name [LogMessage] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Peer connected: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Host -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Host
</span><a href="#local-6989586621679451425"><span class="hs-identifier hs-var">peer</span></a></span><span>
</span><span id="line-213"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451428"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.PeerDisconnected</span></span><span class="hs-special">{</span><span id="local-6989586621679451429"><span class="annot"><span class="annottext">Host
$sel:peer:NetworkConnected :: forall tx. ServerOutput tx -&gt; Host
peer :: Host
</span><span class="hs-identifier hs-var hs-var">peer</span></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451428"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; EventM Name [LogMessage] ())
-&gt; Name -&gt; EventM Name [LogMessage] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Peer disconnected: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Host -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Host
</span><a href="#local-6989586621679451429"><span class="hs-identifier hs-var">peer</span></a></span><span>
</span><span id="line-215"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451430"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.HeadIsInitializing</span></span><span class="hs-special">{</span><span id="local-6989586621679451431"><span class="annot"><span class="annottext">[Party]
$sel:parties:NetworkConnected :: forall tx. ServerOutput tx -&gt; [Party]
parties :: [Party]
</span><span class="hs-identifier hs-var hs-var">parties</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451432"><span class="annot"><span class="annottext">HeadId
$sel:headId:NetworkConnected :: forall tx. ServerOutput tx -&gt; HeadId
headId :: HeadId
</span><span class="hs-identifier hs-var hs-var">headId</span></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451430"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Head is initializing&quot;</span></span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451433"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.Committed</span></span><span class="hs-special">{</span><span id="local-6989586621679451434"><span class="annot"><span class="annottext">Party
$sel:party:NetworkConnected :: forall tx. ServerOutput tx -&gt; Party
party :: Party
</span><span class="hs-identifier hs-var hs-var">party</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451435"><span class="annot"><span class="annottext">UTxOType Tx
$sel:utxo:NetworkConnected :: forall tx. ServerOutput tx -&gt; UTxOType tx
utxo :: UTxOType Tx
</span><span class="hs-identifier hs-var hs-var">utxo</span></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-218"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451433"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; EventM Name [LogMessage] ())
-&gt; Name -&gt; EventM Name [LogMessage] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Party -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Party
</span><a href="#local-6989586621679451434"><span class="hs-identifier hs-var">party</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot; committed &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Name
</span><span class="hs-identifier hs-var">renderValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tx. IsTx tx =&gt; UTxOType tx -&gt; ValueType tx
</span><span class="hs-identifier hs-var">balance</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><span class="annottext">UTxOType Tx
</span><a href="#local-6989586621679451435"><span class="hs-identifier hs-var">utxo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451437"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.HeadIsOpen</span></span><span class="hs-special">{</span><span id="local-6989586621679451438"><span class="annot"><span class="annottext">UTxOType Tx
$sel:utxo:NetworkConnected :: forall tx. ServerOutput tx -&gt; UTxOType tx
utxo :: UTxOType Tx
</span><span class="hs-identifier hs-var hs-var">utxo</span></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451437"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Head is now open!&quot;</span></span><span>
</span><span id="line-221"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451439"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.HeadIsAborted</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451439"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Head aborted, back to square one.&quot;</span></span><span>
</span><span id="line-223"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451440"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.SnapshotConfirmed</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:snapshot:NetworkConnected :: forall tx. ServerOutput tx -&gt; Snapshot tx
</span><span class="hs-identifier hs-var">snapshot</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Snapshot</span></span><span class="hs-special">{</span><span id="local-6989586621679451441"><span class="annot"><span class="annottext">SnapshotNumber
number :: SnapshotNumber
$sel:number:Snapshot :: forall tx. Snapshot tx -&gt; SnapshotNumber
</span><a href="#local-6989586621679451441"><span class="hs-identifier hs-var hs-var">number</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-224"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451440"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Snapshot #&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SnapshotNumber -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SnapshotNumber
</span><a href="#local-6989586621679451441"><span class="hs-identifier hs-var">number</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot; confirmed.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451443"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.SnapshotSideLoaded</span></span><span class="hs-special">{</span><span id="local-6989586621679451445"><span class="annot"><span class="annottext">SnapshotNumber
$sel:snapshotNumber:NetworkConnected :: forall tx. ServerOutput tx -&gt; SnapshotNumber
snapshotNumber :: SnapshotNumber
</span><span class="hs-identifier hs-var hs-var">snapshotNumber</span></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-226"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451443"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Snapshot #&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SnapshotNumber -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SnapshotNumber
</span><a href="#local-6989586621679451445"><span class="hs-identifier hs-var">snapshotNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot; side loaded.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiClientMessage"><span class="hs-identifier hs-type">ApiClientMessage</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.CommandFailed</span></span><span class="hs-special">{</span><span id="local-6989586621679451448"><span class="annot"><span class="annottext">ClientInput Tx
clientInput :: ClientInput Tx
$sel:clientInput:CommandFailed :: forall tx. ClientMessage tx -&gt; ClientInput tx
</span><a href="#local-6989586621679451448"><span class="hs-identifier hs-var hs-var">clientInput</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-228"></span><span>    </span><span id="local-6989586621679451450"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451450"><span class="hs-identifier hs-var">time</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO UTCTime -&gt; EventM Name [LogMessage] UTCTime
forall a. IO a -&gt; EventM Name [LogMessage] a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">IO UTCTime
forall (m :: * -&gt; *). MonadTime m =&gt; m UTCTime
</span><span class="hs-identifier hs-var">getCurrentTime</span></span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451450"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; EventM Name [LogMessage] ())
-&gt; Name -&gt; EventM Name [LogMessage] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Invalid command: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ClientInput Tx -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ClientInput Tx
</span><a href="#local-6989586621679451448"><span class="hs-identifier hs-var">clientInput</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451452"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.HeadIsClosed</span></span><span class="hs-special">{</span><span id="local-6989586621679451453"><span class="annot"><span class="annottext">SnapshotNumber
$sel:snapshotNumber:NetworkConnected :: forall tx. ServerOutput tx -&gt; SnapshotNumber
snapshotNumber :: SnapshotNumber
</span><span class="hs-identifier hs-var hs-var">snapshotNumber</span></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451452"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; EventM Name [LogMessage] ())
-&gt; Name -&gt; EventM Name [LogMessage] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Head closed with snapshot number &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SnapshotNumber -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SnapshotNumber
</span><a href="#local-6989586621679451453"><span class="hs-identifier hs-var">snapshotNumber</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451454"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.HeadIsContested</span></span><span class="hs-special">{</span><span id="local-6989586621679451456"><span class="annot"><span class="annottext">SnapshotNumber
$sel:snapshotNumber:NetworkConnected :: forall tx. ServerOutput tx -&gt; SnapshotNumber
snapshotNumber :: SnapshotNumber
</span><span class="hs-identifier hs-var hs-var">snapshotNumber</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451457"><span class="annot"><span class="annottext">UTCTime
$sel:contestationDeadline:NetworkConnected :: forall tx. ServerOutput tx -&gt; UTCTime
contestationDeadline :: UTCTime
</span><span class="hs-identifier hs-var hs-var">contestationDeadline</span></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-233"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451454"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Head contested with snapshot number &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SnapshotNumber -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SnapshotNumber
</span><a href="#local-6989586621679451456"><span class="hs-identifier hs-var">snapshotNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot; and deadline &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451457"><span class="hs-identifier hs-var">contestationDeadline</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451458"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.TxValid</span></span><span class="hs-special">{</span><span id="local-6989586621679451460"><span class="annot"><span class="annottext">TxIdType Tx
transactionId :: TxIdType Tx
$sel:transactionId:NetworkConnected :: forall tx. ServerOutput tx -&gt; TxIdType tx
</span><a href="#local-6989586621679451460"><span class="hs-identifier hs-var hs-var">transactionId</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-235"></span><span>    </span><span class="annot"><span class="annottext">Severity -&gt; UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. Severity -&gt; UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#report"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><a href="Hydra.TUI.Logging.Types.html#Success"><span class="hs-identifier hs-var">Success</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451458"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Transaction &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxId -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">TxId
TxIdType Tx
</span><a href="#local-6989586621679451460"><span class="hs-identifier hs-var">transactionId</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot; submitted successfully&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451462"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.TxInvalid</span></span><span class="hs-special">{</span><span id="local-6989586621679451464"><span class="annot"><span class="annottext">Tx
transaction :: Tx
$sel:transaction:NetworkConnected :: forall tx. ServerOutput tx -&gt; tx
</span><a href="#local-6989586621679451464"><span class="hs-identifier hs-var hs-var">transaction</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451466"><span class="annot"><span class="annottext">ValidationError
validationError :: ValidationError
$sel:validationError:NetworkConnected :: forall tx. ServerOutput tx -&gt; ValidationError
</span><a href="#local-6989586621679451466"><span class="hs-identifier hs-var hs-var">validationError</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-237"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451462"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Transaction &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxId -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tx -&gt; TxIdType Tx
forall tx. IsTx tx =&gt; tx -&gt; TxIdType tx
</span><span class="hs-identifier hs-var">txId</span></span><span> </span><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679451464"><span class="hs-identifier hs-var">transaction</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot; is not applicable: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationError -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ValidationError
</span><a href="#local-6989586621679451466"><span class="hs-identifier hs-var">validationError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451469"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.DecommitApproved</span></span><span class="hs-special">{</span><span id="local-6989586621679451471"><span class="annot"><span class="annottext">TxIdType Tx
decommitTxId :: TxIdType Tx
$sel:decommitTxId:NetworkConnected :: forall tx. ServerOutput tx -&gt; TxIdType tx
</span><a href="#local-6989586621679451471"><span class="hs-identifier hs-var hs-var">decommitTxId</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451473"><span class="annot"><span class="annottext">UTxOType Tx
$sel:utxoToDecommit:NetworkConnected :: forall tx. ServerOutput tx -&gt; UTxOType tx
utxoToDecommit :: UTxOType Tx
</span><span class="hs-identifier hs-var hs-var">utxoToDecommit</span></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-239"></span><span>    </span><span class="annot"><span class="annottext">Severity -&gt; UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. Severity -&gt; UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#report"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><a href="Hydra.TUI.Logging.Types.html#Success"><span class="hs-identifier hs-var">Success</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451469"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; EventM Name [LogMessage] ())
-&gt; Name -&gt; EventM Name [LogMessage] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-240"></span><span>      </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Decommit approved and submitted to Cardano &quot;</span></span><span>
</span><span id="line-241"></span><span>        </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxId -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">TxId
TxIdType Tx
</span><a href="#local-6989586621679451471"><span class="hs-identifier hs-var">decommitTxId</span></a></span><span>
</span><span id="line-242"></span><span>        </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-243"></span><span>        </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">((TxIn, TxOut CtxUTxO) -&gt; Name) -&gt; [(TxIn, TxOut CtxUTxO)] -&gt; Name
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO) -&gt; Name
forall ctx era. (TxIn, TxOut ctx era) -&gt; Name
</span><span class="hs-identifier hs-var">UTxO.render</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxO -&gt; [(TxIn, TxOut CtxUTxO)]
forall out. UTxO' out -&gt; [(TxIn, out)]
</span><span class="hs-identifier hs-var">UTxO.toList</span></span><span> </span><span class="annot"><span class="annottext">UTxO
UTxOType Tx
</span><a href="#local-6989586621679451473"><span class="hs-identifier hs-var">utxoToDecommit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451477"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.DecommitFinalized</span></span><span class="hs-special">{</span><span id="local-6989586621679451478"><span class="annot"><span class="annottext">UTxOType Tx
distributedUTxO :: UTxOType Tx
$sel:distributedUTxO:NetworkConnected :: forall tx. ServerOutput tx -&gt; UTxOType tx
</span><a href="#local-6989586621679451478"><span class="hs-identifier hs-var hs-var">distributedUTxO</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><span class="annottext">Severity -&gt; UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. Severity -&gt; UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#report"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><a href="Hydra.TUI.Logging.Types.html#Success"><span class="hs-identifier hs-var">Success</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451477"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; EventM Name [LogMessage] ())
-&gt; Name -&gt; EventM Name [LogMessage] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-246"></span><span>      </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Decommit finalized &quot;</span></span><span>
</span><span id="line-247"></span><span>        </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UTxO
UTxOType Tx
</span><a href="#local-6989586621679451478"><span class="hs-identifier hs-var">distributedUTxO</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451480"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.DecommitInvalid</span></span><span class="hs-special">{</span><span id="local-6989586621679451482"><span class="annot"><span class="annottext">Tx
decommitTx :: Tx
$sel:decommitTx:NetworkConnected :: forall tx. ServerOutput tx -&gt; tx
</span><a href="#local-6989586621679451482"><span class="hs-identifier hs-var hs-var">decommitTx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451484"><span class="annot"><span class="annottext">DecommitInvalidReason Tx
decommitInvalidReason :: DecommitInvalidReason Tx
$sel:decommitInvalidReason:NetworkConnected :: forall tx. ServerOutput tx -&gt; DecommitInvalidReason tx
</span><a href="#local-6989586621679451484"><span class="hs-identifier hs-var hs-var">decommitInvalidReason</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451480"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; EventM Name [LogMessage] ())
-&gt; Name -&gt; EventM Name [LogMessage] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-250"></span><span>      </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Decommit Transaction with id &quot;</span></span><span>
</span><span id="line-251"></span><span>        </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxId -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tx -&gt; TxIdType Tx
forall tx. IsTx tx =&gt; tx -&gt; TxIdType tx
</span><span class="hs-identifier hs-var">txId</span></span><span> </span><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679451482"><span class="hs-identifier hs-var">decommitTx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>        </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot; is not applicable: &quot;</span></span><span>
</span><span id="line-253"></span><span>        </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">DecommitInvalidReason Tx -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">DecommitInvalidReason Tx
</span><a href="#local-6989586621679451484"><span class="hs-identifier hs-var">decommitInvalidReason</span></a></span><span>
</span><span id="line-254"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451486"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.CommitRecorded</span></span><span class="hs-special">{</span><span id="local-6989586621679451487"><span class="annot"><span class="annottext">UTxOType Tx
$sel:utxoToCommit:NetworkConnected :: forall tx. ServerOutput tx -&gt; UTxOType tx
utxoToCommit :: UTxOType Tx
</span><span class="hs-identifier hs-var hs-var">utxoToCommit</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451488"><span class="annot"><span class="annottext">TxIdType Tx
$sel:pendingDeposit:NetworkConnected :: forall tx. ServerOutput tx -&gt; TxIdType tx
pendingDeposit :: TxIdType Tx
</span><span class="hs-identifier hs-var hs-var">pendingDeposit</span></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><span class="annottext">Severity -&gt; UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. Severity -&gt; UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#report"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><a href="Hydra.TUI.Logging.Types.html#Success"><span class="hs-identifier hs-var">Success</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451486"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; EventM Name [LogMessage] ())
-&gt; Name -&gt; EventM Name [LogMessage] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-256"></span><span>      </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Commit deposit recorded with &quot;</span></span><span>
</span><span id="line-257"></span><span>        </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot; deposit tx id &quot;</span></span><span>
</span><span id="line-258"></span><span>        </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxId -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">TxId
TxIdType Tx
</span><a href="#local-6989586621679451488"><span class="hs-identifier hs-var">pendingDeposit</span></a></span><span>
</span><span id="line-259"></span><span>        </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;and pending for approval &quot;</span></span><span>
</span><span id="line-260"></span><span>        </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">((TxIn, TxOut CtxUTxO) -&gt; Name) -&gt; [(TxIn, TxOut CtxUTxO)] -&gt; Name
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO) -&gt; Name
forall ctx era. (TxIn, TxOut ctx era) -&gt; Name
</span><span class="hs-identifier hs-var">UTxO.render</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxO -&gt; [(TxIn, TxOut CtxUTxO)]
forall out. UTxO' out -&gt; [(TxIn, out)]
</span><span class="hs-identifier hs-var">UTxO.toList</span></span><span> </span><span class="annot"><span class="annottext">UTxO
UTxOType Tx
</span><a href="#local-6989586621679451487"><span class="hs-identifier hs-var">utxoToCommit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451489"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.CommitApproved</span></span><span class="hs-special">{</span><span id="local-6989586621679451490"><span class="annot"><span class="annottext">UTxOType Tx
$sel:utxoToCommit:NetworkConnected :: forall tx. ServerOutput tx -&gt; UTxOType tx
utxoToCommit :: UTxOType Tx
</span><span class="hs-identifier hs-var hs-var">utxoToCommit</span></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-262"></span><span>    </span><span class="annot"><span class="annottext">Severity -&gt; UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. Severity -&gt; UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#report"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><a href="Hydra.TUI.Logging.Types.html#Success"><span class="hs-identifier hs-var">Success</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451489"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; EventM Name [LogMessage] ())
-&gt; Name -&gt; EventM Name [LogMessage] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-263"></span><span>      </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Commit approved and submitted to Cardano &quot;</span></span><span>
</span><span id="line-264"></span><span>        </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">((TxIn, TxOut CtxUTxO) -&gt; Name) -&gt; [(TxIn, TxOut CtxUTxO)] -&gt; Name
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO) -&gt; Name
forall ctx era. (TxIn, TxOut ctx era) -&gt; Name
</span><span class="hs-identifier hs-var">UTxO.render</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxO -&gt; [(TxIn, TxOut CtxUTxO)]
forall out. UTxO' out -&gt; [(TxIn, out)]
</span><span class="hs-identifier hs-var">UTxO.toList</span></span><span> </span><span class="annot"><span class="annottext">UTxO
UTxOType Tx
</span><a href="#local-6989586621679451490"><span class="hs-identifier hs-var">utxoToCommit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451491"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.CommitRecovered</span></span><span class="hs-special">{</span><span id="local-6989586621679451492"><span class="annot"><span class="annottext">TxIdType Tx
$sel:recoveredTxId:NetworkConnected :: forall tx. ServerOutput tx -&gt; TxIdType tx
recoveredTxId :: TxIdType Tx
</span><span class="hs-identifier hs-var hs-var">recoveredTxId</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451493"><span class="annot"><span class="annottext">UTxOType Tx
$sel:recoveredUTxO:NetworkConnected :: forall tx. ServerOutput tx -&gt; UTxOType tx
recoveredUTxO :: UTxOType Tx
</span><span class="hs-identifier hs-var hs-var">recoveredUTxO</span></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-266"></span><span>    </span><span class="annot"><span class="annottext">Severity -&gt; UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. Severity -&gt; UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#report"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><a href="Hydra.TUI.Logging.Types.html#Success"><span class="hs-identifier hs-var">Success</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451491"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; EventM Name [LogMessage] ())
-&gt; Name -&gt; EventM Name [LogMessage] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-267"></span><span>      </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Commit recovered &quot;</span></span><span>
</span><span id="line-268"></span><span>        </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxId -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">TxId
TxIdType Tx
</span><a href="#local-6989586621679451492"><span class="hs-identifier hs-var">recoveredTxId</span></a></span><span>
</span><span id="line-269"></span><span>        </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-270"></span><span>        </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">((TxIn, TxOut CtxUTxO) -&gt; Name) -&gt; [(TxIn, TxOut CtxUTxO)] -&gt; Name
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO) -&gt; Name
forall ctx era. (TxIn, TxOut ctx era) -&gt; Name
</span><span class="hs-identifier hs-var">UTxO.render</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxO -&gt; [(TxIn, TxOut CtxUTxO)]
forall out. UTxO' out -&gt; [(TxIn, out)]
</span><span class="hs-identifier hs-var">UTxO.toList</span></span><span> </span><span class="annot"><span class="annottext">UTxO
UTxOType Tx
</span><a href="#local-6989586621679451493"><span class="hs-identifier hs-var">recoveredUTxO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451494"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.CommitFinalized</span></span><span class="hs-special">{</span><span id="local-6989586621679451495"><span class="annot"><span class="annottext">TxIdType Tx
$sel:depositTxId:NetworkConnected :: forall tx. ServerOutput tx -&gt; TxIdType tx
depositTxId :: TxIdType Tx
</span><span class="hs-identifier hs-var hs-var">depositTxId</span></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-272"></span><span>    </span><span class="annot"><span class="annottext">Severity -&gt; UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. Severity -&gt; UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#report"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><a href="Hydra.TUI.Logging.Types.html#Success"><span class="hs-identifier hs-var">Success</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451494"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; EventM Name [LogMessage] ())
-&gt; Name -&gt; EventM Name [LogMessage] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-273"></span><span>      </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Commit finalized &quot;</span></span><span>
</span><span id="line-274"></span><span>        </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxId -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">TxId
TxIdType Tx
</span><a href="#local-6989586621679451495"><span class="hs-identifier hs-var">depositTxId</span></a></span><span>
</span><span id="line-275"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451496"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.HeadIsFinalized</span></span><span class="hs-special">{</span><span id="local-6989586621679451497"><span class="annot"><span class="annottext">UTxOType Tx
$sel:utxo:NetworkConnected :: forall tx. ServerOutput tx -&gt; UTxOType tx
utxo :: UTxOType Tx
</span><span class="hs-identifier hs-var hs-var">utxo</span></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451496"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Head is finalized&quot;</span></span><span>
</span><span id="line-277"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiInvalidInput"><span class="hs-identifier hs-type">ApiInvalidInput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.InvalidInput</span></span><span class="hs-special">{</span><span id="local-6989586621679451500"><span class="annot"><span class="annottext">String
reason :: String
$sel:reason:InvalidInput :: InvalidInput -&gt; String
</span><a href="#local-6989586621679451500"><span class="hs-identifier hs-var hs-var">reason</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-278"></span><span>    </span><span id="local-6989586621679451502"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451502"><span class="hs-identifier hs-var">time</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO UTCTime -&gt; EventM Name [LogMessage] UTCTime
forall a. IO a -&gt; EventM Name [LogMessage] a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">IO UTCTime
forall (m :: * -&gt; *). MonadTime m =&gt; m UTCTime
</span><span class="hs-identifier hs-var">getCurrentTime</span></span><span>
</span><span id="line-279"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451502"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Invalid input error: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
forall a. ToText a =&gt; a -&gt; Name
</span><span class="hs-identifier hs-var">toText</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679451500"><span class="hs-identifier hs-var">reason</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiClientMessage"><span class="hs-identifier hs-type">ApiClientMessage</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.PostTxOnChainFailed</span></span><span class="hs-special">{</span><span id="local-6989586621679451505"><span class="annot"><span class="annottext">PostTxError Tx
postTxError :: PostTxError Tx
$sel:postTxError:CommandFailed :: forall tx. ClientMessage tx -&gt; PostTxError tx
</span><a href="#local-6989586621679451505"><span class="hs-identifier hs-var hs-var">postTxError</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-281"></span><span>    </span><span id="local-6989586621679451507"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451507"><span class="hs-identifier hs-var">time</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO UTCTime -&gt; EventM Name [LogMessage] UTCTime
forall a. IO a -&gt; EventM Name [LogMessage] a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">IO UTCTime
forall (m :: * -&gt; *). MonadTime m =&gt; m UTCTime
</span><span class="hs-identifier hs-var">getCurrentTime</span></span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PostTxError Tx
</span><a href="#local-6989586621679451505"><span class="hs-identifier hs-var">postTxError</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-283"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">NotEnoughFuel</span></span><span> </span><span class="annot"><span class="annottext">Tx
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-284"></span><span>        </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451507"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Not enough Fuel. Please provide more to the internal wallet and try again.&quot;</span></span><span>
</span><span id="line-285"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">InternalWalletError</span></span><span class="hs-special">{</span><span id="local-6989586621679451508"><span class="annot"><span class="annottext">Name
$sel:reason:NoSeedInput :: forall tx. PostTxError tx -&gt; Name
reason :: Name
</span><span class="hs-identifier hs-var hs-var">reason</span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-286"></span><span>        </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451507"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679451508"><span class="hs-identifier hs-var">reason</span></a></span><span>
</span><span id="line-287"></span><span>      </span><span class="annot"><span class="annottext">PostTxError Tx
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451507"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;An error happened while trying to post a transaction on-chain: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PostTxError Tx -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">PostTxError Tx
</span><a href="#local-6989586621679451505"><span class="hs-identifier hs-var">postTxError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>  </span><span class="annot"><a href="Hydra.Client.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Client.html#ApiTimedServerOutput"><span class="hs-identifier hs-type">ApiTimedServerOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimedServerOutput</span></span><span class="hs-special">{</span><span id="local-6989586621679451509"><span class="annot"><span class="annottext">UTCTime
$sel:time:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; UTCTime
time :: UTCTime
</span><span class="hs-identifier hs-var hs-var">time</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:output:TimedServerOutput :: forall tx. TimedServerOutput tx -&gt; ServerOutput tx
</span><span class="hs-identifier hs-var">output</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">API.EventLogRotated</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-289"></span><span>    </span><span class="annot"><span class="annottext">UTCTime -&gt; Name -&gt; EventM Name [LogMessage] ()
forall n. UTCTime -&gt; Name -&gt; EventM n [LogMessage] ()
</span><a href="Hydra.TUI.Logging.Handlers.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679451509"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Checkpoint triggered: head state event log rotated&quot;</span></span><span>
</span><span id="line-290"></span><span>  </span><span class="annot"><span class="annottext">HydraEvent Tx
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name [LogMessage] ()
forall a. a -&gt; EventM Name [LogMessage] a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span id="local-6989586621679450453"><span class="annot"><a href="Hydra.TUI.Handlers.html#partyCommitted"><span class="hs-identifier hs-type">partyCommitted</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Party</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="#local-6989586621679450453"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#ActiveLink"><span class="hs-identifier hs-type">ActiveLink</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-293"></span><span id="partyCommitted"><span class="annot"><span class="annottext">partyCommitted :: forall n. Party -&gt; UTxO -&gt; EventM n ActiveLink ()
</span><a href="Hydra.TUI.Handlers.html#partyCommitted"><span class="hs-identifier hs-var hs-var">partyCommitted</span></a></span></span><span> </span><span id="local-6989586621679451524"><span class="annot"><span class="annottext">Party
</span><a href="#local-6989586621679451524"><span class="hs-identifier hs-var">party</span></a></span></span><span> </span><span id="local-6989586621679451525"><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451525"><span class="hs-identifier hs-var">commit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-294"></span><span>  </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM n InitializingState) ())
  ActiveLink
  InitializingState
-&gt; EventM n InitializingState () -&gt; EventM n ActiveLink ()
forall c.
LensLike'
  (Zoomed (EventM n InitializingState) c)
  ActiveLink
  InitializingState
-&gt; EventM n InitializingState c -&gt; EventM n ActiveLink c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ActiveHeadState
 -&gt; Zoomed (EventM n InitializingState) () ActiveHeadState)
-&gt; ActiveLink -&gt; Zoomed (EventM n InitializingState) () ActiveLink
Lens' ActiveLink ActiveHeadState
</span><a href="Hydra.TUI.Model.html#activeHeadStateL"><span class="hs-identifier hs-var">activeHeadStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((ActiveHeadState
  -&gt; Zoomed (EventM n InitializingState) () ActiveHeadState)
 -&gt; ActiveLink -&gt; Zoomed (EventM n InitializingState) () ActiveLink)
-&gt; ((InitializingState
     -&gt; Zoomed (EventM n InitializingState) () InitializingState)
    -&gt; ActiveHeadState
    -&gt; Zoomed (EventM n InitializingState) () ActiveHeadState)
-&gt; LensLike'
     (Zoomed (EventM n InitializingState) ())
     ActiveLink
     InitializingState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(InitializingState
 -&gt; Zoomed (EventM n InitializingState) () InitializingState)
-&gt; ActiveHeadState
-&gt; Zoomed (EventM n InitializingState) () ActiveHeadState
Traversal' ActiveHeadState InitializingState
</span><a href="Hydra.TUI.Model.html#initializingStateL"><span class="hs-identifier hs-var">initializingStateL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(EventM n InitializingState () -&gt; EventM n ActiveLink ())
-&gt; EventM n InitializingState () -&gt; EventM n ActiveLink ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><span class="annottext">([Party] -&gt; Identity [Party])
-&gt; InitializingState -&gt; Identity InitializingState
Lens' InitializingState [Party]
</span><a href="Hydra.TUI.Model.html#remainingPartiesL"><span class="hs-identifier hs-var">remainingPartiesL</span></a></span><span> </span><span class="annot"><span class="annottext">(([Party] -&gt; Identity [Party])
 -&gt; InitializingState -&gt; Identity InitializingState)
-&gt; ([Party] -&gt; [Party]) -&gt; EventM n InitializingState ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; (a -&gt; b) -&gt; m ()
</span><span class="hs-operator hs-var">%=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Party] -&gt; [Party] -&gt; [Party]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.OldList.html#%5C%5C"><span class="hs-operator hs-var">\\</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Party
</span><a href="#local-6989586621679451524"><span class="hs-identifier hs-var">party</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>  </span><span class="annot"><span class="annottext">(UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink
Lens' ActiveLink UTxO
</span><a href="Hydra.TUI.Model.html#utxoL"><span class="hs-identifier hs-var">utxoL</span></a></span><span> </span><span class="annot"><span class="annottext">((UTxO -&gt; Identity UTxO) -&gt; ActiveLink -&gt; Identity ActiveLink)
-&gt; (UTxO -&gt; UTxO) -&gt; EventM n ActiveLink ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; (a -&gt; b) -&gt; m ()
</span><span class="hs-operator hs-var">%=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxO -&gt; UTxO -&gt; UTxO
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451525"><span class="hs-identifier hs-var">commit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="annot"><span class="hs-comment">-- * VtyEvent handlers</span></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleVtyEventsHeadState"><span class="hs-identifier hs-type">handleVtyEventsHeadState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoClient</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Client.html#Client"><span class="hs-identifier hs-type">Client</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vty.Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#HeadState"><span class="hs-identifier hs-type">HeadState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span id="handleVtyEventsHeadState"><span class="annot"><span class="annottext">handleVtyEventsHeadState :: CardanoClient -&gt; Client Tx IO -&gt; Event -&gt; EventM Name HeadState ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsHeadState"><span class="hs-identifier hs-var hs-var">handleVtyEventsHeadState</span></a></span></span><span> </span><span id="local-6989586621679451528"><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679451528"><span class="hs-identifier hs-var">cardanoClient</span></a></span></span><span> </span><span id="local-6989586621679451529"><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451529"><span class="hs-identifier hs-var">hydraClient</span></a></span></span><span> </span><span id="local-6989586621679451530"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451530"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-302"></span><span>  </span><span id="local-6989586621679451531"><span class="annot"><span class="annottext">HeadState
</span><a href="#local-6989586621679451531"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting HeadState HeadState HeadState
-&gt; EventM Name HeadState HeadState
forall s (m :: * -&gt; *) a. MonadState s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">use</span></span><span> </span><span class="annot"><span class="annottext">Getting HeadState HeadState HeadState
forall a. a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HeadState
</span><a href="#local-6989586621679451531"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-304"></span><span>    </span><span class="annot"><span class="annottext">HeadState
</span><a href="Hydra.TUI.Model.html#Idle"><span class="hs-identifier hs-var">Idle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451530"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-305"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'i'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; EventM Name HeadState ()
forall a. IO a -&gt; EventM Name HeadState a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Client Tx IO -&gt; ClientInput Tx -&gt; IO ()
forall tx (m :: * -&gt; *). Client tx m -&gt; ClientInput tx -&gt; m ()
</span><a href="Hydra.Client.html#sendInput"><span class="hs-identifier hs-var">sendInput</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451529"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">ClientInput Tx
forall tx. ClientInput tx
</span><span class="hs-identifier hs-var">Init</span></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>      </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name HeadState ()
forall a. a -&gt; EventM Name HeadState a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>    </span><span class="annot"><span class="annottext">HeadState
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name HeadState ()
forall a. a -&gt; EventM Name HeadState a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>  </span><span class="annot"><span class="annottext">LensLike' (Zoomed (EventM Name ActiveLink) ()) HeadState ActiveLink
-&gt; EventM Name ActiveLink () -&gt; EventM Name HeadState ()
forall c.
LensLike' (Zoomed (EventM Name ActiveLink) c) HeadState ActiveLink
-&gt; EventM Name ActiveLink c -&gt; EventM Name HeadState c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike' (Zoomed (EventM Name ActiveLink) ()) HeadState ActiveLink
(ActiveLink
 -&gt; Focusing (StateT (EventState Name) IO) () ActiveLink)
-&gt; HeadState -&gt; Focusing (StateT (EventState Name) IO) () HeadState
Traversal' HeadState ActiveLink
</span><a href="Hydra.TUI.Model.html#activeLinkL"><span class="hs-identifier hs-var">activeLinkL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name ActiveLink () -&gt; EventM Name HeadState ())
-&gt; EventM Name ActiveLink () -&gt; EventM Name HeadState ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient -&gt; Client Tx IO -&gt; Event -&gt; EventM Name ActiveLink ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsActiveLink"><span class="hs-identifier hs-var">handleVtyEventsActiveLink</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679451528"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451529"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451530"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleVtyEventsActiveLink"><span class="hs-identifier hs-type">handleVtyEventsActiveLink</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoClient</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Client.html#Client"><span class="hs-identifier hs-type">Client</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vty.Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#ActiveLink"><span class="hs-identifier hs-type">ActiveLink</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span id="handleVtyEventsActiveLink"><span class="annot"><span class="annottext">handleVtyEventsActiveLink :: CardanoClient -&gt; Client Tx IO -&gt; Event -&gt; EventM Name ActiveLink ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsActiveLink"><span class="hs-identifier hs-var hs-var">handleVtyEventsActiveLink</span></a></span></span><span> </span><span id="local-6989586621679451536"><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679451536"><span class="hs-identifier hs-var">cardanoClient</span></a></span></span><span> </span><span id="local-6989586621679451537"><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451537"><span class="hs-identifier hs-var">hydraClient</span></a></span></span><span> </span><span id="local-6989586621679451538"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451538"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-312"></span><span>  </span><span id="local-6989586621679451539"><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451539"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting UTxO ActiveLink UTxO -&gt; EventM Name ActiveLink UTxO
forall s (m :: * -&gt; *) a. MonadState s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">use</span></span><span> </span><span class="annot"><span class="annottext">Getting UTxO ActiveLink UTxO
Lens' ActiveLink UTxO
</span><a href="Hydra.TUI.Model.html#utxoL"><span class="hs-identifier hs-var">utxoL</span></a></span><span>
</span><span id="line-313"></span><span>  </span><span id="local-6989586621679451540"><span class="annot"><span class="annottext">[PendingIncrement]
</span><a href="#local-6989586621679451540"><span class="hs-identifier hs-var">pendingIncrements</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting [PendingIncrement] ActiveLink [PendingIncrement]
-&gt; EventM Name ActiveLink [PendingIncrement]
forall s (m :: * -&gt; *) a. MonadState s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">use</span></span><span> </span><span class="annot"><span class="annottext">Getting [PendingIncrement] ActiveLink [PendingIncrement]
Lens' ActiveLink [PendingIncrement]
</span><a href="Hydra.TUI.Model.html#pendingIncrementsL"><span class="hs-identifier hs-var">pendingIncrementsL</span></a></span><span>
</span><span id="line-314"></span><span>  </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name ActiveHeadState) ())
  ActiveLink
  ActiveHeadState
-&gt; EventM Name ActiveHeadState () -&gt; EventM Name ActiveLink ()
forall c.
LensLike'
  (Zoomed (EventM Name ActiveHeadState) c) ActiveLink ActiveHeadState
-&gt; EventM Name ActiveHeadState c -&gt; EventM Name ActiveLink c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name ActiveHeadState) ())
  ActiveLink
  ActiveHeadState
(ActiveHeadState
 -&gt; Focusing (StateT (EventState Name) IO) () ActiveHeadState)
-&gt; ActiveLink
-&gt; Focusing (StateT (EventState Name) IO) () ActiveLink
Lens' ActiveLink ActiveHeadState
</span><a href="Hydra.TUI.Model.html#activeHeadStateL"><span class="hs-identifier hs-var">activeHeadStateL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name ActiveHeadState () -&gt; EventM Name ActiveLink ())
-&gt; EventM Name ActiveHeadState () -&gt; EventM Name ActiveLink ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient
-&gt; Client Tx IO
-&gt; UTxO
-&gt; [PendingIncrement]
-&gt; Event
-&gt; EventM Name ActiveHeadState ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsActiveHeadState"><span class="hs-identifier hs-var">handleVtyEventsActiveHeadState</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679451536"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451537"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451539"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">[PendingIncrement]
</span><a href="#local-6989586621679451540"><span class="hs-identifier hs-var">pendingIncrements</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451538"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleVtyEventsActiveHeadState"><span class="hs-identifier hs-type">handleVtyEventsActiveHeadState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoClient</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Client.html#Client"><span class="hs-identifier hs-type">Client</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hydra.TUI.Model.html#PendingIncrement"><span class="hs-identifier hs-type">PendingIncrement</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vty.Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#ActiveHeadState"><span class="hs-identifier hs-type">ActiveHeadState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span id="handleVtyEventsActiveHeadState"><span class="annot"><span class="annottext">handleVtyEventsActiveHeadState :: CardanoClient
-&gt; Client Tx IO
-&gt; UTxO
-&gt; [PendingIncrement]
-&gt; Event
-&gt; EventM Name ActiveHeadState ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsActiveHeadState"><span class="hs-identifier hs-var hs-var">handleVtyEventsActiveHeadState</span></a></span></span><span> </span><span id="local-6989586621679451542"><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679451542"><span class="hs-identifier hs-var">cardanoClient</span></a></span></span><span> </span><span id="local-6989586621679451543"><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451543"><span class="hs-identifier hs-var">hydraClient</span></a></span></span><span> </span><span id="local-6989586621679451544"><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451544"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span id="local-6989586621679451545"><span class="annot"><span class="annottext">[PendingIncrement]
</span><a href="#local-6989586621679451545"><span class="hs-identifier hs-var">pendingIncrements</span></a></span></span><span> </span><span id="local-6989586621679451546"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451546"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-318"></span><span>  </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name InitializingScreen) ())
  ActiveHeadState
  InitializingScreen
-&gt; EventM Name InitializingScreen ()
-&gt; EventM Name ActiveHeadState ()
forall c.
LensLike'
  (Zoomed (EventM Name InitializingScreen) c)
  ActiveHeadState
  InitializingScreen
-&gt; EventM Name InitializingScreen c
-&gt; EventM Name ActiveHeadState c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(InitializingState
 -&gt; Focusing (StateT (EventState Name) IO) () InitializingState)
-&gt; ActiveHeadState
-&gt; Focusing (StateT (EventState Name) IO) () ActiveHeadState
Traversal' ActiveHeadState InitializingState
</span><a href="Hydra.TUI.Model.html#initializingStateL"><span class="hs-identifier hs-var">initializingStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((InitializingState
  -&gt; Focusing (StateT (EventState Name) IO) () InitializingState)
 -&gt; ActiveHeadState
 -&gt; Focusing (StateT (EventState Name) IO) () ActiveHeadState)
-&gt; ((InitializingScreen
     -&gt; Focusing (StateT (EventState Name) IO) () InitializingScreen)
    -&gt; InitializingState
    -&gt; Focusing (StateT (EventState Name) IO) () InitializingState)
-&gt; (InitializingScreen
    -&gt; Focusing (StateT (EventState Name) IO) () InitializingScreen)
-&gt; ActiveHeadState
-&gt; Focusing (StateT (EventState Name) IO) () ActiveHeadState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(InitializingScreen
 -&gt; Focusing (StateT (EventState Name) IO) () InitializingScreen)
-&gt; InitializingState
-&gt; Focusing (StateT (EventState Name) IO) () InitializingState
Lens' InitializingState InitializingScreen
</span><a href="Hydra.TUI.Model.html#initializingScreenL"><span class="hs-identifier hs-var">initializingScreenL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(EventM Name InitializingScreen ()
 -&gt; EventM Name ActiveHeadState ())
-&gt; EventM Name InitializingScreen ()
-&gt; EventM Name ActiveHeadState ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient
-&gt; Client Tx IO -&gt; Event -&gt; EventM Name InitializingScreen ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsInitializingScreen"><span class="hs-identifier hs-var">handleVtyEventsInitializingScreen</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679451542"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451543"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451546"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-319"></span><span>  </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name OpenScreen) ()) ActiveHeadState OpenScreen
-&gt; EventM Name OpenScreen () -&gt; EventM Name ActiveHeadState ()
forall c.
LensLike'
  (Zoomed (EventM Name OpenScreen) c) ActiveHeadState OpenScreen
-&gt; EventM Name OpenScreen c -&gt; EventM Name ActiveHeadState c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name OpenScreen) ()) ActiveHeadState OpenScreen
(OpenScreen
 -&gt; Focusing (StateT (EventState Name) IO) () OpenScreen)
-&gt; ActiveHeadState
-&gt; Focusing (StateT (EventState Name) IO) () ActiveHeadState
Traversal' ActiveHeadState OpenScreen
</span><a href="Hydra.TUI.Model.html#openStateL"><span class="hs-identifier hs-var">openStateL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name OpenScreen () -&gt; EventM Name ActiveHeadState ())
-&gt; EventM Name OpenScreen () -&gt; EventM Name ActiveHeadState ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient
-&gt; Client Tx IO
-&gt; UTxO
-&gt; [PendingIncrement]
-&gt; Event
-&gt; EventM Name OpenScreen ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsOpen"><span class="hs-identifier hs-var">handleVtyEventsOpen</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679451542"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451543"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451544"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">[PendingIncrement]
</span><a href="#local-6989586621679451545"><span class="hs-identifier hs-var">pendingIncrements</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451546"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-320"></span><span>  </span><span id="local-6989586621679451551"><span class="annot"><span class="annottext">ActiveHeadState
</span><a href="#local-6989586621679451551"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting ActiveHeadState ActiveHeadState ActiveHeadState
-&gt; EventM Name ActiveHeadState ActiveHeadState
forall s (m :: * -&gt; *) a. MonadState s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">use</span></span><span> </span><span class="annot"><span class="annottext">Getting ActiveHeadState ActiveHeadState ActiveHeadState
forall a. a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ActiveHeadState
</span><a href="#local-6989586621679451551"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><span class="annottext">ActiveHeadState
</span><a href="Hydra.TUI.Model.html#FanoutPossible"><span class="hs-identifier hs-var">FanoutPossible</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Client Tx IO -&gt; Event -&gt; EventM Name ActiveHeadState ()
forall s. Client Tx IO -&gt; Event -&gt; EventM Name s ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsFanoutPossible"><span class="hs-identifier hs-var">handleVtyEventsFanoutPossible</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451543"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451546"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-323"></span><span>    </span><span class="annot"><span class="annottext">ActiveHeadState
</span><a href="Hydra.TUI.Model.html#Final"><span class="hs-identifier hs-var">Final</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Client Tx IO -&gt; Event -&gt; EventM Name ActiveHeadState ()
forall s. Client Tx IO -&gt; Event -&gt; EventM Name s ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsFinal"><span class="hs-identifier hs-var">handleVtyEventsFinal</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451543"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451546"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-324"></span><span>    </span><span class="annot"><span class="annottext">ActiveHeadState
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name ActiveHeadState ()
forall a. a -&gt; EventM Name ActiveHeadState a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleVtyEventsInitializingScreen"><span class="hs-identifier hs-type">handleVtyEventsInitializingScreen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoClient</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Client.html#Client"><span class="hs-identifier hs-type">Client</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vty.Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#InitializingScreen"><span class="hs-identifier hs-type">InitializingScreen</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span id="handleVtyEventsInitializingScreen"><span class="annot"><span class="annottext">handleVtyEventsInitializingScreen :: CardanoClient
-&gt; Client Tx IO -&gt; Event -&gt; EventM Name InitializingScreen ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsInitializingScreen"><span class="hs-identifier hs-var hs-var">handleVtyEventsInitializingScreen</span></a></span></span><span> </span><span id="local-6989586621679451554"><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679451554"><span class="hs-identifier hs-var">cardanoClient</span></a></span></span><span> </span><span id="local-6989586621679451555"><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451555"><span class="hs-identifier hs-var">hydraClient</span></a></span></span><span> </span><span id="local-6989586621679451556"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451556"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451556"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-329"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-330"></span><span>      </span><span class="annot"><span class="annottext">InitializingScreen -&gt; EventM Name InitializingScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">(InitializingScreen -&gt; EventM Name InitializingScreen ())
-&gt; InitializingScreen -&gt; EventM Name InitializingScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Form Bool (HydraEvent Tx) Name -&gt; InitializingScreen
</span><a href="Hydra.TUI.Model.html#ConfirmingAbort"><span class="hs-identifier hs-var">ConfirmingAbort</span></a></span><span> </span><span class="annot"><span class="annottext">Form Bool (HydraEvent Tx) Name
forall s e n. (s ~ Bool, n ~ Name) =&gt; Form s e n
</span><a href="Hydra.TUI.Forms.html#confirmRadioField"><span class="hs-identifier hs-var">confirmRadioField</span></a></span><span>
</span><span id="line-331"></span><span>    </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name InitializingScreen ()
forall a. a -&gt; EventM Name InitializingScreen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>  </span><span id="local-6989586621679451559"><span class="annot"><span class="annottext">InitializingScreen
</span><a href="#local-6989586621679451559"><span class="hs-identifier hs-var">initializingScreen</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting InitializingScreen InitializingScreen InitializingScreen
-&gt; EventM Name InitializingScreen InitializingScreen
forall s (m :: * -&gt; *) a. MonadState s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">use</span></span><span> </span><span class="annot"><span class="annottext">Getting InitializingScreen InitializingScreen InitializingScreen
forall a. a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-333"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">InitializingScreen
</span><a href="#local-6989586621679451559"><span class="hs-identifier hs-var">initializingScreen</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-334"></span><span>    </span><span class="annot"><span class="annottext">InitializingScreen
</span><a href="Hydra.TUI.Model.html#InitializingHome"><span class="hs-identifier hs-var">InitializingHome</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451556"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-335"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'c'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-336"></span><span>        </span><span id="local-6989586621679451561"><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451561"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO UTxO -&gt; EventM Name InitializingScreen UTxO
forall a. IO a -&gt; EventM Name InitializingScreen a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO UTxO -&gt; EventM Name InitializingScreen UTxO)
-&gt; IO UTxO -&gt; EventM Name InitializingScreen UTxO
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient -&gt; [Address ShelleyAddr] -&gt; IO UTxO
</span><span class="hs-identifier hs-var">queryUTxOByAddress</span></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679451554"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CardanoClient -&gt; Client Tx IO -&gt; Address ShelleyAddr
</span><a href="Hydra.TUI.Handlers.html#mkMyAddress"><span class="hs-identifier hs-var">mkMyAddress</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679451554"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451555"><span class="hs-identifier hs-var">hydraClient</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-337"></span><span>        </span><span class="annot"><span class="annottext">InitializingScreen -&gt; EventM Name InitializingScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">(InitializingScreen -&gt; EventM Name InitializingScreen ())
-&gt; InitializingScreen -&gt; EventM Name InitializingScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name
-&gt; InitializingScreen
</span><a href="Hydra.TUI.Model.html#CommitMenu"><span class="hs-identifier hs-var">CommitMenu</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO)
-&gt; Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name
forall s e n.
(s ~ Map TxIn (TxOut CtxUTxO, Bool), n ~ Name) =&gt;
Map TxIn (TxOut CtxUTxO) -&gt; Form s e n
</span><a href="Hydra.TUI.Forms.html#utxoCheckboxField"><span class="hs-identifier hs-var">utxoCheckboxField</span></a></span><span> </span><span class="annot"><span class="annottext">(Map TxIn (TxOut CtxUTxO)
 -&gt; Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name)
-&gt; Map TxIn (TxOut CtxUTxO)
-&gt; Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO -&gt; Map TxIn (TxOut CtxUTxO)
forall out. UTxO' out -&gt; Map TxIn out
</span><span class="hs-identifier hs-var">UTxO.toMap</span></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451561"><span class="hs-identifier hs-var">utxo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>      </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name InitializingScreen ()
forall a. a -&gt; EventM Name InitializingScreen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>    </span><span class="annot"><a href="Hydra.TUI.Model.html#CommitMenu"><span class="hs-identifier hs-type">CommitMenu</span></a></span><span> </span><span id="local-6989586621679451567"><span class="annot"><span class="annottext">Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name
</span><a href="#local-6989586621679451567"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-340"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451556"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-341"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEsc</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InitializingScreen -&gt; EventM Name InitializingScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">InitializingScreen
</span><a href="Hydra.TUI.Model.html#InitializingHome"><span class="hs-identifier hs-var">InitializingHome</span></a></span><span>
</span><span id="line-342"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEnter</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-343"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451570"><span class="annot"><span class="annottext">u :: Map TxIn (TxOut CtxUTxO, Bool)
</span><a href="#local-6989586621679451570"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name
-&gt; Map TxIn (TxOut CtxUTxO, Bool)
forall s e n. Form s e n -&gt; s
</span><span class="hs-identifier hs-var">formState</span></span><span> </span><span class="annot"><span class="annottext">Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name
</span><a href="#local-6989586621679451567"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-344"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451571"><span class="annot"><span class="annottext">commitUTxO :: UTxO
</span><a href="#local-6989586621679451571"><span class="hs-identifier hs-var hs-var">commitUTxO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO) -&gt; UTxO
forall out. Map TxIn out -&gt; UTxO' out
</span><span class="hs-identifier hs-var">UTxO</span></span><span> </span><span class="annot"><span class="annottext">(Map TxIn (TxOut CtxUTxO) -&gt; UTxO)
-&gt; Map TxIn (TxOut CtxUTxO) -&gt; UTxO
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((TxOut CtxUTxO, Bool) -&gt; Maybe (TxOut CtxUTxO))
-&gt; Map TxIn (TxOut CtxUTxO, Bool) -&gt; Map TxIn (TxOut CtxUTxO)
forall a b k. (a -&gt; Maybe b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#mapMaybe"><span class="hs-identifier hs-var">Map.mapMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679451574"><span class="annot"><span class="annottext">TxOut CtxUTxO
</span><a href="#local-6989586621679451574"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451575"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679451575"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679451575"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO -&gt; Maybe (TxOut CtxUTxO)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO
</span><a href="#local-6989586621679451574"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe (TxOut CtxUTxO)
forall a. Maybe a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO, Bool)
</span><a href="#local-6989586621679451570"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-345"></span><span>          </span><span class="annot"><span class="annottext">IO () -&gt; EventM Name InitializingScreen ()
forall a. IO a -&gt; EventM Name InitializingScreen a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; EventM Name InitializingScreen ())
-&gt; IO () -&gt; EventM Name InitializingScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO -&gt; UTxO -&gt; IO ()
forall tx (m :: * -&gt; *). Client tx m -&gt; UTxO -&gt; m ()
</span><a href="Hydra.Client.html#externalCommit"><span class="hs-identifier hs-var">externalCommit</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451555"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451571"><span class="hs-identifier hs-var">commitUTxO</span></a></span><span>
</span><span id="line-346"></span><span>          </span><span class="annot"><span class="annottext">InitializingScreen -&gt; EventM Name InitializingScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">InitializingScreen
</span><a href="Hydra.TUI.Model.html#InitializingHome"><span class="hs-identifier hs-var">InitializingHome</span></a></span><span>
</span><span id="line-347"></span><span>        </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name InitializingScreen ()
forall a. a -&gt; EventM Name InitializingScreen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>      </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed
     (EventM
        Name (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name))
     ())
  InitializingScreen
  (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name)
-&gt; EventM
     Name
     (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name)
     ()
-&gt; EventM Name InitializingScreen ()
forall c.
LensLike'
  (Zoomed
     (EventM
        Name (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name))
     c)
  InitializingScreen
  (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name)
-&gt; EventM
     Name (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name) c
-&gt; EventM Name InitializingScreen c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed
     (EventM
        Name (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name))
     ())
  InitializingScreen
  (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name)
(Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name
 -&gt; Focusing
      (StateT (EventState Name) IO)
      ()
      (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name))
-&gt; InitializingScreen
-&gt; Focusing (StateT (EventState Name) IO) () InitializingScreen
Traversal'
  InitializingScreen
  (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name)
</span><a href="Hydra.TUI.Model.html#commitMenuL"><span class="hs-identifier hs-var">commitMenuL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM
   Name
   (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name)
   ()
 -&gt; EventM Name InitializingScreen ())
-&gt; EventM
     Name
     (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name)
     ()
-&gt; EventM Name InitializingScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
-&gt; EventM
     Name
     (Form (Map TxIn (TxOut CtxUTxO, Bool)) (HydraEvent Tx) Name)
     ()
forall n e s. Eq n =&gt; BrickEvent n e -&gt; EventM n (Form s e n) ()
</span><span class="hs-identifier hs-var">handleFormEvent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Event -&gt; BrickEvent Name (HydraEvent Tx)
forall n e. Event -&gt; BrickEvent n e
</span><span class="hs-identifier hs-var">VtyEvent</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451556"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>    </span><span class="annot"><a href="Hydra.TUI.Model.html#ConfirmingAbort"><span class="hs-identifier hs-type">ConfirmingAbort</span></a></span><span> </span><span id="local-6989586621679451578"><span class="annot"><span class="annottext">Form Bool (HydraEvent Tx) Name
</span><a href="#local-6989586621679451578"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-350"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451556"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-351"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEsc</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InitializingScreen -&gt; EventM Name InitializingScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">InitializingScreen
</span><a href="Hydra.TUI.Model.html#InitializingHome"><span class="hs-identifier hs-var">InitializingHome</span></a></span><span>
</span><span id="line-352"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEnter</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-353"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451579"><span class="annot"><span class="annottext">selected :: Bool
</span><a href="#local-6989586621679451579"><span class="hs-identifier hs-var hs-var">selected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form Bool (HydraEvent Tx) Name -&gt; Bool
forall s e n. Form s e n -&gt; s
</span><span class="hs-identifier hs-var">formState</span></span><span> </span><span class="annot"><span class="annottext">Form Bool (HydraEvent Tx) Name
</span><a href="#local-6989586621679451578"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-354"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679451579"><span class="hs-identifier hs-var">selected</span></a></span><span>
</span><span id="line-355"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; EventM Name InitializingScreen ()
forall a. IO a -&gt; EventM Name InitializingScreen a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; EventM Name InitializingScreen ())
-&gt; IO () -&gt; EventM Name InitializingScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO -&gt; ClientInput Tx -&gt; IO ()
forall tx (m :: * -&gt; *). Client tx m -&gt; ClientInput tx -&gt; m ()
</span><a href="Hydra.Client.html#sendInput"><span class="hs-identifier hs-var">sendInput</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451555"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">ClientInput Tx
forall tx. ClientInput tx
</span><span class="hs-identifier hs-var">Abort</span></span><span>
</span><span id="line-356"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">InitializingScreen -&gt; EventM Name InitializingScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">InitializingScreen
</span><a href="Hydra.TUI.Model.html#InitializingHome"><span class="hs-identifier hs-var">InitializingHome</span></a></span><span>
</span><span id="line-357"></span><span>        </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name InitializingScreen ()
forall a. a -&gt; EventM Name InitializingScreen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>      </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name (Form Bool (HydraEvent Tx) Name)) ())
  InitializingScreen
  (Form Bool (HydraEvent Tx) Name)
-&gt; EventM Name (Form Bool (HydraEvent Tx) Name) ()
-&gt; EventM Name InitializingScreen ()
forall c.
LensLike'
  (Zoomed (EventM Name (Form Bool (HydraEvent Tx) Name)) c)
  InitializingScreen
  (Form Bool (HydraEvent Tx) Name)
-&gt; EventM Name (Form Bool (HydraEvent Tx) Name) c
-&gt; EventM Name InitializingScreen c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name (Form Bool (HydraEvent Tx) Name)) ())
  InitializingScreen
  (Form Bool (HydraEvent Tx) Name)
(Form Bool (HydraEvent Tx) Name
 -&gt; Focusing
      (StateT (EventState Name) IO) () (Form Bool (HydraEvent Tx) Name))
-&gt; InitializingScreen
-&gt; Focusing (StateT (EventState Name) IO) () InitializingScreen
Traversal' InitializingScreen (Form Bool (HydraEvent Tx) Name)
</span><a href="Hydra.TUI.Model.html#confirmingAbortFormL"><span class="hs-identifier hs-var">confirmingAbortFormL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name (Form Bool (HydraEvent Tx) Name) ()
 -&gt; EventM Name InitializingScreen ())
-&gt; EventM Name (Form Bool (HydraEvent Tx) Name) ()
-&gt; EventM Name InitializingScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
-&gt; EventM Name (Form Bool (HydraEvent Tx) Name) ()
forall n e s. Eq n =&gt; BrickEvent n e -&gt; EventM n (Form s e n) ()
</span><span class="hs-identifier hs-var">handleFormEvent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Event -&gt; BrickEvent Name (HydraEvent Tx)
forall n e. Event -&gt; BrickEvent n e
</span><span class="hs-identifier hs-var">VtyEvent</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451556"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleVtyEventsOpen"><span class="hs-identifier hs-type">handleVtyEventsOpen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoClient</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Client.html#Client"><span class="hs-identifier hs-type">Client</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hydra.TUI.Model.html#PendingIncrement"><span class="hs-identifier hs-type">PendingIncrement</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vty.Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#OpenScreen"><span class="hs-identifier hs-type">OpenScreen</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span id="handleVtyEventsOpen"><span class="annot"><span class="annottext">handleVtyEventsOpen :: CardanoClient
-&gt; Client Tx IO
-&gt; UTxO
-&gt; [PendingIncrement]
-&gt; Event
-&gt; EventM Name OpenScreen ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsOpen"><span class="hs-identifier hs-var hs-var">handleVtyEventsOpen</span></a></span></span><span> </span><span id="local-6989586621679451582"><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679451582"><span class="hs-identifier hs-var">cardanoClient</span></a></span></span><span> </span><span id="local-6989586621679451583"><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451583"><span class="hs-identifier hs-var">hydraClient</span></a></span></span><span> </span><span id="local-6989586621679451584"><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451584"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span id="local-6989586621679451585"><span class="annot"><span class="annottext">[PendingIncrement]
</span><a href="#local-6989586621679451585"><span class="hs-identifier hs-var">pendingIncrements</span></a></span></span><span> </span><span id="local-6989586621679451586"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451586"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-362"></span><span>  </span><span class="annot"><span class="annottext">EventM Name OpenScreen OpenScreen
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">EventM Name OpenScreen OpenScreen
-&gt; (OpenScreen -&gt; EventM Name OpenScreen ())
-&gt; EventM Name OpenScreen ()
forall a b.
EventM Name OpenScreen a
-&gt; (a -&gt; EventM Name OpenScreen b) -&gt; EventM Name OpenScreen b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-363"></span><span>    </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-364"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451586"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-365"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'n'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-366"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451587"><span class="annot"><span class="annottext">utxo' :: Map TxIn (TxOut CtxUTxO)
</span><a href="#local-6989586621679451587"><span class="hs-identifier hs-var hs-var">utxo'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NetworkId
-&gt; VerificationKey PaymentKey -&gt; UTxO -&gt; Map TxIn (TxOut CtxUTxO)
</span><a href="Hydra.TUI.Handlers.html#myAvailableUTxO"><span class="hs-identifier hs-var">myAvailableUTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoClient -&gt; NetworkId
</span><span class="hs-identifier hs-var">networkId</span></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679451582"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SigningKey PaymentKey -&gt; VerificationKey PaymentKey
forall keyrole.
(Key keyrole, HasTypeProxy keyrole) =&gt;
SigningKey keyrole -&gt; VerificationKey keyrole
</span><span class="hs-identifier hs-var">getVerificationKey</span></span><span> </span><span class="annot"><span class="annottext">(SigningKey PaymentKey -&gt; VerificationKey PaymentKey)
-&gt; SigningKey PaymentKey -&gt; VerificationKey PaymentKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO -&gt; SigningKey PaymentKey
forall tx (m :: * -&gt; *). Client tx m -&gt; SigningKey PaymentKey
</span><a href="Hydra.Client.html#sk"><span class="hs-identifier hs-var">sk</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451583"><span class="hs-identifier hs-var">hydraClient</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451584"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-367"></span><span>          </span><span class="annot"><span class="annottext">OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">(OpenScreen -&gt; EventM Name OpenScreen ())
-&gt; OpenScreen -&gt; EventM Name OpenScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name -&gt; OpenScreen
</span><a href="Hydra.TUI.Model.html#SelectingUTxO"><span class="hs-identifier hs-var">SelectingUTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO)
-&gt; Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
forall s e n.
(s ~ (TxIn, TxOut CtxUTxO), n ~ Name) =&gt;
Map TxIn (TxOut CtxUTxO) -&gt; Form s e n
</span><a href="Hydra.TUI.Forms.html#utxoRadioField"><span class="hs-identifier hs-var">utxoRadioField</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO)
</span><a href="#local-6989586621679451587"><span class="hs-identifier hs-var">utxo'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'d'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-369"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451594"><span class="annot"><span class="annottext">utxo' :: Map TxIn (TxOut CtxUTxO)
</span><a href="#local-6989586621679451594"><span class="hs-identifier hs-var hs-var">utxo'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NetworkId
-&gt; VerificationKey PaymentKey -&gt; UTxO -&gt; Map TxIn (TxOut CtxUTxO)
</span><a href="Hydra.TUI.Handlers.html#myAvailableUTxO"><span class="hs-identifier hs-var">myAvailableUTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoClient -&gt; NetworkId
</span><span class="hs-identifier hs-var">networkId</span></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679451582"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SigningKey PaymentKey -&gt; VerificationKey PaymentKey
forall keyrole.
(Key keyrole, HasTypeProxy keyrole) =&gt;
SigningKey keyrole -&gt; VerificationKey keyrole
</span><span class="hs-identifier hs-var">getVerificationKey</span></span><span> </span><span class="annot"><span class="annottext">(SigningKey PaymentKey -&gt; VerificationKey PaymentKey)
-&gt; SigningKey PaymentKey -&gt; VerificationKey PaymentKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO -&gt; SigningKey PaymentKey
forall tx (m :: * -&gt; *). Client tx m -&gt; SigningKey PaymentKey
</span><a href="Hydra.Client.html#sk"><span class="hs-identifier hs-var">sk</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451583"><span class="hs-identifier hs-var">hydraClient</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451584"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-370"></span><span>          </span><span class="annot"><span class="annottext">OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">(OpenScreen -&gt; EventM Name OpenScreen ())
-&gt; OpenScreen -&gt; EventM Name OpenScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name -&gt; OpenScreen
</span><a href="Hydra.TUI.Model.html#SelectingUTxOToDecommit"><span class="hs-identifier hs-var">SelectingUTxOToDecommit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO)
-&gt; Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
forall s e n.
(s ~ (TxIn, TxOut CtxUTxO), n ~ Name) =&gt;
Map TxIn (TxOut CtxUTxO) -&gt; Form s e n
</span><a href="Hydra.TUI.Forms.html#utxoRadioField"><span class="hs-identifier hs-var">utxoRadioField</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO)
</span><a href="#local-6989586621679451594"><span class="hs-identifier hs-var">utxo'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'i'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-372"></span><span>          </span><span id="local-6989586621679451596"><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451596"><span class="hs-identifier hs-var">utxo'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO UTxO -&gt; EventM Name OpenScreen UTxO
forall a. IO a -&gt; EventM Name OpenScreen a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO UTxO -&gt; EventM Name OpenScreen UTxO)
-&gt; IO UTxO -&gt; EventM Name OpenScreen UTxO
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient -&gt; [Address ShelleyAddr] -&gt; IO UTxO
</span><span class="hs-identifier hs-var">queryUTxOByAddress</span></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679451582"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CardanoClient -&gt; Client Tx IO -&gt; Address ShelleyAddr
</span><a href="Hydra.TUI.Handlers.html#mkMyAddress"><span class="hs-identifier hs-var">mkMyAddress</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679451582"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451583"><span class="hs-identifier hs-var">hydraClient</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-373"></span><span>          </span><span class="annot"><span class="annottext">OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">(OpenScreen -&gt; EventM Name OpenScreen ())
-&gt; OpenScreen -&gt; EventM Name OpenScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name -&gt; OpenScreen
</span><a href="Hydra.TUI.Model.html#SelectingUTxOToIncrement"><span class="hs-identifier hs-var">SelectingUTxOToIncrement</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO)
-&gt; Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
forall s e n.
(s ~ (TxIn, TxOut CtxUTxO), n ~ Name) =&gt;
Map TxIn (TxOut CtxUTxO) -&gt; Form s e n
</span><a href="Hydra.TUI.Forms.html#utxoRadioField"><span class="hs-identifier hs-var">utxoRadioField</span></a></span><span> </span><span class="annot"><span class="annottext">(Map TxIn (TxOut CtxUTxO)
 -&gt; Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)
-&gt; Map TxIn (TxOut CtxUTxO)
-&gt; Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO -&gt; Map TxIn (TxOut CtxUTxO)
forall out. UTxO' out -&gt; Map TxIn out
</span><span class="hs-identifier hs-var">UTxO.toMap</span></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451596"><span class="hs-identifier hs-var">utxo'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'r'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-375"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451598"><span class="annot"><span class="annottext">pendingDepositIds :: [(TxId, UTxO)]
</span><a href="#local-6989586621679451598"><span class="hs-identifier hs-var hs-var">pendingDepositIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><a href="Hydra.TUI.Model.html#PendingIncrement"><span class="hs-identifier hs-type">PendingIncrement</span></a></span><span class="hs-special">{</span><span id="local-6989586621679451599"><span class="annot"><span class="annottext">TxId
$sel:deposit:PendingIncrement :: PendingIncrement -&gt; TxId
deposit :: TxId
</span><a href="Hydra.TUI.Model.html#%24sel%3Adeposit%3APendingIncrement"><span class="hs-identifier hs-var hs-var">deposit</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451600"><span class="annot"><span class="annottext">UTxO
$sel:utxoToCommit:PendingIncrement :: PendingIncrement -&gt; UTxO
utxoToCommit :: UTxO
</span><a href="Hydra.TUI.Model.html#%24sel%3AutxoToCommit%3APendingIncrement"><span class="hs-identifier hs-var hs-var">utxoToCommit</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621679451599"><span class="hs-identifier hs-var">deposit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451600"><span class="hs-identifier hs-var">utxoToCommit</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PendingIncrement -&gt; (TxId, UTxO))
-&gt; [PendingIncrement] -&gt; [(TxId, UTxO)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[PendingIncrement]
</span><a href="#local-6989586621679451585"><span class="hs-identifier hs-var">pendingIncrements</span></a></span><span>
</span><span id="line-376"></span><span>          </span><span class="annot"><span class="annottext">OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">(OpenScreen -&gt; EventM Name OpenScreen ())
-&gt; OpenScreen -&gt; EventM Name OpenScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Form (TxId, TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name -&gt; OpenScreen
</span><a href="Hydra.TUI.Model.html#SelectingDepositIdToRecover"><span class="hs-identifier hs-var">SelectingDepositIdToRecover</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(TxId, UTxO)]
-&gt; Form (TxId, TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
forall s e n.
(s ~ (TxId, TxIn, TxOut CtxUTxO), n ~ Name) =&gt;
[(TxId, UTxO)] -&gt; Form s e n
</span><a href="Hydra.TUI.Forms.html#depositIdRadioField"><span class="hs-identifier hs-var">depositIdRadioField</span></a></span><span> </span><span class="annot"><span class="annottext">[(TxId, UTxO)]
</span><a href="#local-6989586621679451598"><span class="hs-identifier hs-var">pendingDepositIds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'c'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-378"></span><span>          </span><span class="annot"><span class="annottext">OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">(OpenScreen -&gt; EventM Name OpenScreen ())
-&gt; OpenScreen -&gt; EventM Name OpenScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Form Bool (HydraEvent Tx) Name -&gt; OpenScreen
</span><a href="Hydra.TUI.Model.html#ConfirmingClose"><span class="hs-identifier hs-var">ConfirmingClose</span></a></span><span> </span><span class="annot"><span class="annottext">Form Bool (HydraEvent Tx) Name
forall s e n. (s ~ Bool, n ~ Name) =&gt; Form s e n
</span><a href="Hydra.TUI.Forms.html#confirmRadioField"><span class="hs-identifier hs-var">confirmRadioField</span></a></span><span>
</span><span id="line-379"></span><span>        </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name OpenScreen ()
forall a. a -&gt; EventM Name OpenScreen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>    </span><span class="annot"><a href="Hydra.TUI.Model.html#ConfirmingClose"><span class="hs-identifier hs-type">ConfirmingClose</span></a></span><span> </span><span id="local-6989586621679451605"><span class="annot"><span class="annottext">Form Bool (HydraEvent Tx) Name
</span><a href="#local-6989586621679451605"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-381"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451586"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-382"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEsc</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span>
</span><span id="line-383"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEnter</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-384"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451606"><span class="annot"><span class="annottext">selected :: Bool
</span><a href="#local-6989586621679451606"><span class="hs-identifier hs-var hs-var">selected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form Bool (HydraEvent Tx) Name -&gt; Bool
forall s e n. Form s e n -&gt; s
</span><span class="hs-identifier hs-var">formState</span></span><span> </span><span class="annot"><span class="annottext">Form Bool (HydraEvent Tx) Name
</span><a href="#local-6989586621679451605"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-385"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679451606"><span class="hs-identifier hs-var">selected</span></a></span><span>
</span><span id="line-386"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; EventM Name OpenScreen ()
forall a. IO a -&gt; EventM Name OpenScreen a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; EventM Name OpenScreen ())
-&gt; IO () -&gt; EventM Name OpenScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO -&gt; ClientInput Tx -&gt; IO ()
forall tx (m :: * -&gt; *). Client tx m -&gt; ClientInput tx -&gt; m ()
</span><a href="Hydra.Client.html#sendInput"><span class="hs-identifier hs-var">sendInput</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451583"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">ClientInput Tx
forall tx. ClientInput tx
</span><span class="hs-identifier hs-var">Close</span></span><span>
</span><span id="line-387"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span>
</span><span id="line-388"></span><span>        </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name (Form Bool (HydraEvent Tx) Name)) ())
  OpenScreen
  (Form Bool (HydraEvent Tx) Name)
-&gt; EventM Name (Form Bool (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall c.
LensLike'
  (Zoomed (EventM Name (Form Bool (HydraEvent Tx) Name)) c)
  OpenScreen
  (Form Bool (HydraEvent Tx) Name)
-&gt; EventM Name (Form Bool (HydraEvent Tx) Name) c
-&gt; EventM Name OpenScreen c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name (Form Bool (HydraEvent Tx) Name)) ())
  OpenScreen
  (Form Bool (HydraEvent Tx) Name)
(Form Bool (HydraEvent Tx) Name
 -&gt; Focusing
      (StateT (EventState Name) IO) () (Form Bool (HydraEvent Tx) Name))
-&gt; OpenScreen
-&gt; Focusing (StateT (EventState Name) IO) () OpenScreen
Traversal' OpenScreen (Form Bool (HydraEvent Tx) Name)
</span><a href="Hydra.TUI.Model.html#confirmingCloseFormL"><span class="hs-identifier hs-var">confirmingCloseFormL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name (Form Bool (HydraEvent Tx) Name) ()
 -&gt; EventM Name OpenScreen ())
-&gt; EventM Name (Form Bool (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
-&gt; EventM Name (Form Bool (HydraEvent Tx) Name) ()
forall n e s. Eq n =&gt; BrickEvent n e -&gt; EventM n (Form s e n) ()
</span><span class="hs-identifier hs-var">handleFormEvent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Event -&gt; BrickEvent Name (HydraEvent Tx)
forall n e. Event -&gt; BrickEvent n e
</span><span class="hs-identifier hs-var">VtyEvent</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451586"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>    </span><span class="annot"><a href="Hydra.TUI.Model.html#SelectingUTxO"><span class="hs-identifier hs-type">SelectingUTxO</span></a></span><span> </span><span id="local-6989586621679451609"><span class="annot"><span class="annottext">Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
</span><a href="#local-6989586621679451609"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-390"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451586"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-391"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEsc</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span>
</span><span id="line-392"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEnter</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-393"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451610"><span class="annot"><span class="annottext">utxoSelected :: (TxIn, TxOut CtxUTxO)
</span><a href="#local-6989586621679451610"><span class="hs-identifier hs-var">utxoSelected</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">txOutValue :: forall ctx. TxOut ctx -&gt; Value
</span><span class="hs-identifier hs-var">txOutValue</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679451613"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679451613"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
-&gt; (TxIn, TxOut CtxUTxO)
forall s e n. Form s e n -&gt; s
</span><span class="hs-identifier hs-var">formState</span></span><span> </span><span class="annot"><span class="annottext">Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
</span><a href="#local-6989586621679451609"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-394"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Coin</span></span><span> </span><span id="local-6989586621679451615"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679451615"><span class="hs-identifier hs-var">limit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Coin
</span><span class="hs-identifier hs-var">selectLovelace</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679451613"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-395"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451617"><span class="annot"><span class="annottext">enteringAmountForm :: Form Integer (HydraEvent Tx) Name
</span><a href="#local-6989586621679451617"><span class="hs-identifier hs-var hs-var">enteringAmountForm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-396"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451618"><span class="annot"><span class="annottext">field :: Integer -&gt; FormFieldState Integer (HydraEvent Tx) Name
</span><a href="#local-6989586621679451618"><span class="hs-identifier hs-var hs-var">field</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' Integer Integer
-&gt; Name
-&gt; (Integer -&gt; Bool)
-&gt; Integer
-&gt; FormFieldState Integer (HydraEvent Tx) Name
forall n a s e.
(Ord n, Show n, Read a, Show a) =&gt;
Lens' s a -&gt; n -&gt; (a -&gt; Bool) -&gt; s -&gt; FormFieldState s e n
</span><span class="hs-identifier hs-var">editShowableFieldWithValidate</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; f Integer) -&gt; Integer -&gt; f Integer
forall a. a -&gt; a
Lens' Integer Integer
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;amount&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679451620"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679451620"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679451620"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679451620"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679451615"><span class="hs-identifier hs-var">limit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>                 </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Integer -&gt; FormFieldState Integer (HydraEvent Tx) Name]
-&gt; Integer -&gt; Form Integer (HydraEvent Tx) Name
forall s e n. [s -&gt; FormFieldState s e n] -&gt; s -&gt; Form s e n
</span><span class="hs-identifier hs-var">newForm</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer -&gt; FormFieldState Integer (HydraEvent Tx) Name
</span><a href="#local-6989586621679451618"><span class="hs-identifier hs-var">field</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679451615"><span class="hs-identifier hs-var">limit</span></a></span><span>
</span><span id="line-398"></span><span>          </span><span class="annot"><span class="annottext">OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#EnteringAmount"><span class="hs-identifier hs-type">EnteringAmount</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO)
utxoSelected :: (TxIn, TxOut CtxUTxO)
$sel:utxoSelected:OpenHome :: (TxIn, TxOut CtxUTxO)
</span><a href="#local-6989586621679451610"><span class="hs-identifier hs-var hs-var">utxoSelected</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Form Integer (HydraEvent Tx) Name
enteringAmountForm :: Form Integer (HydraEvent Tx) Name
$sel:enteringAmountForm:OpenHome :: Form Integer (HydraEvent Tx) Name
</span><a href="#local-6989586621679451617"><span class="hs-identifier hs-var hs-var">enteringAmountForm</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-399"></span><span>        </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed
     (EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)) ())
  OpenScreen
  (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)
-&gt; EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall c.
LensLike'
  (Zoomed
     (EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)) c)
  OpenScreen
  (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)
-&gt; EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) c
-&gt; EventM Name OpenScreen c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed
     (EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)) ())
  OpenScreen
  (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)
(Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
 -&gt; Focusing
      (StateT (EventState Name) IO)
      ()
      (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name))
-&gt; OpenScreen
-&gt; Focusing (StateT (EventState Name) IO) () OpenScreen
Traversal'
  OpenScreen (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)
</span><a href="Hydra.TUI.Model.html#selectingUTxOFormL"><span class="hs-identifier hs-var">selectingUTxOFormL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) ()
 -&gt; EventM Name OpenScreen ())
-&gt; EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
-&gt; EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) ()
forall n e s. Eq n =&gt; BrickEvent n e -&gt; EventM n (Form s e n) ()
</span><span class="hs-identifier hs-var">handleFormEvent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Event -&gt; BrickEvent Name (HydraEvent Tx)
forall n e. Event -&gt; BrickEvent n e
</span><span class="hs-identifier hs-var">VtyEvent</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451586"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>    </span><span class="annot"><a href="Hydra.TUI.Model.html#SelectingUTxOToDecommit"><span class="hs-identifier hs-type">SelectingUTxOToDecommit</span></a></span><span> </span><span id="local-6989586621679451628"><span class="annot"><span class="annottext">Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
</span><a href="#local-6989586621679451628"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-401"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451586"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-402"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEsc</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span>
</span><span id="line-403"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEnter</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-404"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451629"><span class="annot"><span class="annottext">utxoSelected :: (TxIn, TxOut CtxUTxO)
</span><a href="#local-6989586621679451629"><span class="hs-identifier hs-var">utxoSelected</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">txOutValue :: forall ctx. TxOut ctx -&gt; Value
</span><span class="hs-identifier hs-var">txOutValue</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679451630"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679451630"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
-&gt; (TxIn, TxOut CtxUTxO)
forall s e n. Form s e n -&gt; s
</span><span class="hs-identifier hs-var">formState</span></span><span> </span><span class="annot"><span class="annottext">Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
</span><a href="#local-6989586621679451628"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-405"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451631"><span class="annot"><span class="annottext">recipient :: AddressInEra
</span><a href="#local-6989586621679451631"><span class="hs-identifier hs-var hs-var">recipient</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
IsShelleyBasedEra era =&gt;
NetworkId -&gt; VerificationKey PaymentKey -&gt; AddressInEra era
</span><span class="hs-identifier hs-var">mkVkAddress</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Era</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoClient -&gt; NetworkId
</span><span class="hs-identifier hs-var">networkId</span></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679451582"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SigningKey PaymentKey -&gt; VerificationKey PaymentKey
forall keyrole.
(Key keyrole, HasTypeProxy keyrole) =&gt;
SigningKey keyrole -&gt; VerificationKey keyrole
</span><span class="hs-identifier hs-var">getVerificationKey</span></span><span> </span><span class="annot"><span class="annottext">(SigningKey PaymentKey -&gt; VerificationKey PaymentKey)
-&gt; SigningKey PaymentKey -&gt; VerificationKey PaymentKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO -&gt; SigningKey PaymentKey
forall tx (m :: * -&gt; *). Client tx m -&gt; SigningKey PaymentKey
</span><a href="Hydra.Client.html#sk"><span class="hs-identifier hs-var">sk</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451583"><span class="hs-identifier hs-var">hydraClient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO)
-&gt; (AddressInEra, Value)
-&gt; SigningKey PaymentKey
-&gt; Either TxBodyError Tx
</span><span class="hs-identifier hs-var">mkSimpleTx</span></span><span> </span><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO)
</span><a href="#local-6989586621679451629"><span class="hs-identifier hs-var">utxoSelected</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679451631"><span class="hs-identifier hs-var">recipient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679451630"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Client Tx IO -&gt; SigningKey PaymentKey
forall tx (m :: * -&gt; *). Client tx m -&gt; SigningKey PaymentKey
</span><a href="Hydra.Client.html#sk"><span class="hs-identifier hs-var">sk</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451583"><span class="hs-identifier hs-var">hydraClient</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-407"></span><span>            </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyError
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name OpenScreen ()
forall a. a -&gt; EventM Name OpenScreen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>            </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679451633"><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679451633"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-409"></span><span>              </span><span class="annot"><span class="annottext">IO () -&gt; EventM Name OpenScreen ()
forall a. IO a -&gt; EventM Name OpenScreen a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Client Tx IO -&gt; ClientInput Tx -&gt; IO ()
forall tx (m :: * -&gt; *). Client tx m -&gt; ClientInput tx -&gt; m ()
</span><a href="Hydra.Client.html#sendInput"><span class="hs-identifier hs-var">sendInput</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451583"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tx -&gt; ClientInput Tx
forall tx. tx -&gt; ClientInput tx
</span><span class="hs-identifier hs-var">Decommit</span></span><span> </span><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679451633"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>          </span><span class="annot"><span class="annottext">OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span>
</span><span id="line-411"></span><span>        </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed
     (EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)) ())
  OpenScreen
  (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)
-&gt; EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall c.
LensLike'
  (Zoomed
     (EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)) c)
  OpenScreen
  (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)
-&gt; EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) c
-&gt; EventM Name OpenScreen c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed
     (EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)) ())
  OpenScreen
  (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)
(Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
 -&gt; Focusing
      (StateT (EventState Name) IO)
      ()
      (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name))
-&gt; OpenScreen
-&gt; Focusing (StateT (EventState Name) IO) () OpenScreen
Traversal'
  OpenScreen (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)
</span><a href="Hydra.TUI.Model.html#selectingUTxOToDecommitFormL"><span class="hs-identifier hs-var">selectingUTxOToDecommitFormL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) ()
 -&gt; EventM Name OpenScreen ())
-&gt; EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
-&gt; EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) ()
forall n e s. Eq n =&gt; BrickEvent n e -&gt; EventM n (Form s e n) ()
</span><span class="hs-identifier hs-var">handleFormEvent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Event -&gt; BrickEvent Name (HydraEvent Tx)
forall n e. Event -&gt; BrickEvent n e
</span><span class="hs-identifier hs-var">VtyEvent</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451586"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>    </span><span class="annot"><a href="Hydra.TUI.Model.html#SelectingUTxOToIncrement"><span class="hs-identifier hs-type">SelectingUTxOToIncrement</span></a></span><span> </span><span id="local-6989586621679451636"><span class="annot"><span class="annottext">Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
</span><a href="#local-6989586621679451636"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-413"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451586"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-414"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEsc</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span>
</span><span id="line-415"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEnter</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-416"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451637"><span class="annot"><span class="annottext">utxoSelected :: (TxIn, TxOut CtxUTxO)
</span><a href="#local-6989586621679451637"><span class="hs-identifier hs-var hs-var">utxoSelected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
-&gt; (TxIn, TxOut CtxUTxO)
forall s e n. Form s e n -&gt; s
</span><span class="hs-identifier hs-var">formState</span></span><span> </span><span class="annot"><span class="annottext">Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
</span><a href="#local-6989586621679451636"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-417"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451638"><span class="annot"><span class="annottext">commitUTxO :: UTxO
</span><a href="#local-6989586621679451638"><span class="hs-identifier hs-var hs-var">commitUTxO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxIn -&gt; TxOut CtxUTxO -&gt; UTxO) -&gt; (TxIn, TxOut CtxUTxO) -&gt; UTxO
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Tuple.html#uncurry"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">TxIn -&gt; TxOut CtxUTxO -&gt; UTxO
forall out. TxIn -&gt; out -&gt; UTxO' out
</span><span class="hs-identifier hs-var">UTxO.singleton</span></span><span> </span><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO)
</span><a href="#local-6989586621679451637"><span class="hs-identifier hs-var">utxoSelected</span></a></span><span>
</span><span id="line-418"></span><span>          </span><span class="annot"><span class="annottext">IO () -&gt; EventM Name OpenScreen ()
forall a. IO a -&gt; EventM Name OpenScreen a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; EventM Name OpenScreen ())
-&gt; IO () -&gt; EventM Name OpenScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO -&gt; UTxO -&gt; IO ()
forall tx (m :: * -&gt; *). Client tx m -&gt; UTxO -&gt; m ()
</span><a href="Hydra.Client.html#externalCommit"><span class="hs-identifier hs-var">externalCommit</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451583"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451638"><span class="hs-identifier hs-var">commitUTxO</span></a></span><span>
</span><span id="line-419"></span><span>          </span><span class="annot"><span class="annottext">OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span>
</span><span id="line-420"></span><span>        </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed
     (EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)) ())
  OpenScreen
  (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)
-&gt; EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall c.
LensLike'
  (Zoomed
     (EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)) c)
  OpenScreen
  (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)
-&gt; EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) c
-&gt; EventM Name OpenScreen c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed
     (EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)) ())
  OpenScreen
  (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)
(Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
 -&gt; Focusing
      (StateT (EventState Name) IO)
      ()
      (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name))
-&gt; OpenScreen
-&gt; Focusing (StateT (EventState Name) IO) () OpenScreen
Traversal'
  OpenScreen (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)
</span><a href="Hydra.TUI.Model.html#selectingUTxOToIncrementFormL"><span class="hs-identifier hs-var">selectingUTxOToIncrementFormL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) ()
 -&gt; EventM Name OpenScreen ())
-&gt; EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
-&gt; EventM Name (Form (TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) ()
forall n e s. Eq n =&gt; BrickEvent n e -&gt; EventM n (Form s e n) ()
</span><span class="hs-identifier hs-var">handleFormEvent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Event -&gt; BrickEvent Name (HydraEvent Tx)
forall n e. Event -&gt; BrickEvent n e
</span><span class="hs-identifier hs-var">VtyEvent</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451586"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>    </span><span class="annot"><a href="Hydra.TUI.Model.html#SelectingDepositIdToRecover"><span class="hs-identifier hs-type">SelectingDepositIdToRecover</span></a></span><span> </span><span id="local-6989586621679451642"><span class="annot"><span class="annottext">Form (TxId, TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
</span><a href="#local-6989586621679451642"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-422"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451586"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-423"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEsc</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span>
</span><span id="line-424"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEnter</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-425"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679451643"><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621679451643"><span class="hs-identifier hs-var">selectedTxId</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxIn
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (TxId, TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
-&gt; (TxId, TxIn, TxOut CtxUTxO)
forall s e n. Form s e n -&gt; s
</span><span class="hs-identifier hs-var">formState</span></span><span> </span><span class="annot"><span class="annottext">Form (TxId, TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
</span><a href="#local-6989586621679451642"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-426"></span><span>          </span><span class="annot"><span class="annottext">IO () -&gt; EventM Name OpenScreen ()
forall a. IO a -&gt; EventM Name OpenScreen a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; EventM Name OpenScreen ())
-&gt; IO () -&gt; EventM Name OpenScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO -&gt; TxId -&gt; IO ()
forall tx (m :: * -&gt; *). Client tx m -&gt; TxId -&gt; m ()
</span><a href="Hydra.Client.html#recoverCommit"><span class="hs-identifier hs-var">recoverCommit</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451583"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621679451643"><span class="hs-identifier hs-var">selectedTxId</span></a></span><span>
</span><span id="line-427"></span><span>          </span><span class="annot"><span class="annottext">OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span>
</span><span id="line-428"></span><span>        </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed
     (EventM
        Name (Form (TxId, TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name))
     ())
  OpenScreen
  (Form (TxId, TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)
-&gt; EventM
     Name (Form (TxId, TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall c.
LensLike'
  (Zoomed
     (EventM
        Name (Form (TxId, TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name))
     c)
  OpenScreen
  (Form (TxId, TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)
-&gt; EventM
     Name (Form (TxId, TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) c
-&gt; EventM Name OpenScreen c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed
     (EventM
        Name (Form (TxId, TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name))
     ())
  OpenScreen
  (Form (TxId, TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)
(Form (TxId, TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name
 -&gt; Focusing
      (StateT (EventState Name) IO)
      ()
      (Form (TxId, TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name))
-&gt; OpenScreen
-&gt; Focusing (StateT (EventState Name) IO) () OpenScreen
Traversal'
  OpenScreen (Form (TxId, TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name)
</span><a href="Hydra.TUI.Model.html#selectingDepositIdToRecoverFormL"><span class="hs-identifier hs-var">selectingDepositIdToRecoverFormL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM
   Name (Form (TxId, TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) ()
 -&gt; EventM Name OpenScreen ())
-&gt; EventM
     Name (Form (TxId, TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
-&gt; EventM
     Name (Form (TxId, TxIn, TxOut CtxUTxO) (HydraEvent Tx) Name) ()
forall n e s. Eq n =&gt; BrickEvent n e -&gt; EventM n (Form s e n) ()
</span><span class="hs-identifier hs-var">handleFormEvent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Event -&gt; BrickEvent Name (HydraEvent Tx)
forall n e. Event -&gt; BrickEvent n e
</span><span class="hs-identifier hs-var">VtyEvent</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451586"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span>    </span><span class="annot"><a href="Hydra.TUI.Model.html#EnteringAmount"><span class="hs-identifier hs-type">EnteringAmount</span></a></span><span> </span><span id="local-6989586621679451646"><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO)
</span><a href="#local-6989586621679451646"><span class="hs-identifier hs-var">utxoSelected</span></a></span></span><span> </span><span id="local-6989586621679451647"><span class="annot"><span class="annottext">Form Integer (HydraEvent Tx) Name
</span><a href="#local-6989586621679451647"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-430"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451586"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-431"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEsc</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span>
</span><span id="line-432"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEnter</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-433"></span><span>          </span><span class="hs-keyword">let</span><span>
</span><span id="line-434"></span><span>            </span><span id="local-6989586621679451648"><span class="annot"><span class="annottext">field :: FormFieldRenderHelper SelectAddressItem Name
-&gt; SelectAddressItem
-&gt; FormFieldState SelectAddressItem (HydraEvent Tx) Name
</span><a href="#local-6989586621679451648"><span class="hs-identifier hs-var hs-var">field</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-435"></span><span>              </span><span class="annot"><span class="annottext">Char
-&gt; Char
-&gt; Char
-&gt; Lens' SelectAddressItem SelectAddressItem
-&gt; [(SelectAddressItem, Name, Name)]
-&gt; FormFieldRenderHelper SelectAddressItem Name
-&gt; SelectAddressItem
-&gt; FormFieldState SelectAddressItem (HydraEvent Tx) Name
forall n a s e.
(Ord n, Eq a) =&gt;
Char
-&gt; Char
-&gt; Char
-&gt; Lens' s a
-&gt; [(a, n, Name)]
-&gt; FormFieldRenderHelper a n
-&gt; s
-&gt; FormFieldState s e n
</span><a href="Hydra.TUI.Forms.html#customRadioField"><span class="hs-identifier hs-var">customRadioField</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'['</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'X'</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">']'</span></span><span> </span><span class="annot"><span class="annottext">(SelectAddressItem -&gt; f SelectAddressItem)
-&gt; SelectAddressItem -&gt; f SelectAddressItem
forall a. a -&gt; a
Lens' SelectAddressItem SelectAddressItem
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">([(SelectAddressItem, Name, Name)]
 -&gt; FormFieldRenderHelper SelectAddressItem Name
 -&gt; SelectAddressItem
 -&gt; FormFieldState SelectAddressItem (HydraEvent Tx) Name)
-&gt; [(SelectAddressItem, Name, Name)]
-&gt; FormFieldRenderHelper SelectAddressItem Name
-&gt; SelectAddressItem
-&gt; FormFieldState SelectAddressItem (HydraEvent Tx) Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-436"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectAddressItem
</span><a href="#local-6989586621679451651"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SelectAddressItem -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SelectAddressItem
</span><a href="#local-6989586621679451651"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; Name
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Doc Any -&gt; Name) -&gt; Doc Any -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SelectAddressItem -&gt; Doc Any
forall a ann. Pretty a =&gt; a -&gt; Doc ann
forall ann. SelectAddressItem -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">SelectAddressItem
</span><a href="#local-6989586621679451651"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679451651"><span class="annot"><span class="annottext">SelectAddressItem
</span><a href="#local-6989586621679451651"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[SelectAddressItem] -&gt; [SelectAddressItem]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.OldList.html#nub"><span class="hs-identifier hs-var">nub</span></a></span><span> </span><span class="annot"><span class="annottext">([SelectAddressItem] -&gt; [SelectAddressItem])
-&gt; [SelectAddressItem] -&gt; [SelectAddressItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty SelectAddressItem -&gt; [SelectAddressItem]
forall a. NonEmpty a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Foldable.html#toList"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty SelectAddressItem
</span><a href="#local-6989586621679451653"><span class="hs-identifier hs-var">addresses</span></a></span><span>
</span><span id="line-438"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-439"></span><span>            </span><span id="local-6989586621679451654"><span class="annot"><span class="annottext">decorator :: FormFieldRenderHelper SelectAddressItem Name
</span><a href="#local-6989586621679451654"><span class="hs-identifier hs-var hs-var">decorator</span></a></span></span><span> </span><span id="local-6989586621679451655"><span class="annot"><span class="annottext">SelectAddressItem
</span><a href="#local-6989586621679451655"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-440"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">SelectAddressItem
</span><a href="#local-6989586621679451655"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">SelectAddressItem -&gt; SelectAddressItem -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">AddressInEra -&gt; SelectAddressItem
</span><a href="Hydra.TUI.Model.html#SelectAddress"><span class="hs-identifier hs-var">SelectAddress</span></a></span><span> </span><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679451657"><span class="hs-identifier hs-var">ownAddress</span></a></span><span>
</span><span id="line-441"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; Widget Name -&gt; Widget Name
forall n. AttrName -&gt; Widget n -&gt; Widget n
</span><span class="hs-identifier hs-var">withAttr</span></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Hydra.TUI.Style.html#own"><span class="hs-identifier hs-var">own</span></a></span><span>
</span><span id="line-442"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Widget Name -&gt; Widget Name
forall a. a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-443"></span><span>            </span><span id="local-6989586621679451653"><span class="annot"><span class="annottext">addresses :: NonEmpty SelectAddressItem
</span><a href="#local-6989586621679451653"><span class="hs-identifier hs-var hs-var">addresses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-444"></span><span>              </span><span class="annot"><span class="annottext">SelectAddressItem
</span><a href="Hydra.TUI.Model.html#ManualEntry"><span class="hs-identifier hs-var">ManualEntry</span></a></span><span>
</span><span id="line-445"></span><span>                </span><span class="annot"><span class="annottext">SelectAddressItem
-&gt; [SelectAddressItem] -&gt; NonEmpty SelectAddressItem
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%3A%7C"><span class="hs-operator hs-var">:|</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddressInEra -&gt; SelectAddressItem
</span><a href="Hydra.TUI.Model.html#SelectAddress"><span class="hs-identifier hs-var">SelectAddress</span></a></span><span> </span><span class="annot"><span class="annottext">(AddressInEra -&gt; SelectAddressItem)
-&gt; (TxOut CtxUTxO -&gt; AddressInEra)
-&gt; TxOut CtxUTxO
-&gt; SelectAddressItem
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO -&gt; AddressInEra
forall ctx. TxOut ctx -&gt; AddressInEra
</span><span class="hs-identifier hs-var">txOutAddress</span></span><span> </span><span class="annot"><span class="annottext">(TxOut CtxUTxO -&gt; SelectAddressItem)
-&gt; [TxOut CtxUTxO] -&gt; [SelectAddressItem]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO -&gt; [TxOut CtxUTxO]
</span><span class="hs-identifier hs-var">UTxO.txOutputs</span></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679451584"><span class="hs-identifier hs-var">utxo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>          </span><span class="annot"><span class="annottext">OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span>
</span><span id="line-447"></span><span>            </span><span class="annot"><a href="Hydra.TUI.Model.html#SelectingRecipient"><span class="hs-identifier hs-type">SelectingRecipient</span></a></span><span>
</span><span id="line-448"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO)
$sel:utxoSelected:OpenHome :: (TxIn, TxOut CtxUTxO)
utxoSelected :: (TxIn, TxOut CtxUTxO)
</span><a href="Hydra.TUI.Model.html#%24sel%3AutxoSelected%3AOpenHome"><span class="hs-identifier hs-var hs-var">utxoSelected</span></a></span><span>
</span><span id="line-449"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:amountEntered:OpenHome :: Integer
</span><a href="Hydra.TUI.Model.html#%24sel%3AamountEntered%3AOpenHome"><span class="hs-identifier hs-var">amountEntered</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form Integer (HydraEvent Tx) Name -&gt; Integer
forall s e n. Form s e n -&gt; s
</span><span class="hs-identifier hs-var">formState</span></span><span> </span><span class="annot"><span class="annottext">Form Integer (HydraEvent Tx) Name
</span><a href="#local-6989586621679451647"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-450"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:selectingRecipientForm:OpenHome :: Form SelectAddressItem (HydraEvent Tx) Name
</span><a href="Hydra.TUI.Model.html#%24sel%3AselectingRecipientForm%3AOpenHome"><span class="hs-identifier hs-var">selectingRecipientForm</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SelectAddressItem
 -&gt; FormFieldState SelectAddressItem (HydraEvent Tx) Name]
-&gt; SelectAddressItem -&gt; Form SelectAddressItem (HydraEvent Tx) Name
forall s e n. [s -&gt; FormFieldState s e n] -&gt; s -&gt; Form s e n
</span><span class="hs-identifier hs-var">newForm</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FormFieldRenderHelper SelectAddressItem Name
-&gt; SelectAddressItem
-&gt; FormFieldState SelectAddressItem (HydraEvent Tx) Name
</span><a href="#local-6989586621679451648"><span class="hs-identifier hs-var">field</span></a></span><span> </span><span class="annot"><span class="annottext">FormFieldRenderHelper SelectAddressItem Name
</span><a href="#local-6989586621679451654"><span class="hs-identifier hs-var">decorator</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">SelectAddressItem
</span><a href="Hydra.TUI.Model.html#ManualEntry"><span class="hs-identifier hs-var">ManualEntry</span></a></span><span>
</span><span id="line-451"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-452"></span><span>        </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name (Form Integer (HydraEvent Tx) Name)) ())
  OpenScreen
  (Form Integer (HydraEvent Tx) Name)
-&gt; EventM Name (Form Integer (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall c.
LensLike'
  (Zoomed (EventM Name (Form Integer (HydraEvent Tx) Name)) c)
  OpenScreen
  (Form Integer (HydraEvent Tx) Name)
-&gt; EventM Name (Form Integer (HydraEvent Tx) Name) c
-&gt; EventM Name OpenScreen c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name (Form Integer (HydraEvent Tx) Name)) ())
  OpenScreen
  (Form Integer (HydraEvent Tx) Name)
(Form Integer (HydraEvent Tx) Name
 -&gt; Focusing
      (StateT (EventState Name) IO)
      ()
      (Form Integer (HydraEvent Tx) Name))
-&gt; OpenScreen
-&gt; Focusing (StateT (EventState Name) IO) () OpenScreen
Traversal' OpenScreen (Form Integer (HydraEvent Tx) Name)
</span><a href="Hydra.TUI.Model.html#enteringAmountFormL"><span class="hs-identifier hs-var">enteringAmountFormL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name (Form Integer (HydraEvent Tx) Name) ()
 -&gt; EventM Name OpenScreen ())
-&gt; EventM Name (Form Integer (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
-&gt; EventM Name (Form Integer (HydraEvent Tx) Name) ()
forall n e s. Eq n =&gt; BrickEvent n e -&gt; EventM n (Form s e n) ()
</span><span class="hs-identifier hs-var">handleFormEvent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Event -&gt; BrickEvent Name (HydraEvent Tx)
forall n e. Event -&gt; BrickEvent n e
</span><span class="hs-identifier hs-var">VtyEvent</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451586"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span>    </span><span class="annot"><a href="Hydra.TUI.Model.html#SelectingRecipient"><span class="hs-identifier hs-type">SelectingRecipient</span></a></span><span> </span><span id="local-6989586621679451667"><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO)
</span><a href="#local-6989586621679451667"><span class="hs-identifier hs-var">utxoSelected</span></a></span></span><span> </span><span id="local-6989586621679451668"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679451668"><span class="hs-identifier hs-var">amountEntered</span></a></span></span><span> </span><span id="local-6989586621679451669"><span class="annot"><span class="annottext">Form SelectAddressItem (HydraEvent Tx) Name
</span><a href="#local-6989586621679451669"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-454"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451586"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-455"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEsc</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span>
</span><span id="line-456"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEnter</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-457"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Form SelectAddressItem (HydraEvent Tx) Name -&gt; SelectAddressItem
forall s e n. Form s e n -&gt; s
</span><span class="hs-identifier hs-var">formState</span></span><span> </span><span class="annot"><span class="annottext">Form SelectAddressItem (HydraEvent Tx) Name
</span><a href="#local-6989586621679451669"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-458"></span><span>            </span><span class="annot"><a href="Hydra.TUI.Model.html#SelectAddress"><span class="hs-identifier hs-type">SelectAddress</span></a></span><span> </span><span id="local-6989586621679451670"><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679451670"><span class="hs-identifier hs-var">recipient</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-459"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO)
-&gt; (AddressInEra, Value)
-&gt; SigningKey PaymentKey
-&gt; Either TxBodyError Tx
</span><span class="hs-identifier hs-var">mkSimpleTx</span></span><span> </span><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO)
</span><a href="#local-6989586621679451667"><span class="hs-identifier hs-var">utxoSelected</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679451670"><span class="hs-identifier hs-var">recipient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Value
</span><span class="hs-identifier hs-var">lovelaceToValue</span></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; Value) -&gt; Coin -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><span class="hs-identifier hs-var">Coin</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679451668"><span class="hs-identifier hs-var">amountEntered</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Client Tx IO -&gt; SigningKey PaymentKey
forall tx (m :: * -&gt; *). Client tx m -&gt; SigningKey PaymentKey
</span><a href="Hydra.Client.html#sk"><span class="hs-identifier hs-var">sk</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451583"><span class="hs-identifier hs-var">hydraClient</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-460"></span><span>                </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyError
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name OpenScreen ()
forall a. a -&gt; EventM Name OpenScreen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>                </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679451672"><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679451672"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-462"></span><span>                  </span><span class="annot"><span class="annottext">IO () -&gt; EventM Name OpenScreen ()
forall a. IO a -&gt; EventM Name OpenScreen a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Client Tx IO -&gt; ClientInput Tx -&gt; IO ()
forall tx (m :: * -&gt; *). Client tx m -&gt; ClientInput tx -&gt; m ()
</span><a href="Hydra.Client.html#sendInput"><span class="hs-identifier hs-var">sendInput</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451583"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tx -&gt; ClientInput Tx
forall tx. tx -&gt; ClientInput tx
</span><span class="hs-identifier hs-var">NewTx</span></span><span> </span><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679451672"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>                  </span><span class="annot"><span class="annottext">OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span>
</span><span id="line-464"></span><span>            </span><span class="annot"><span class="annottext">SelectAddressItem
</span><a href="Hydra.TUI.Model.html#ManualEntry"><span class="hs-identifier hs-var">ManualEntry</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-465"></span><span>              </span><span class="annot"><span class="annottext">OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">(OpenScreen -&gt; EventM Name OpenScreen ())
-&gt; OpenScreen -&gt; EventM Name OpenScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-466"></span><span>                </span><span class="annot"><a href="Hydra.TUI.Model.html#EnteringRecipientAddress"><span class="hs-identifier hs-type">EnteringRecipientAddress</span></a></span><span>
</span><span id="line-467"></span><span>                  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO)
$sel:utxoSelected:OpenHome :: (TxIn, TxOut CtxUTxO)
utxoSelected :: (TxIn, TxOut CtxUTxO)
</span><a href="Hydra.TUI.Model.html#%24sel%3AutxoSelected%3AOpenHome"><span class="hs-identifier hs-var hs-var">utxoSelected</span></a></span><span>
</span><span id="line-468"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
$sel:amountEntered:OpenHome :: Integer
amountEntered :: Integer
</span><a href="Hydra.TUI.Model.html#%24sel%3AamountEntered%3AOpenHome"><span class="hs-identifier hs-var hs-var">amountEntered</span></a></span><span>
</span><span id="line-469"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:enteringRecipientAddressForm:OpenHome :: Form AddressInEra (HydraEvent Tx) Name
</span><a href="Hydra.TUI.Model.html#%24sel%3AenteringRecipientAddressForm%3AOpenHome"><span class="hs-identifier hs-var">enteringRecipientAddressForm</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-470"></span><span>                      </span><span class="annot"><span class="annottext">[AddressInEra -&gt; FormFieldState AddressInEra (HydraEvent Tx) Name]
-&gt; AddressInEra -&gt; Form AddressInEra (HydraEvent Tx) Name
forall s e n. [s -&gt; FormFieldState s e n] -&gt; s -&gt; Form s e n
</span><span class="hs-identifier hs-var">newForm</span></span><span>
</span><span id="line-471"></span><span>                        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Lens' AddressInEra AddressInEra
-&gt; Name
-&gt; Maybe Int
-&gt; (AddressInEra -&gt; Name)
-&gt; ([Name] -&gt; Maybe AddressInEra)
-&gt; ([Name] -&gt; Widget Name)
-&gt; (Widget Name -&gt; Widget Name)
-&gt; AddressInEra
-&gt; FormFieldState AddressInEra (HydraEvent Tx) Name
forall n s a e.
(Ord n, Show n) =&gt;
Lens' s a
-&gt; n
-&gt; Maybe Int
-&gt; (a -&gt; Name)
-&gt; ([Name] -&gt; Maybe a)
-&gt; ([Name] -&gt; Widget n)
-&gt; (Widget n -&gt; Widget n)
-&gt; s
-&gt; FormFieldState s e n
</span><span class="hs-identifier hs-var">editField</span></span><span>
</span><span id="line-472"></span><span>                            </span><span class="annot"><span class="annottext">(AddressInEra -&gt; f AddressInEra) -&gt; AddressInEra -&gt; f AddressInEra
forall a. a -&gt; a
Lens' AddressInEra AddressInEra
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-473"></span><span>                            </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;manual address entry&quot;</span></span><span>
</span><span id="line-474"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>                            </span><span class="annot"><span class="annottext">AddressInEra -&gt; Name
forall addr. SerialiseAddress addr =&gt; addr -&gt; Name
</span><span class="hs-identifier hs-var">serialiseAddress</span></span><span>
</span><span id="line-476"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; Maybe (NonEmpty Name)
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.List.NonEmpty.html#nonEmpty"><span class="hs-identifier hs-var">nonEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; Maybe (NonEmpty Name))
-&gt; (NonEmpty Name -&gt; Maybe AddressInEra)
-&gt; [Name]
-&gt; Maybe AddressInEra
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.html#%3E%3D%3E"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe AddressInEra
</span><a href="#local-6989586621679451680"><span class="hs-identifier hs-var">parseAddress</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Maybe AddressInEra)
-&gt; (NonEmpty Name -&gt; Name) -&gt; NonEmpty Name -&gt; Maybe AddressInEra
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty Name -&gt; Name
forall (f :: * -&gt; *) a. IsNonEmpty f a a &quot;head&quot; =&gt; f a -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span class="hs-special">)</span><span>
</span><span id="line-477"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Widget Name
forall n. Name -&gt; Widget n
</span><span class="hs-identifier hs-var">txt</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Widget Name) -&gt; ([Name] -&gt; Name) -&gt; [Name] -&gt; Widget Name
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Name
forall m. Monoid m =&gt; [m] -&gt; m
forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Foldable.html#fold"><span class="hs-identifier hs-var">fold</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>                            </span><span class="annot"><span class="annottext">Widget Name -&gt; Widget Name
forall a. a -&gt; a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-479"></span><span>                        </span><span class="hs-special">]</span><span>
</span><span id="line-480"></span><span>                        </span><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679451657"><span class="hs-identifier hs-var">ownAddress</span></a></span><span>
</span><span id="line-481"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-482"></span><span>        </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed
     (EventM Name (Form SelectAddressItem (HydraEvent Tx) Name)) ())
  OpenScreen
  (Form SelectAddressItem (HydraEvent Tx) Name)
-&gt; EventM Name (Form SelectAddressItem (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall c.
LensLike'
  (Zoomed
     (EventM Name (Form SelectAddressItem (HydraEvent Tx) Name)) c)
  OpenScreen
  (Form SelectAddressItem (HydraEvent Tx) Name)
-&gt; EventM Name (Form SelectAddressItem (HydraEvent Tx) Name) c
-&gt; EventM Name OpenScreen c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed
     (EventM Name (Form SelectAddressItem (HydraEvent Tx) Name)) ())
  OpenScreen
  (Form SelectAddressItem (HydraEvent Tx) Name)
(Form SelectAddressItem (HydraEvent Tx) Name
 -&gt; Focusing
      (StateT (EventState Name) IO)
      ()
      (Form SelectAddressItem (HydraEvent Tx) Name))
-&gt; OpenScreen
-&gt; Focusing (StateT (EventState Name) IO) () OpenScreen
Traversal' OpenScreen (Form SelectAddressItem (HydraEvent Tx) Name)
</span><a href="Hydra.TUI.Model.html#selectingRecipientFormL"><span class="hs-identifier hs-var">selectingRecipientFormL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name (Form SelectAddressItem (HydraEvent Tx) Name) ()
 -&gt; EventM Name OpenScreen ())
-&gt; EventM Name (Form SelectAddressItem (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
-&gt; EventM Name (Form SelectAddressItem (HydraEvent Tx) Name) ()
forall n e s. Eq n =&gt; BrickEvent n e -&gt; EventM n (Form s e n) ()
</span><span class="hs-identifier hs-var">handleFormEvent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Event -&gt; BrickEvent Name (HydraEvent Tx)
forall n e. Event -&gt; BrickEvent n e
</span><span class="hs-identifier hs-var">VtyEvent</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451586"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span>    </span><span class="annot"><a href="Hydra.TUI.Model.html#EnteringRecipientAddress"><span class="hs-identifier hs-type">EnteringRecipientAddress</span></a></span><span> </span><span id="local-6989586621679451685"><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO)
</span><a href="#local-6989586621679451685"><span class="hs-identifier hs-var">utxoSelected</span></a></span></span><span> </span><span id="local-6989586621679451686"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679451686"><span class="hs-identifier hs-var">amountEntered</span></a></span></span><span> </span><span id="local-6989586621679451687"><span class="annot"><span class="annottext">Form AddressInEra (HydraEvent Tx) Name
</span><a href="#local-6989586621679451687"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-484"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451586"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-485"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEsc</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span>
</span><span id="line-486"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KEnter</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-487"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451688"><span class="annot"><span class="annottext">recipient :: AddressInEra
</span><a href="#local-6989586621679451688"><span class="hs-identifier hs-var hs-var">recipient</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form AddressInEra (HydraEvent Tx) Name -&gt; AddressInEra
forall s e n. Form s e n -&gt; s
</span><span class="hs-identifier hs-var">formState</span></span><span> </span><span class="annot"><span class="annottext">Form AddressInEra (HydraEvent Tx) Name
</span><a href="#local-6989586621679451687"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-488"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO)
-&gt; (AddressInEra, Value)
-&gt; SigningKey PaymentKey
-&gt; Either TxBodyError Tx
</span><span class="hs-identifier hs-var">mkSimpleTx</span></span><span> </span><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO)
</span><a href="#local-6989586621679451685"><span class="hs-identifier hs-var">utxoSelected</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679451688"><span class="hs-identifier hs-var">recipient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Value
</span><span class="hs-identifier hs-var">lovelaceToValue</span></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; Value) -&gt; Coin -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><span class="hs-identifier hs-var">Coin</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679451686"><span class="hs-identifier hs-var">amountEntered</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Client Tx IO -&gt; SigningKey PaymentKey
forall tx (m :: * -&gt; *). Client tx m -&gt; SigningKey PaymentKey
</span><a href="Hydra.Client.html#sk"><span class="hs-identifier hs-var">sk</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451583"><span class="hs-identifier hs-var">hydraClient</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-489"></span><span>            </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyError
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name OpenScreen ()
forall a. a -&gt; EventM Name OpenScreen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>            </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679451689"><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679451689"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-491"></span><span>              </span><span class="annot"><span class="annottext">IO () -&gt; EventM Name OpenScreen ()
forall a. IO a -&gt; EventM Name OpenScreen a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Client Tx IO -&gt; ClientInput Tx -&gt; IO ()
forall tx (m :: * -&gt; *). Client tx m -&gt; ClientInput tx -&gt; m ()
</span><a href="Hydra.Client.html#sendInput"><span class="hs-identifier hs-var">sendInput</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451583"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tx -&gt; ClientInput Tx
forall tx. tx -&gt; ClientInput tx
</span><span class="hs-identifier hs-var">NewTx</span></span><span> </span><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679451689"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>              </span><span class="annot"><span class="annottext">OpenScreen -&gt; EventM Name OpenScreen ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">OpenScreen
</span><a href="Hydra.TUI.Model.html#OpenHome"><span class="hs-identifier hs-var">OpenHome</span></a></span><span>
</span><span id="line-493"></span><span>        </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name (Form AddressInEra (HydraEvent Tx) Name)) ())
  OpenScreen
  (Form AddressInEra (HydraEvent Tx) Name)
-&gt; EventM Name (Form AddressInEra (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall c.
LensLike'
  (Zoomed (EventM Name (Form AddressInEra (HydraEvent Tx) Name)) c)
  OpenScreen
  (Form AddressInEra (HydraEvent Tx) Name)
-&gt; EventM Name (Form AddressInEra (HydraEvent Tx) Name) c
-&gt; EventM Name OpenScreen c
forall (m :: * -&gt; *) (n :: * -&gt; *) s t c.
Zoom m n s t =&gt;
LensLike' (Zoomed m c) t s -&gt; m c -&gt; n c
</span><span class="hs-identifier hs-var">zoom</span></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Zoomed (EventM Name (Form AddressInEra (HydraEvent Tx) Name)) ())
  OpenScreen
  (Form AddressInEra (HydraEvent Tx) Name)
(Form AddressInEra (HydraEvent Tx) Name
 -&gt; Focusing
      (StateT (EventState Name) IO)
      ()
      (Form AddressInEra (HydraEvent Tx) Name))
-&gt; OpenScreen
-&gt; Focusing (StateT (EventState Name) IO) () OpenScreen
Traversal' OpenScreen (Form AddressInEra (HydraEvent Tx) Name)
</span><a href="Hydra.TUI.Model.html#enteringRecipientAddressFormL"><span class="hs-identifier hs-var">enteringRecipientAddressFormL</span></a></span><span> </span><span class="annot"><span class="annottext">(EventM Name (Form AddressInEra (HydraEvent Tx) Name) ()
 -&gt; EventM Name OpenScreen ())
-&gt; EventM Name (Form AddressInEra (HydraEvent Tx) Name) ()
-&gt; EventM Name OpenScreen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent Name (HydraEvent Tx)
-&gt; EventM Name (Form AddressInEra (HydraEvent Tx) Name) ()
forall n e s. Eq n =&gt; BrickEvent n e -&gt; EventM n (Form s e n) ()
</span><span class="hs-identifier hs-var">handleFormEvent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Event -&gt; BrickEvent Name (HydraEvent Tx)
forall n e. Event -&gt; BrickEvent n e
</span><span class="hs-identifier hs-var">VtyEvent</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451586"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-494"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-495"></span><span>  </span><span id="local-6989586621679451657"><span class="annot"><span class="annottext">ownAddress :: AddressInEra
</span><a href="#local-6989586621679451657"><span class="hs-identifier hs-var hs-var">ownAddress</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
IsShelleyBasedEra era =&gt;
NetworkId -&gt; VerificationKey PaymentKey -&gt; AddressInEra era
</span><span class="hs-identifier hs-var">mkVkAddress</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Era</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoClient -&gt; NetworkId
</span><span class="hs-identifier hs-var">networkId</span></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679451582"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SigningKey PaymentKey -&gt; VerificationKey PaymentKey
forall keyrole.
(Key keyrole, HasTypeProxy keyrole) =&gt;
SigningKey keyrole -&gt; VerificationKey keyrole
</span><span class="hs-identifier hs-var">getVerificationKey</span></span><span> </span><span class="annot"><span class="annottext">(SigningKey PaymentKey -&gt; VerificationKey PaymentKey)
-&gt; SigningKey PaymentKey -&gt; VerificationKey PaymentKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO -&gt; SigningKey PaymentKey
forall tx (m :: * -&gt; *). Client tx m -&gt; SigningKey PaymentKey
</span><a href="Hydra.Client.html#sk"><span class="hs-identifier hs-var">sk</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451583"><span class="hs-identifier hs-var">hydraClient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span>  </span><span id="local-6989586621679451680"><span class="annot"><span class="annottext">parseAddress :: Name -&gt; Maybe AddressInEra
</span><a href="#local-6989586621679451680"><span class="hs-identifier hs-var hs-var">parseAddress</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-498"></span><span>    </span><span class="annot"><span class="annottext">(Address ShelleyAddr -&gt; AddressInEra)
-&gt; Maybe (Address ShelleyAddr) -&gt; Maybe AddressInEra
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Address ShelleyAddr -&gt; AddressInEra
</span><span class="hs-identifier hs-var">ShelleyAddressInEra</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Address ShelleyAddr) -&gt; Maybe AddressInEra)
-&gt; (Name -&gt; Maybe (Address ShelleyAddr))
-&gt; Name
-&gt; Maybe AddressInEra
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">AsType (Address ShelleyAddr) -&gt; Name -&gt; Maybe (Address ShelleyAddr)
forall addr.
SerialiseAddress addr =&gt;
AsType addr -&gt; Name -&gt; Maybe addr
</span><span class="hs-identifier hs-var">deserialiseAddress</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AsType ShelleyAddr -&gt; AsType (Address ShelleyAddr)
forall addrtype. AsType addrtype -&gt; AsType (Address addrtype)
</span><span class="hs-identifier hs-var">AsAddress</span></span><span> </span><span class="annot"><span class="annottext">AsType ShelleyAddr
</span><span class="hs-identifier hs-var">AsShelleyAddr</span></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span id="local-6989586621679450502"><span class="annot"><a href="Hydra.TUI.Handlers.html#handleVtyEventsFanoutPossible"><span class="hs-identifier hs-type">handleVtyEventsFanoutPossible</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hydra.Client.html#Client"><span class="hs-identifier hs-type">Client</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vty.Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679450502"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-501"></span><span id="handleVtyEventsFanoutPossible"><span class="annot"><span class="annottext">handleVtyEventsFanoutPossible :: forall s. Client Tx IO -&gt; Event -&gt; EventM Name s ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsFanoutPossible"><span class="hs-identifier hs-var hs-var">handleVtyEventsFanoutPossible</span></a></span></span><span> </span><span id="local-6989586621679451701"><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451701"><span class="hs-identifier hs-var">hydraClient</span></a></span></span><span> </span><span id="local-6989586621679451702"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451702"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-502"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451702"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-503"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'f'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-504"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; EventM Name s ()
forall a. IO a -&gt; EventM Name s a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Client Tx IO -&gt; ClientInput Tx -&gt; IO ()
forall tx (m :: * -&gt; *). Client tx m -&gt; ClientInput tx -&gt; m ()
</span><a href="Hydra.Client.html#sendInput"><span class="hs-identifier hs-var">sendInput</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451701"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">ClientInput Tx
forall tx. ClientInput tx
</span><span class="hs-identifier hs-var">Fanout</span></span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>    </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name s ()
forall a. a -&gt; EventM Name s a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span id="local-6989586621679451704"><span class="annot"><a href="Hydra.TUI.Handlers.html#handleVtyEventsFinal"><span class="hs-identifier hs-type">handleVtyEventsFinal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hydra.Client.html#Client"><span class="hs-identifier hs-type">Client</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vty.Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451704"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-508"></span><span id="handleVtyEventsFinal"><span class="annot"><span class="annottext">handleVtyEventsFinal :: forall s. Client Tx IO -&gt; Event -&gt; EventM Name s ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsFinal"><span class="hs-identifier hs-var hs-var">handleVtyEventsFinal</span></a></span></span><span> </span><span id="local-6989586621679451707"><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451707"><span class="hs-identifier hs-var">hydraClient</span></a></span></span><span> </span><span id="local-6989586621679451708"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451708"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-509"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679451708"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-510"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'i'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-511"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; EventM Name s ()
forall a. IO a -&gt; EventM Name s a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Client Tx IO -&gt; ClientInput Tx -&gt; IO ()
forall tx (m :: * -&gt; *). Client tx m -&gt; ClientInput tx -&gt; m ()
</span><a href="Hydra.Client.html#sendInput"><span class="hs-identifier hs-var">sendInput</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451707"><span class="hs-identifier hs-var">hydraClient</span></a></span><span> </span><span class="annot"><span class="annottext">ClientInput Tx
forall tx. ClientInput tx
</span><span class="hs-identifier hs-var">Init</span></span><span class="hs-special">)</span><span>
</span><span id="line-512"></span><span>    </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name s ()
forall a. a -&gt; EventM Name s a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-513"></span><span>
</span><span id="line-514"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#handleVtyEventsLogState"><span class="hs-identifier hs-type">handleVtyEventsLogState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vty.Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Logging.Types.html#LogState"><span class="hs-identifier hs-type">LogState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-515"></span><span id="handleVtyEventsLogState"><span class="annot"><span class="annottext">handleVtyEventsLogState :: Event -&gt; EventM Name LogState ()
</span><a href="Hydra.TUI.Handlers.html#handleVtyEventsLogState"><span class="hs-identifier hs-var hs-var">handleVtyEventsLogState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-516"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&lt;'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Direction -&gt; EventM Name LogState ()
</span><a href="Hydra.TUI.Handlers.html#scroll"><span class="hs-identifier hs-var">scroll</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><span class="hs-identifier hs-var">Up</span></span><span>
</span><span id="line-517"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&gt;'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Direction -&gt; EventM Name LogState ()
</span><a href="Hydra.TUI.Handlers.html#scroll"><span class="hs-identifier hs-var">scroll</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><span class="hs-identifier hs-var">Down</span></span><span>
</span><span id="line-518"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'h'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(LogVerbosity -&gt; Identity LogVerbosity)
-&gt; LogState -&gt; Identity LogState
Lens' LogState LogVerbosity
</span><a href="Hydra.TUI.Logging.Types.html#logVerbosityL"><span class="hs-identifier hs-var">logVerbosityL</span></a></span><span> </span><span class="annot"><span class="annottext">((LogVerbosity -&gt; Identity LogVerbosity)
 -&gt; LogState -&gt; Identity LogState)
-&gt; LogVerbosity -&gt; EventM Name LogState ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">LogVerbosity
</span><a href="Hydra.TUI.Logging.Types.html#Full"><span class="hs-identifier hs-var">Full</span></a></span><span>
</span><span id="line-519"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'s'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(LogVerbosity -&gt; Identity LogVerbosity)
-&gt; LogState -&gt; Identity LogState
Lens' LogState LogVerbosity
</span><a href="Hydra.TUI.Logging.Types.html#logVerbosityL"><span class="hs-identifier hs-var">logVerbosityL</span></a></span><span> </span><span class="annot"><span class="annottext">((LogVerbosity -&gt; Identity LogVerbosity)
 -&gt; LogState -&gt; Identity LogState)
-&gt; LogVerbosity -&gt; EventM Name LogState ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">LogVerbosity
</span><a href="Hydra.TUI.Logging.Types.html#Short"><span class="hs-identifier hs-var">Short</span></a></span><span>
</span><span id="line-520"></span><span>  </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EventM Name LogState ()
forall a. a -&gt; EventM Name LogState a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#scroll"><span class="hs-identifier hs-type">scroll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Direction</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventM</span></span><span> </span><span class="annot"><a href="Hydra.TUI.Model.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Hydra.TUI.Logging.Types.html#LogState"><span class="hs-identifier hs-type">LogState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-523"></span><span id="scroll"><span class="annot"><span class="annottext">scroll :: Direction -&gt; EventM Name LogState ()
</span><a href="Hydra.TUI.Handlers.html#scroll"><span class="hs-identifier hs-var hs-var">scroll</span></a></span></span><span> </span><span id="local-6989586621679451714"><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679451714"><span class="hs-identifier hs-var">direction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-524"></span><span>  </span><span id="local-6989586621679451715"><span class="annot"><span class="annottext">LogVerbosity
</span><a href="#local-6989586621679451715"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting LogVerbosity LogState LogVerbosity
-&gt; EventM Name LogState LogVerbosity
forall s (m :: * -&gt; *) a. MonadState s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">use</span></span><span> </span><span class="annot"><span class="annottext">Getting LogVerbosity LogState LogVerbosity
Lens' LogState LogVerbosity
</span><a href="Hydra.TUI.Logging.Types.html#logVerbosityL"><span class="hs-identifier hs-var">logVerbosityL</span></a></span><span>
</span><span id="line-525"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LogVerbosity
</span><a href="#local-6989586621679451715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-526"></span><span>    </span><span class="annot"><span class="annottext">LogVerbosity
</span><a href="Hydra.TUI.Logging.Types.html#Full"><span class="hs-identifier hs-var">Full</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-527"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451716"><span class="annot"><span class="annottext">vp :: ViewportScroll Name
</span><a href="#local-6989586621679451716"><span class="hs-identifier hs-var hs-var">vp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ViewportScroll Name
forall n. n -&gt; ViewportScroll n
</span><span class="hs-identifier hs-var">viewportScroll</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Hydra.TUI.Model.html#fullFeedbackViewportName"><span class="hs-identifier hs-var">fullFeedbackViewportName</span></a></span><span>
</span><span id="line-528"></span><span>      </span><span class="annot"><span class="annottext">ViewportScroll Name -&gt; forall s. Direction -&gt; EventM Name s ()
forall n. ViewportScroll n -&gt; forall s. Direction -&gt; EventM n s ()
</span><span class="hs-identifier hs-var">vScrollPage</span></span><span> </span><span class="annot"><span class="annottext">ViewportScroll Name
</span><a href="#local-6989586621679451716"><span class="hs-identifier hs-var">vp</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679451714"><span class="hs-identifier hs-var">direction</span></a></span><span>
</span><span id="line-529"></span><span>    </span><span class="annot"><span class="annottext">LogVerbosity
</span><a href="Hydra.TUI.Logging.Types.html#Short"><span class="hs-identifier hs-var">Short</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-530"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451720"><span class="annot"><span class="annottext">vp :: ViewportScroll Name
</span><a href="#local-6989586621679451720"><span class="hs-identifier hs-var hs-var">vp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ViewportScroll Name
forall n. n -&gt; ViewportScroll n
</span><span class="hs-identifier hs-var">viewportScroll</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Hydra.TUI.Model.html#shortFeedbackViewportName"><span class="hs-identifier hs-var">shortFeedbackViewportName</span></a></span><span>
</span><span id="line-531"></span><span>      </span><span class="annot"><span class="annottext">ViewportScroll Name -&gt; forall s. Direction -&gt; EventM Name s ()
forall n. ViewportScroll n -&gt; forall s. Direction -&gt; EventM n s ()
</span><span class="hs-identifier hs-var">hScrollPage</span></span><span> </span><span class="annot"><span class="annottext">ViewportScroll Name
</span><a href="#local-6989586621679451720"><span class="hs-identifier hs-var">vp</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679451714"><span class="hs-identifier hs-var">direction</span></a></span><span>
</span><span id="line-532"></span><span>
</span><span id="line-533"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#myAvailableUTxO"><span class="hs-identifier hs-type">myAvailableUTxO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VerificationKey</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxIn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CtxUTxO</span></span><span class="hs-special">)</span><span>
</span><span id="line-534"></span><span id="myAvailableUTxO"><span class="annot"><span class="annottext">myAvailableUTxO :: NetworkId
-&gt; VerificationKey PaymentKey -&gt; UTxO -&gt; Map TxIn (TxOut CtxUTxO)
</span><a href="Hydra.TUI.Handlers.html#myAvailableUTxO"><span class="hs-identifier hs-var hs-var">myAvailableUTxO</span></a></span></span><span> </span><span id="local-6989586621679451723"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679451723"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span id="local-6989586621679451724"><span class="annot"><span class="annottext">VerificationKey PaymentKey
</span><a href="#local-6989586621679451724"><span class="hs-identifier hs-var">vk</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span id="local-6989586621679451725"><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO)
</span><a href="#local-6989586621679451725"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-535"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451726"><span class="annot"><span class="annottext">myAddress :: AddressInEra
</span><a href="#local-6989586621679451726"><span class="hs-identifier hs-var hs-var">myAddress</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NetworkId -&gt; VerificationKey PaymentKey -&gt; AddressInEra
forall era.
IsShelleyBasedEra era =&gt;
NetworkId -&gt; VerificationKey PaymentKey -&gt; AddressInEra era
</span><span class="hs-identifier hs-var">mkVkAddress</span></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679451723"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationKey PaymentKey
</span><a href="#local-6989586621679451724"><span class="hs-identifier hs-var">vk</span></a></span><span>
</span><span id="line-536"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(TxOut CtxUTxO -&gt; Bool)
-&gt; Map TxIn (TxOut CtxUTxO) -&gt; Map TxIn (TxOut CtxUTxO)
forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#filter"><span class="hs-identifier hs-var">Map.filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">txOutAddress :: forall ctx. TxOut ctx -&gt; AddressInEra
</span><span class="hs-identifier hs-var">txOutAddress</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679451728"><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679451728"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679451728"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">AddressInEra -&gt; AddressInEra -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679451726"><span class="hs-identifier hs-var">myAddress</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO)
</span><a href="#local-6989586621679451725"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-537"></span><span>
</span><span id="line-538"></span><span class="annot"><a href="Hydra.TUI.Handlers.html#mkMyAddress"><span class="hs-identifier hs-type">mkMyAddress</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoClient</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Client.html#Client"><span class="hs-identifier hs-type">Client</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Address</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ShelleyAddr</span></span><span>
</span><span id="line-539"></span><span id="mkMyAddress"><span class="annot"><span class="annottext">mkMyAddress :: CardanoClient -&gt; Client Tx IO -&gt; Address ShelleyAddr
</span><a href="Hydra.TUI.Handlers.html#mkMyAddress"><span class="hs-identifier hs-var hs-var">mkMyAddress</span></a></span></span><span> </span><span id="local-6989586621679451729"><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679451729"><span class="hs-identifier hs-var">cardanoClient</span></a></span></span><span> </span><span id="local-6989586621679451730"><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451730"><span class="hs-identifier hs-var">hydraClient</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-540"></span><span>  </span><span class="annot"><span class="annottext">NetworkId
-&gt; PaymentCredential
-&gt; StakeAddressReference
-&gt; Address ShelleyAddr
</span><span class="hs-identifier hs-var">makeShelleyAddress</span></span><span>
</span><span id="line-541"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoClient -&gt; NetworkId
</span><span class="hs-identifier hs-var">networkId</span></span><span> </span><span class="annot"><span class="annottext">CardanoClient
</span><a href="#local-6989586621679451729"><span class="hs-identifier hs-var">cardanoClient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-542"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hash PaymentKey -&gt; PaymentCredential
</span><span class="hs-identifier hs-var">PaymentCredentialByKey</span></span><span> </span><span class="annot"><span class="annottext">(Hash PaymentKey -&gt; PaymentCredential)
-&gt; (VerificationKey PaymentKey -&gt; Hash PaymentKey)
-&gt; VerificationKey PaymentKey
-&gt; PaymentCredential
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationKey PaymentKey -&gt; Hash PaymentKey
forall keyrole.
Key keyrole =&gt;
VerificationKey keyrole -&gt; Hash keyrole
</span><span class="hs-identifier hs-var">verificationKeyHash</span></span><span> </span><span class="annot"><span class="annottext">(VerificationKey PaymentKey -&gt; PaymentCredential)
-&gt; VerificationKey PaymentKey -&gt; PaymentCredential
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SigningKey PaymentKey -&gt; VerificationKey PaymentKey
forall keyrole.
(Key keyrole, HasTypeProxy keyrole) =&gt;
SigningKey keyrole -&gt; VerificationKey keyrole
</span><span class="hs-identifier hs-var">getVerificationKey</span></span><span> </span><span class="annot"><span class="annottext">(SigningKey PaymentKey -&gt; VerificationKey PaymentKey)
-&gt; SigningKey PaymentKey -&gt; VerificationKey PaymentKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/cz9ly62f92wivwp9aah4py51j2fnx6kf-ghc-9.6.7-doc/share/doc/ghc-9.6.7/html/libraries/base-4.18.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO -&gt; SigningKey PaymentKey
forall tx (m :: * -&gt; *). Client tx m -&gt; SigningKey PaymentKey
</span><a href="Hydra.Client.html#sk"><span class="hs-identifier hs-var">sk</span></a></span><span> </span><span class="annot"><span class="annottext">Client Tx IO
</span><a href="#local-6989586621679451730"><span class="hs-identifier hs-var">hydraClient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span>    </span><span class="annot"><span class="annottext">StakeAddressReference
</span><span class="hs-identifier hs-var">NoStakeAddress</span></span><span>
</span><span id="line-544"></span></pre></body></html>