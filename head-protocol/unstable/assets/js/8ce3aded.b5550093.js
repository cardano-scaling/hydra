"use strict";(self.webpackChunkhydra_head_protocol_docs=self.webpackChunkhydra_head_protocol_docs||[]).push([[7516],{59402:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>o,default:()=>c,frontMatter:()=>r,metadata:()=>t,toc:()=>h});const t=JSON.parse('{"id":"star-shaped/index","title":"Star-shaped head network","description":"This document is a work in progress.","source":"@site/topologies/star-shaped/index.md","sourceDirName":"star-shaped","slug":"/star-shaped/","permalink":"/head-protocol/unstable/topologies/star-shaped/","draft":false,"unlisted":false,"editUrl":"https://github.com/cardano-scaling/hydra/tree/master/docs/topologies/star-shaped/index.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_label":"Star-shaped network","sidebar_position":4},"sidebar":"defaultSidebar","previous":{"title":"Delegated head","permalink":"/head-protocol/unstable/topologies/delegated-head/"}}');var a=n(74848),i=n(28453);const r={sidebar_label:"Star-shaped network",sidebar_position:4},o="Star-shaped head network",d={},h=[{value:"Summary",id:"summary",level:2},{value:"On-chain transactions",id:"on-chain-transactions",level:2},{value:"Off-chain transactions",id:"off-chain-transactions",level:2}];function l(e){const s={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.header,{children:(0,a.jsx)(s.h1,{id:"star-shaped-head-network",children:"Star-shaped head network"})}),"\n",(0,a.jsx)(s.admonition,{type:"note",children:(0,a.jsxs)(s.p,{children:["\ud83d\udee0"," This document is a work in progress."]})}),"\n",(0,a.jsxs)(s.p,{children:["This document details the behavior of the so-called ",(0,a.jsx)(s.em,{children:"star-shaped Hydra network"}),"."]}),"\n",(0,a.jsx)(s.h2,{id:"summary",children:"Summary"}),"\n",(0,a.jsxs)(s.p,{children:["A ",(0,a.jsx)(s.em,{children:"star-shaped Hydra network"}),", or more precisely a star-shaped heads network, comprises:"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["A central ",(0,a.jsx)(s.em,{children:"server"})," node that provides 'head-as-a-service' with low expected downtime, likely operated by a company or organization equipped to host this service."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.em,{children:"Client"})," nodes, which may be DApp instances or mobile/personal wallets. These nodes might not always be online and can come and go."]}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"Star-shaped Heads Network",src:n(32444).A+"",width:"4862",height:"3290"})}),"\n",(0,a.jsx)(s.p,{children:"Client nodes aim to interact with each other efficiently and at low cost using a layer 2 solution, with all the Hydra safety guarantees, but without the operational burden of maintaining an always-online 'full' Hydra node. This might involve using an embedded version of the node or a lightweight variant. Potentially, hundreds or even thousands of such client nodes exist, though they are not always active simultaneously."}),"\n",(0,a.jsxs)(s.p,{children:["Client nodes establish pairwise heads (eg, ",(0,a.jsx)(s.em,{children:"channels"}),") with the server. This setup is simpler than with a normal multiparty head because the server has a well-known identity, and the client can always provide the needed parameters (keys, IP) to the server when setting up the head using a specific service, the details of which are outside the scope of this document."]}),"\n",(0,a.jsxs)(s.p,{children:["Transactions that a client node posts in 'its' head should be ",(0,a.jsx)(s.em,{children:"reflected"})," by the server into the other heads it maintains."]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.em,{children:"Questions"}),":"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Is it expected for the pairwise heads to have varying 'durations'? For example, a client comes, opens a head, conducts some activities, and closes it, while other heads maintained by the same server stay ",(0,a.jsx)(s.em,{children:"open"}),"."]}),"\n",(0,a.jsxs)(s.li,{children:["How does the server provide guarantees preserving Hydra heads' basic ",(0,a.jsx)(s.em,{children:"safety property"})," for each pairwise head?","\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["The diagram suggests using ",(0,a.jsx)(s.em,{children:"Hash Time-Lock Contracts"})," (",(0,a.jsx)(s.a,{href:"https://docs.lightning.engineering/the-lightning-network/multihop-payments/hash-time-lock-contract-htlc",children:"HTLC"}),") to ensure the client can always retrieve its UTXOs if the server does not properly route the transaction to its destination."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:["What kinds of transactions should be supported? HTLCs are suitable for payment-style transactions but not necessarily for DApps, unless adapted.","\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"It seems to be assumed implicitly that the server can 'route' a transaction from one head to the appropriate head, implying it 'understands' the addresses of UTXOs posted in heads."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"on-chain-transactions",children:"On-chain transactions"}),"\n",(0,a.jsxs)(s.p,{children:["The diagram below represents the lifecycle of two pairwise heads between ",(0,a.jsx)(s.strong,{children:"Alice"}),", ",(0,a.jsx)(s.strong,{children:"Bob"}),", and the ",(0,a.jsx)(s.strong,{children:"server"}),"."]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"Star-shaped Network On-Chain",src:n(41135).A+"",width:"1897",height:"413"})}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.em,{children:"Remarks"}),":"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["It is assumed that transactions occurring in one head are reflected in the other, resulting in a consistently final UTXO ",(0,a.jsx)(s.code,{children:"c"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Both heads must start with the ",(0,a.jsx)(s.em,{children:"same"})," initial UTXO set, which is challenging to implement (highlighted in red in the diagram)"]}),"\n",(0,a.jsxs)(s.li,{children:["If the final UTXO set is consistent, then it can be fanned out by any party. However, this could result in one ",(0,a.jsx)(s.code,{children:"\u03bd_head"})," staying dangling and becoming unspendable as it would recreate an already existing UTXO (grayed out transaction in the diagram)."]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(s.li,{children:"The lifecycles of the heads are interconnected: when one is closed, the other must also be closed, as ensured by the server."}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"off-chain-transactions",children:"Off-chain transactions"}),"\n",(0,a.jsxs)(s.p,{children:["The following diagram depicts the sequence of messages exchanged between various ",(0,a.jsx)(s.code,{children:"node"}),"s to ensure transaction propagation."]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"Star-shaped Network Off-Chain Protocol",src:n(51443).A+"",width:"520",height:"757"})}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.em,{children:"Remarks"}),":"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["The server is represented by two nodes, ",(0,a.jsx)(s.code,{children:"M(A)"})," and ",(0,a.jsx)(s.code,{children:"M(B)"})]}),"\n",(0,a.jsxs)(s.li,{children:["The ",(0,a.jsx)(s.code,{children:"newTx"})," issued by ",(0,a.jsx)(s.code,{children:"Alice"})," through her node will be propagated by the server to ",(0,a.jsx)(s.code,{children:"Bob"}),"'s node as ",(0,a.jsx)(s.code,{children:"newTx"})," as well"]}),"\n",(0,a.jsx)(s.li,{children:"This diagram does not account for any additional transactions the server might need to post to provide guarantees to either Alice or Bob (for example, an in-head HTLC transaction)"}),"\n",(0,a.jsx)(s.li,{children:"To ensure consistency of snapshots, the server is presumed to always act as the leader, ie, the one triggering the emission of a snapshot."}),"\n"]})]})}function c(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},51443:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/off-chain-protocol-e3962146cdd4905688da7c366154f834.png"},32444:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/star-shaped-general-532cfafec07585ab262bbbee9acee8eb.jpg"},41135:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/star-shaped-txs-bef2a52039a88dc3cbd49358322377bd.png"},28453:(e,s,n)=>{n.d(s,{R:()=>r,x:()=>o});var t=n(96540);const a={},i=t.createContext(a);function r(e){const s=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),t.createElement(i.Provider,{value:s},e.children)}}}]);